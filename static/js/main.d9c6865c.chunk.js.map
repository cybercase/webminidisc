{"version":3,"sources":["../../src/netmd.ts","../../src/netmd-interface.ts","../../src/encrypt-generator.ts","../../src/index.ts","../../src/web-encrypt-worker.ts","images/chrome-icon.svg","../../src/query-utils.ts","../../src/netmd-commands.ts","../../netmd-js/dist/web-encrypt-worker.js","webpack:///./src/services/atracdenc-worker.ts?dc3c","serviceWorker.ts","services/netmd.ts","services/registry.ts","redux/upload-dialog-feature.ts","redux/rename-dialog-feature.ts","redux/error-dialog-feature.ts","redux/convert-dialog-feature.ts","utils.ts","redux/app-feature.ts","redux/main-feature.ts","redux/store.ts","redux/actions.ts","services/atracdenc-worker.ts","components/about-dialog.tsx","components/topmenu.tsx","components/welcome.tsx","components/rename-dialog.tsx","components/upload-dialog.tsx","components/error-dialog.tsx","components/convert-dialog.tsx","components/main.tsx","components/controls.tsx","components/app.tsx","services/audio-export.ts","index.tsx","../../src/utils.ts"],"names":["this","m","module","exports","result","push","_a","Worker","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","console","log","state","controller","onUpdate","onSuccess","update","catch","error","require","NetMDUSBService","netmdInterface","openNewDevice","usb","iface","openPairedDevice","listContent","netMd","getDeviceName","finalize","index","newTitle","setTrackTitle","newName","getDiscTitle","oldName","_getDiscTitle","newNameWithGroups","replace","cacheTOC","setDiscTitle","syncTOC","eraseTrack","eraseDisc","src","dst","moveTrack","title","data","format","progressCallback","updateProgress","written","encrypted","total","byteLength","w","webWorkerAsyncPacketIterator","makeGetAsyncPacketIteratorOnWorkerThread","encryptedBytes","mdTrack","MDTrack","download","writtenBytes","terminate","play","stop","nextTrack","previousTrack","ServiceRegistry","slice","createSlice","name","initialState","visible","writtenProgress","encryptedProgress","totalProgress","trackTotal","trackConverting","trackCurrent","titleCurrent","titleConverting","reducers","setVisible","action","payload","setWriteProgress","setTrackProgress","current","converting","reducer","actions","enableBatching","setCurrentName","setIndex","setErrorMessage","setFormat","useShallowEqualSelector","selector","useSelector","shallowEqual","getPublicPathFor","script","process","mainView","loading","pairingFailed","pairingMessage","browserSupported","darkMode","key","defaultValue","res","localStorage","getItem","JSON","parse","e","loadPreference","aboutDialogVisible","setState","setLoading","setPairingFailed","setPairingMessage","setBrowserSupported","setDarkMode","value","setItem","stringify","showAboutDialog","disc","deviceName","setDisc","setDeviceName","store","configureStore","renameDialog","uploadDialog","errorDialog","convertDialog","appState","main","middleware","getDefaultMiddleware","dispatch","a","appStateActions","serviceRegistry","netmdService","batchActions","mainActions","WireformatDict","SP","Wireformat","pcm","LP2","lp2","LP105","l105kbps","LP4","lp4","Module","Transition","React","forwardRef","props","ref","Slide","direction","AboutDialog","useDispatch","Dialog","open","maxWidth","fullWidth","TransitionComponent","aria-labelledby","DialogTitle","id","DialogContent","DialogContentText","Link","rel","href","target","DialogActions","Button","onClick","appActions","TopMenu","useState","menuAnchorEl","setMenuAnchorEl","menuOpen","handleMenuClose","menuItems","MenuItem","renameDialogActions","wipeDisc","Fragment","IconButton","aria-label","aria-controls","aria-haspopup","event","currentTarget","Menu","anchorEl","keepMounted","onClose","useStyles","makeStyles","theme","position","flex","display","justifyContent","flexDirection","alignItems","button","marginTop","spacing","minWidth","chromeLogo","width","height","why","alignSelf","headBox","Welcome","classes","toLowerCase","showWhyUnsupported","setWhyUnsupported","Box","className","Typography","component","variant","align","color","getState","audioExportService","init","connect","pair","message","FormControl","style","visibility","FormHelperText","preventDefault","alt","ChromeIconPath","RenameDialog","renameDialogVisible","renameDialogTitle","renameDialogIndex","what","handleCancelRename","handleDoRename","renameDisc","renameTrack","TextField","autoFocus","label","type","onKeyDown","onChange","progressPerc","progressBar","uploadLabel","UploadDialog","progressValue","Math","floor","bufferValue","convertedValue","aria-describedby","LinearProgress","valueBuffer","ErrorDialog","errorDialogActions","container","formControl","ConvertDialog","handleClose","convertDialogActions","InputLabel","Select","labelId","ev","input","Input","files","wireformat","uploadDialogActions","updateProgressCallback","trackUpdate","length","updateTrack","conversionIterator","convertNext","i","f","converted","Promise","resolve","reject","prepare","export","file","errorMessage","j","item","extStartIndex","lastIndexOf","substring","upload","actionToDispatch","concat","errorDialogAction","convertAndUpload","add","bottom","right","overflowY","marginBottom","marginLeft","marginRight","outline","toolbar","breakpoints","up","toolbarLabel","toolbarHighlight","palette","secondary","backgroundColor","lighten","light","text","primary","dark","formatBadge","BadgeImpl","badge","colorPrimary","border","background","paper","padding","titleCell","overflow","textOverflow","indexCell","whiteSpace","paddingRight","backdrop","zIndex","drawer","EncodingName","Encoding","sp","Main","selected","setSelected","selectedCount","moveMenuAnchorEl","setMoveMenuAnchorEl","handleShowMoveMenu","useCallback","handleCloseMoveMenu","handleMoveSelectedTrack","destIndex","srcIndex","useEffect","uploadedFiles","setUploadedFiles","onDrop","acceptedFiles","rejectedFiles","useDropzone","accept","noClick","getRootProps","getInputProps","isDragActive","tracks","groups","group","track","encoding","duration","formatTimeFromFrames","handleRenameDoubleClick","selectedIndex","currentName","getTracks","find","left","Toolbar","clsx","Checkbox","indeterminate","checked","map","t","inputProps","Tooltip","PaperProps","maxHeight","Array","fill","_","indexes","sort","reverse","deleteTrack","disabled","Table","size","TableHead","TableRow","TableCell","TableBody","hover","includes","onDoubleClick","filter","Backdrop","Fab","Controls","handlePrev","prev","handlePlay","handleStop","handleNext","next","layout","copyright","down","flexWrap","minidiscLogo","controlsContainer","paddingLeft","order","darkTheme","createMuiTheme","contrastText","lightTheme","App","ThemeProvider","CssBaseline","Paper","undefined","Date","getFullYear","data-via","data-hashtags","data-dnt","data-show-count","CircularProgress","AtracdencProcess","worker","messageCallback","onmessage","handleMessage","bind","postMessage","bitrate","eventData","WorkerGlobalScope","self","others","importScripts","setLogger","msg","stream","dataArray","Uint8Array","FS","writeFile","callMain","fileStat","stat","tmp","outAt3FileStream","read","close","buffer","AtracdencWorker","FFMpegAudioExportService","ffmpegProcess","atracdencProcess","loglines","inFileName","outFileNameNoExt","setLogging","createWorker","logger","corePath","workerPath","load","ext","split","Error","write","transcode","audioFormatRegex","inputFormatRegex","line","outFileName","encode","addEventListener","returnValue","ondisconnect","ReactDOM","render","document","getElementById","URL","origin","fetch","headers","response","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.d9c6865c.chunk.js","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"util\");\nvar utils_1 = require(\"./utils\");\nvar BULK_WRITE_ENDPOINT = 0x02;\nvar BULK_READ_ENDPOINT = 0x81;\nexports.DevicesIds = [\n    { vendorId: 0x04dd, deviceId: 0x7202, name: 'Sharp IM-MT899H' },\n    { vendorId: 0x054c, deviceId: 0x0075, name: 'Sony MZ-N1' },\n    { vendorId: 0x054c, deviceId: 0x0080, name: 'Sony LAM-1' },\n    { vendorId: 0x054c, deviceId: 0x0081, name: 'Sony MDS-JB980' },\n    { vendorId: 0x054c, deviceId: 0x0084, name: 'Sony MZ-N505' },\n    { vendorId: 0x054c, deviceId: 0x0085, name: 'Sony MZ-S1' },\n    { vendorId: 0x054c, deviceId: 0x0086, name: 'Sony MZ-N707' },\n    { vendorId: 0x054c, deviceId: 0x00c6, name: 'Sony MZ-N10' },\n    { vendorId: 0x054c, deviceId: 0x00c7, name: 'Sony MZ-N910' },\n    { vendorId: 0x054c, deviceId: 0x00c8, name: 'Sony MZ-N710/NF810' },\n    { vendorId: 0x054c, deviceId: 0x00c9, name: 'Sony MZ-N510/N610' },\n    { vendorId: 0x054c, deviceId: 0x00ca, name: 'Sony MZ-NE410/NF520D' },\n    { vendorId: 0x054c, deviceId: 0x00eb, name: 'Sony MZ-NE810/NE910' },\n    { vendorId: 0x054c, deviceId: 0x0101, name: 'Sony LAM-10' },\n    { vendorId: 0x054c, deviceId: 0x0113, name: 'Aiwa AM-NX1' },\n    { vendorId: 0x054c, deviceId: 0x014c, name: 'Aiwa AM-NX9' },\n    { vendorId: 0x054c, deviceId: 0x017e, name: 'Sony MZ-NH1' },\n    { vendorId: 0x054c, deviceId: 0x0180, name: 'Sony MZ-NH3D' },\n    { vendorId: 0x054c, deviceId: 0x0182, name: 'Sony MZ-NH900' },\n    { vendorId: 0x054c, deviceId: 0x0184, name: 'Sony MZ-NH700/NH800' },\n    { vendorId: 0x054c, deviceId: 0x0186, name: 'Sony MZ-NH600/NH600D' },\n    { vendorId: 0x054c, deviceId: 0x0188, name: 'Sony MZ-N920' },\n    { vendorId: 0x054c, deviceId: 0x018a, name: 'Sony LAM-3' },\n    { vendorId: 0x054c, deviceId: 0x01e9, name: 'Sony MZ-DH10P' },\n    { vendorId: 0x054c, deviceId: 0x0219, name: 'Sony MZ-RH10' },\n    { vendorId: 0x054c, deviceId: 0x021b, name: 'Sony MZ-RH710/MZ-RH910' },\n    { vendorId: 0x054c, deviceId: 0x022c, name: 'Sony CMT-AH10' },\n    { vendorId: 0x054c, deviceId: 0x023c, name: 'Sony DS-HMD1' },\n    { vendorId: 0x054c, deviceId: 0x0286, name: 'Sony MZ-RH1' },\n];\nvar NetMD = /** @class */ (function () {\n    function NetMD(device, iface, logger) {\n        if (iface === void 0) { iface = 0; }\n        var _a;\n        this.device = device;\n        this.iface = iface;\n        this.logger = logger;\n        this.logger = (_a = logger) === null || _a === void 0 ? void 0 : _a.child({ class: 'NetMD' });\n    }\n    NetMD.prototype.init = function () {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var len;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        (_a = this.logger) === null || _a === void 0 ? void 0 : _a.debug('Init');\n                        if (!!this.device.opened) return [3 /*break*/, 2];\n                        (_b = this.logger) === null || _b === void 0 ? void 0 : _b.debug('Opening device');\n                        return [4 /*yield*/, this.device.open()];\n                    case 1:\n                        _c.sent();\n                        _c.label = 2;\n                    case 2: return [4 /*yield*/, this.device.selectConfiguration(1)];\n                    case 3:\n                        _c.sent();\n                        return [4 /*yield*/, this.device.claimInterface(this.iface)];\n                    case 4:\n                        _c.sent();\n                        return [4 /*yield*/, this.getReplyLength()];\n                    case 5:\n                        len = _c.sent();\n                        if (!(len > 0)) return [3 /*break*/, 7];\n                        return [4 /*yield*/, this.readReply()];\n                    case 6:\n                        _c.sent();\n                        _c.label = 7;\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMD.prototype.getDeviceName = function () {\n        var _a, _b;\n        var _c = this.device, vendorId = _c.vendorId, productId = _c.productId;\n        var deviceId = exports.DevicesIds.find(function (device) { return device.deviceId === productId && device.vendorId === vendorId; });\n        return _b = (_a = deviceId) === null || _a === void 0 ? void 0 : _a.name, (_b !== null && _b !== void 0 ? _b : 'Unknown Device');\n    };\n    NetMD.prototype.finalize = function () {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var err_1;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        (_a = this.logger) === null || _a === void 0 ? void 0 : _a.debug('Finalize');\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 5, , 6]);\n                        return [4 /*yield*/, this.device.reset()];\n                    case 2:\n                        _c.sent();\n                        return [4 /*yield*/, this.device.releaseInterface(this.iface)];\n                    case 3:\n                        _c.sent();\n                        return [4 /*yield*/, this.device.close()];\n                    case 4:\n                        _c.sent();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_1 = _c.sent();\n                        (_b = this.logger) === null || _b === void 0 ? void 0 : _b.error({ err: err_1 });\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMD.prototype.getReplyLength = function () {\n        var _a, _b, _c;\n        return __awaiter(this, void 0, void 0, function () {\n            var result, len;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0: return [4 /*yield*/, this.device.controlTransferIn({\n                            requestType: 'vendor',\n                            recipient: 'interface',\n                            request: 0x01,\n                            value: 0,\n                            index: 0,\n                        }, 4)];\n                    case 1:\n                        result = _d.sent();\n                        len = (_b = (_a = result.data) === null || _a === void 0 ? void 0 : _a.getUint8(2), (_b !== null && _b !== void 0 ? _b : 0));\n                        (_c = this.logger) === null || _c === void 0 ? void 0 : _c.debug({ action: 'getReplyLength', result: util_1.inspect(result), len: len });\n                        return [2 /*return*/, len];\n                }\n            });\n        });\n    };\n    NetMD.prototype.sendCommand = function (command) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        (_a = this.logger) === null || _a === void 0 ? void 0 : _a.debug({ action: 'sendCommand', command: util_1.inspect(command) });\n                        return [4 /*yield*/, this.device.controlTransferOut({\n                                requestType: 'vendor',\n                                recipient: 'interface',\n                                request: 0x80,\n                                value: 0,\n                                index: 0,\n                            }, command)];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMD.prototype.readReply = function () {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var len, i, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.getReplyLength()];\n                    case 1:\n                        len = _b.sent();\n                        i = 0;\n                        _b.label = 2;\n                    case 2:\n                        if (!(len === 0)) return [3 /*break*/, 5];\n                        return [4 /*yield*/, utils_1.sleep(NetMD.readReplyRetryIntervalInMsec * Math.pow(2, ~~(i / 10)))];\n                    case 3:\n                        _b.sent(); // Double wait time every 10 attempts\n                        return [4 /*yield*/, this.getReplyLength()];\n                    case 4:\n                        len = _b.sent();\n                        i++;\n                        return [3 /*break*/, 2];\n                    case 5: return [4 /*yield*/, this.device.controlTransferIn({\n                            requestType: 'vendor',\n                            recipient: 'interface',\n                            request: 0x81,\n                            value: 0,\n                            index: 0,\n                        }, len)];\n                    case 6:\n                        result = _b.sent();\n                        (_a = this.logger) === null || _a === void 0 ? void 0 : _a.debug({ action: 'readReply', result: util_1.inspect(result) });\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    NetMD.prototype.readBulk = function (length) {\n        return __awaiter(this, void 0, void 0, function () {\n            var result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.readBulkToArray(length)];\n                    case 1:\n                        result = _a.sent();\n                        return [2 /*return*/, new Uint8Array(result)];\n                }\n            });\n        });\n    };\n    NetMD.prototype.readBulkToArray = function (length, chunksize) {\n        if (chunksize === void 0) { chunksize = 0x10000; }\n        return __awaiter(this, void 0, void 0, function () {\n            var done, buffer, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        done = 0;\n                        buffer = new ArrayBuffer(0);\n                        _a.label = 1;\n                    case 1:\n                        if (!(done < length)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.device.transferIn(this.iface, Math.min(length - done, length))];\n                    case 2:\n                        res = _a.sent();\n                        if (!res.data) {\n                            throw new Error('expected data');\n                        }\n                        done += res.data.byteLength; // TODO: handle this case\n                        buffer = utils_1.concatArrayBuffers(buffer, res.data.buffer);\n                        return [3 /*break*/, 1];\n                    case 3: return [2 /*return*/, buffer];\n                }\n            });\n        });\n    };\n    NetMD.prototype.writeBulk = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.device.transferOut(BULK_WRITE_ENDPOINT, data)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    NetMD.readReplyRetryIntervalInMsec = 10;\n    return NetMD;\n}());\nexports.NetMD = NetMD;\n//# sourceMappingURL=netmd.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __asyncValues = (this && this.__asyncValues) || function (o) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var m = o[Symbol.asyncIterator], i;\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n};\nvar __await = (this && this.__await) || function (v) { return this instanceof __await ? (this.v = v, this) : new __await(v); }\nvar __asyncGenerator = (this && this.__asyncGenerator) || function (thisArg, _arguments, generator) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n    function fulfill(value) { resume(\"next\", value); }\n    function reject(value) { resume(\"throw\", value); }\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _a, _b;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar query_utils_1 = require(\"./query-utils\");\nvar utils_1 = require(\"./utils\");\nvar jsbi_1 = __importDefault(require(\"jsbi\"));\nvar crypto_js_1 = __importDefault(require(\"crypto-js\"));\nvar Status;\n(function (Status) {\n    // NetMD Protocol return status (first byte of request)\n    Status[Status[\"control\"] = 0] = \"control\";\n    Status[Status[\"status\"] = 1] = \"status\";\n    Status[Status[\"specificInquiry\"] = 2] = \"specificInquiry\";\n    Status[Status[\"notify\"] = 3] = \"notify\";\n    Status[Status[\"generalInquiry\"] = 4] = \"generalInquiry\";\n    //  ... (first byte of response)\n    Status[Status[\"notImplemented\"] = 8] = \"notImplemented\";\n    Status[Status[\"accepted\"] = 9] = \"accepted\";\n    Status[Status[\"rejected\"] = 10] = \"rejected\";\n    Status[Status[\"inTransition\"] = 11] = \"inTransition\";\n    Status[Status[\"implemented\"] = 12] = \"implemented\";\n    Status[Status[\"changed\"] = 13] = \"changed\";\n    Status[Status[\"interim\"] = 15] = \"interim\";\n})(Status || (Status = {}));\nvar Action;\n(function (Action) {\n    Action[Action[\"play\"] = 117] = \"play\";\n    Action[Action[\"pause\"] = 125] = \"pause\";\n    Action[Action[\"fastForward\"] = 57] = \"fastForward\";\n    Action[Action[\"rewind\"] = 73] = \"rewind\";\n})(Action || (Action = {}));\nvar Track;\n(function (Track) {\n    Track[Track[\"previous\"] = 2] = \"previous\";\n    Track[Track[\"next\"] = 32769] = \"next\";\n    Track[Track[\"restart\"] = 1] = \"restart\";\n})(Track || (Track = {}));\nvar DiscFormat;\n(function (DiscFormat) {\n    DiscFormat[DiscFormat[\"lp4\"] = 0] = \"lp4\";\n    DiscFormat[DiscFormat[\"lp2\"] = 2] = \"lp2\";\n    DiscFormat[DiscFormat[\"spMono\"] = 4] = \"spMono\";\n    DiscFormat[DiscFormat[\"spStereo\"] = 6] = \"spStereo\";\n})(DiscFormat = exports.DiscFormat || (exports.DiscFormat = {}));\nvar Wireformat;\n(function (Wireformat) {\n    Wireformat[Wireformat[\"pcm\"] = 0] = \"pcm\";\n    Wireformat[Wireformat[\"l105kbps\"] = 144] = \"l105kbps\";\n    Wireformat[Wireformat[\"lp2\"] = 148] = \"lp2\";\n    Wireformat[Wireformat[\"lp4\"] = 168] = \"lp4\";\n})(Wireformat = exports.Wireformat || (exports.Wireformat = {}));\nvar Encoding;\n(function (Encoding) {\n    Encoding[Encoding[\"sp\"] = 144] = \"sp\";\n    Encoding[Encoding[\"lp2\"] = 146] = \"lp2\";\n    Encoding[Encoding[\"lp4\"] = 147] = \"lp4\";\n})(Encoding = exports.Encoding || (exports.Encoding = {}));\nvar Channels;\n(function (Channels) {\n    Channels[Channels[\"mono\"] = 1] = \"mono\";\n    Channels[Channels[\"stereo\"] = 0] = \"stereo\";\n})(Channels = exports.Channels || (exports.Channels = {}));\nvar ChannelCount;\n(function (ChannelCount) {\n    ChannelCount[ChannelCount[\"mono\"] = 1] = \"mono\";\n    ChannelCount[ChannelCount[\"stereo\"] = 2] = \"stereo\";\n})(ChannelCount = exports.ChannelCount || (exports.ChannelCount = {}));\nvar TrackFlag;\n(function (TrackFlag) {\n    TrackFlag[TrackFlag[\"protected\"] = 3] = \"protected\";\n    TrackFlag[TrackFlag[\"unprotected\"] = 0] = \"unprotected\";\n})(TrackFlag = exports.TrackFlag || (exports.TrackFlag = {}));\nvar DiscFlag;\n(function (DiscFlag) {\n    DiscFlag[DiscFlag[\"writable\"] = 16] = \"writable\";\n    DiscFlag[DiscFlag[\"writeProtected\"] = 64] = \"writeProtected\";\n})(DiscFlag = exports.DiscFlag || (exports.DiscFlag = {}));\nexports.FrameSize = (_a = {},\n    _a[Wireformat.pcm] = 2048,\n    _a[Wireformat.lp2] = 192,\n    _a[Wireformat.l105kbps] = 152,\n    _a[Wireformat.lp4] = 96,\n    _a);\n// https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work\n// I could have used the make-error library\nvar NetMDError = /** @class */ (function (_super) {\n    __extends(NetMDError, _super);\n    function NetMDError(m) {\n        var _this = _super.call(this, m) || this;\n        Object.setPrototypeOf(_this, NetMDError.prototype);\n        return _this;\n    }\n    return NetMDError;\n}(Error));\nvar NetMDNotImplemented = /** @class */ (function (_super) {\n    __extends(NetMDNotImplemented, _super);\n    function NetMDNotImplemented(m) {\n        var _this = _super.call(this, m) || this;\n        Object.setPrototypeOf(_this, NetMDNotImplemented.prototype);\n        return _this;\n    }\n    return NetMDNotImplemented;\n}(NetMDError));\nvar NetMDRejected = /** @class */ (function (_super) {\n    __extends(NetMDRejected, _super);\n    function NetMDRejected(m) {\n        var _this = _super.call(this, m) || this;\n        Object.setPrototypeOf(_this, NetMDRejected.prototype);\n        return _this;\n    }\n    return NetMDRejected;\n}(NetMDError));\nvar NetMDInterface = /** @class */ (function () {\n    function NetMDInterface(netMd) {\n        this.netMd = netMd;\n    }\n    NetMDInterface.prototype.sendQuery = function (query, test) {\n        if (test === void 0) { test = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.sendCommand(query, test)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, this.readReply()];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.sendCommand = function (query, test) {\n        if (test === void 0) { test = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var statusByte;\n            return __generator(this, function (_a) {\n                if (test) {\n                    statusByte = new Uint8Array([Status.specificInquiry]).buffer;\n                }\n                else {\n                    statusByte = new Uint8Array([Status.control]).buffer;\n                }\n                this.netMd.sendCommand(utils_1.concatArrayBuffers(statusByte, query));\n                return [2 /*return*/];\n            });\n        });\n    };\n    NetMDInterface.prototype.readReply = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, status;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.netMd.readReply()];\n                    case 1:\n                        data = (_a.sent()).data;\n                        if (data === undefined) {\n                            throw new Error('unexpected undefined value in readReply');\n                        }\n                        status = data.getUint8(0);\n                        if (status === Status.notImplemented) {\n                            throw new NetMDNotImplemented('Not implemented');\n                        }\n                        else if (status === Status.rejected) {\n                            throw new NetMDRejected('Rejected');\n                        }\n                        else if ([Status.accepted, Status.implemented, Status.interim].indexOf(status) < -1) {\n                            throw new NetMDNotImplemented(\"Unknown return status: \" + status);\n                        }\n                        return [2 /*return*/, data.buffer.slice(1)];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.acquire = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('ff 010c ffff ffff ffff ffff ffff ffff');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, 'ff 010c ffff ffff ffff ffff ffff ffff');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.release = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('ff 0100 ffff ffff ffff ffff ffff ffff');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, 'ff 0100 ffff ffff ffff ffff ffff ffff');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getStatus = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1809 8001 0230 8800 0030 8804 00 ff00 00000000');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1809 8001 0230 8800 0030 8804 00 1000 000900000 %x')[0]];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.isDiscPresent = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var status;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getStatus()];\n                    case 1:\n                        status = _a.sent();\n                        return [2 /*return*/, status.charCodeAt(4) === 0x40];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getOperatingStatus = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1809 8001 0330 8802 0030 8805 0030 8806 00 ff00 00000000');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        res = query_utils_1.scanQuery(reply, '1809 8001 0330 8802 0030 8805 0030 8806 00 1000 00%?0000 0006 8806 0002 %w')[0];\n                        return [2 /*return*/, jsbi_1.default.toNumber(res)];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype._getPlaybackStatus = function (p1, p2) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1809 8001 0330 %w 0030 8805 0030 %w 00 ff00 00000000', p1, p2);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1809 8001 0330 %?%? %?%? %?%? %?%? %?%? %? 1000 00%?0000 %x')[0]];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getPlaybackStatus1 = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this._getPlaybackStatus(0x8801, 0x8807)];\n            });\n        });\n    };\n    NetMDInterface.prototype.getPlaybackStatus2 = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this._getPlaybackStatus(0x8802, 0x8806)];\n            });\n        });\n    };\n    NetMDInterface.prototype.getPosition = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, err_1, result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1809 8001 0430 8802 0030 8805 0030 0003 0030 0002 00 ff00 00000000');\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 2:\n                        reply = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_1 = _a.sent();\n                        if (err_1 instanceof NetMDRejected) {\n                            return [2 /*return*/, null];\n                        }\n                        else {\n                            throw err_1;\n                        }\n                        return [3 /*break*/, 4];\n                    case 4:\n                        result = query_utils_1.scanQuery(reply, \"1809 8001 0430 %?%? %?%? %?%? \" + \"%?%? %?%? %?%? %?%? %? %?00 00%?0000 \" + \"000b 0002 0007 00 %w %b %b %b %b\");\n                        result[0] = jsbi_1.default.toNumber(result[0]);\n                        result[1] = query_utils_1.BCD2int(jsbi_1.default.toNumber(result[1]));\n                        result[2] = query_utils_1.BCD2int(jsbi_1.default.toNumber(result[2]));\n                        result[3] = query_utils_1.BCD2int(jsbi_1.default.toNumber(result[3]));\n                        result[4] = query_utils_1.BCD2int(jsbi_1.default.toNumber(result[4]));\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype._play = function (action) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('18c3 ff %b 000000', action);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, '18c3 00 %b 000000');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.play = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._play(Action.play)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.fast_forward = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._play(Action.fastForward)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.rewind = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._play(Action.rewind)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.pause = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._play(Action.pause)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.stop = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('18c5 ff 00000000');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, '18c5 00 00000000');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.gotoTrack = function (track) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1850 ff010000 0000 %w', track);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        res = query_utils_1.scanQuery(reply, '1850 00010000 0000 %w')[0];\n                        return [2 /*return*/, jsbi_1.default.toNumber(res)];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.gotoTime = function (track, hour, minute, second, frame) {\n        if (hour === void 0) { hour = 0; }\n        if (minute === void 0) { minute = 0; }\n        if (second === void 0) { second = 0; }\n        if (frame === void 0) { frame = 0; }\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1850 ff000000 0000 %w %b%b%b%b', track, query_utils_1.int2BCD(hour), query_utils_1.int2BCD(minute), query_utils_1.int2BCD(second), query_utils_1.int2BCD(frame));\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        res = query_utils_1.scanQuery(reply, '1850 00000000 %?%? %w %b%b%b%b');\n                        return [2 /*return*/, res.map(function (j) { return jsbi_1.default.toNumber(j); })];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype._trackChange = function (direction) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1850 ff10 00000000 %w', direction);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1850 0010 00000000 %?%?')];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.nextTrack = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._trackChange(Track.next)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.previousTrack = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._trackChange(Track.previous)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.restartTrack = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._trackChange(Track.restart)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.eraseDisc = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1840 ff 0000');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, '1840 00 0000');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.syncTOC = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1808 10180200 00');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, '1808 10180200 00');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.cacheTOC = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1808 10180203 00');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, '1808 10180203 00');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getDiscFlags = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1806 01101000 ff00 0001000b');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        res = query_utils_1.scanQuery(reply, '1806 01101000 1000 0001000b %b');\n                        return [2 /*return*/, jsbi_1.default.toNumber(res[0])];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getTrackCount = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1806 02101001 3000 1000 ff00 00000000');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        data = query_utils_1.scanQuery(reply, '1806 02101001 %?%? %?%? 1000 00%?0000 %x')[0];\n                        utils_1.assert(data.length === 6, \"Expected length === 6 for data\");\n                        utils_1.assert(data.substring(0, 5) === \"\\0\\u0010\\0\\u0002\\0\", \"Wrong header in data response\");\n                        return [2 /*return*/, data.charCodeAt(5)];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype._getDiscTitle = function (wchar) {\n        if (wchar === void 0) { wchar = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var wcharValue, done, remaining, total, result, chunkSize, chunk, query, reply, res, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (wchar) {\n                            wcharValue = 1;\n                        }\n                        else {\n                            wcharValue = 0;\n                        }\n                        done = 0;\n                        remaining = 0;\n                        total = 1;\n                        result = [];\n                        _a.label = 1;\n                    case 1:\n                        if (!(done < total)) return [3 /*break*/, 3];\n                        query = query_utils_1.formatQuery('1806 02201801 00%b 3000 0a00 ff00 %w%w', wcharValue, remaining, done);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 2:\n                        reply = _a.sent();\n                        if (remaining === 0) {\n                            res = query_utils_1.scanQuery(reply, '1806 02201801 00%? 3000 0a00 1000 %w0000 %?%?000a %w %*');\n                            chunkSize = jsbi_1.default.toNumber(res[0]);\n                            total = jsbi_1.default.toNumber(res[1]);\n                            chunk = res[2];\n                            chunkSize -= 6;\n                        }\n                        else {\n                            res = query_utils_1.scanQuery(reply, '1806 02201801 00%? 3000 0a00 1000 %w%?%? %*');\n                            chunkSize = jsbi_1.default.toNumber(res[0]);\n                            chunk = res[1];\n                        }\n                        utils_1.assert(chunkSize === chunk.length);\n                        result.push(chunk);\n                        done += chunkSize;\n                        remaining = total - done;\n                        return [3 /*break*/, 1];\n                    case 3: return [2 /*return*/, result.join('')];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getDiscTitle = function (wchar) {\n        if (wchar === void 0) { wchar = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var title, firstEntry;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._getDiscTitle(wchar)];\n                    case 1:\n                        title = _a.sent();\n                        if (title.endsWith('//')) {\n                            firstEntry = title.split('//')[0];\n                            if (firstEntry.startsWith('0;')) {\n                                title = firstEntry.substring(2);\n                            }\n                            else {\n                                title = '';\n                            }\n                        }\n                        return [2 /*return*/, title];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getTrackGroupList = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var rawTitle, groupList, trackDict, trackCount, result, _a, _b, _c, groupIndex, group, _d, trackRange, groupName, trackMinStr, trackMaxStr, _e, trackMin, trackMax, trackList_1, track, trackList;\n            var e_1, _f, _g;\n            return __generator(this, function (_h) {\n                switch (_h.label) {\n                    case 0: return [4 /*yield*/, this._getDiscTitle()];\n                    case 1:\n                        rawTitle = _h.sent();\n                        groupList = rawTitle.split('//');\n                        trackDict = {};\n                        return [4 /*yield*/, this.getTrackCount()];\n                    case 2:\n                        trackCount = _h.sent();\n                        result = [];\n                        try {\n                            for (_a = __values(groupList.entries()), _b = _a.next(); !_b.done; _b = _a.next()) {\n                                _c = __read(_b.value, 2), groupIndex = _c[0], group = _c[1];\n                                if (group === '') {\n                                    continue;\n                                }\n                                if (group[0] === '0' || group.indexOf(';') === -1) {\n                                    continue;\n                                }\n                                _d = __read(group.split(';', 2), 2), trackRange = _d[0], groupName = _d[1];\n                                trackMinStr = void 0, trackMaxStr = void 0;\n                                if (trackRange.indexOf('-') >= 0) {\n                                    _g = __read(trackRange.split('-'), 2), trackMinStr = _g[0], trackMaxStr = _g[1];\n                                }\n                                else {\n                                    trackMinStr = trackMaxStr = trackRange;\n                                }\n                                _e = __read([Number.parseInt(trackMinStr, 10), Number.parseInt(trackMaxStr, 10)], 2), trackMin = _e[0], trackMax = _e[1];\n                                utils_1.assert(0 <= trackMin);\n                                utils_1.assert(trackMin <= trackMax);\n                                utils_1.assert(trackMax <= trackCount);\n                                trackList_1 = [];\n                                for (track = trackMin - 1; track < trackMax; track++) {\n                                    if (track in trackDict) {\n                                        throw new Error(\"Track \" + track + \" is in 2 groups: \" + trackDict[track][0]);\n                                    }\n                                    trackDict[track] = [groupName, groupIndex];\n                                    trackList_1.push(track);\n                                }\n                                result.push([groupName, trackList_1]);\n                            }\n                        }\n                        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                        finally {\n                            try {\n                                if (_b && !_b.done && (_f = _a.return)) _f.call(_a);\n                            }\n                            finally { if (e_1) throw e_1.error; }\n                        }\n                        trackList = __spread(Array(trackCount).keys()).filter(function (x) { return !(x in trackDict); });\n                        if (trackList.length > 0) {\n                            result.push([null, trackList]);\n                        }\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getTrackTitle = function (track, wchar) {\n        if (wchar === void 0) { wchar = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var wcharValue, query, reply, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (wchar) {\n                            wcharValue = 3;\n                        }\n                        else {\n                            wcharValue = 2;\n                        }\n                        query = query_utils_1.formatQuery('1806 022018%b %w 3000 0a00 ff00 00000000', wcharValue, track);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        res = query_utils_1.scanQuery(reply, '1806 022018%? %?%? %?%? %?%? 1000 00%?0000 00%?000a %x');\n                        return [2 /*return*/, res[0]];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.setDiscTitle = function (title, wchar) {\n        if (wchar === void 0) { wchar = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var wcharValue, oldLen, query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (wchar) {\n                            wcharValue = 1;\n                        }\n                        else {\n                            wcharValue = 0;\n                        }\n                        return [4 /*yield*/, this.getDiscTitle()];\n                    case 1:\n                        oldLen = (_a.sent()).length;\n                        query = query_utils_1.formatQuery('1807 02201801 00%b 3000 0a00 5000 %w 0000 %w %*', wcharValue, title.length, oldLen, title);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 2:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, '1807 02201801 00%? 3000 0a00 5000 %?%? 0000 %?%?');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.setTrackTitle = function (track, title, wchar) {\n        if (wchar === void 0) { wchar = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var wcharValue, oldLen, err_2, query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (wchar) {\n                            wcharValue = 3;\n                        }\n                        else {\n                            wcharValue = 2;\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.getTrackTitle(track)];\n                    case 2:\n                        oldLen = (_a.sent()).length;\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_2 = _a.sent();\n                        if (err_2 instanceof NetMDRejected) {\n                            oldLen = 0;\n                        }\n                        else {\n                            throw err_2;\n                        }\n                        return [3 /*break*/, 4];\n                    case 4:\n                        query = query_utils_1.formatQuery('1807 022018%b %w 3000 0a00 5000 %w 0000 %w %*', wcharValue, track, title.length, oldLen, title);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 5:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, '1807 022018%? %?%? 3000 0a00 5000 %?%? 0000 %?%?');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.eraseTrack = function (track) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1840 ff01 00 201001 %w', track);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.moveTrack = function (source, dest) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1843 ff00 00 201001 %w 201001 %w', source, dest);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype._getTrackInfo = function (track, p1, p2) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1806 02201001 %w %w %w ff00 00000000', track, p1, p2);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1806 02201001 %?%? %?%? %?%? 1000 00%?0000 %x')[0]];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getTrackLength = function (track) {\n        return __awaiter(this, void 0, void 0, function () {\n            var rawValue, result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._getTrackInfo(track, 0x3000, 0x0100)];\n                    case 1:\n                        rawValue = _a.sent();\n                        result = query_utils_1.scanQuery(utils_1.stringToCharCodeArray(rawValue), '0001 0006 0000 %b %b %b %b');\n                        result[0] = query_utils_1.BCD2int(jsbi_1.default.toNumber(result[0]));\n                        result[1] = query_utils_1.BCD2int(jsbi_1.default.toNumber(result[1]));\n                        result[2] = query_utils_1.BCD2int(jsbi_1.default.toNumber(result[2]));\n                        result[3] = query_utils_1.BCD2int(jsbi_1.default.toNumber(result[3]));\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getTrackEncoding = function (track) {\n        return __awaiter(this, void 0, void 0, function () {\n            var rawValue, result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._getTrackInfo(track, 0x3080, 0x0700)];\n                    case 1:\n                        rawValue = _a.sent();\n                        result = query_utils_1.scanQuery(utils_1.stringToCharCodeArray(rawValue), '8007 0004 0110 %b %b');\n                        return [2 /*return*/, result.map(function (i) { return jsbi_1.default.toNumber(i); })];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getTrackFlags = function (track) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1806 01201001 %w ff00 00010008', track);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        res = query_utils_1.scanQuery(reply, '1806 01201001 %?%? 10 00 00010008 %b')[0];\n                        return [2 /*return*/, jsbi_1.default.toNumber(res)];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getDiscCapacity = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, result, res, i, offset, tmp;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1806 02101000 3080 0300 ff00 00000000');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        result = [];\n                        res = query_utils_1.scanQuery(reply, '1806 02101000 3080 0300 1000 001d0000 001b 8003 0017 8000 0005 %w %b %b %b 0005 %w %b %b %b 0005 %w %b %b %b');\n                        for (i = 0; i < 3; i++) {\n                            offset = i * 4;\n                            tmp = [\n                                query_utils_1.BCD2int(jsbi_1.default.toNumber(res[offset + 0])),\n                                query_utils_1.BCD2int(jsbi_1.default.toNumber(res[offset + 1])),\n                                query_utils_1.BCD2int(jsbi_1.default.toNumber(res[offset + 2])),\n                                query_utils_1.BCD2int(jsbi_1.default.toNumber(res[offset + 3])),\n                            ];\n                            result.push(tmp);\n                        }\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getRecordingParameters = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply, res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1809 8001 0330 8801 0030 8805 0030 8807 00 ff00 00000000');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        res = query_utils_1.scanQuery(reply, '1809 8001 0330 8801 0030 8805 0030 8807 00 1000 000e0000 000c 8805 0008 80e0 0110 %b %b 4000');\n                        return [2 /*return*/, res.map(function (i) { return jsbi_1.default.toNumber(i); })];\n                }\n            });\n        });\n    };\n    // TODO: saveTrackToStream\n    NetMDInterface.prototype.disableNewTrackProtection = function (val) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 2b ff %w', val);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        query_utils_1.scanQuery(reply, '1800 080046 f0030103 2b 00 %?%?');\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.enterSecureSession = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 80 ff');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 80 00')];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.leaveSecureSession = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 81 ff');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 81 00')];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getLeafID = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 11 ff');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 11 00 %*')[0]];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.sendKeyData = function (ekbid, keychain, depth, ekbsignature) {\n        return __awaiter(this, void 0, void 0, function () {\n            var chainlen, databytes, keychain_1, keychain_1_1, key, keychains, query, reply;\n            var e_2, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        chainlen = keychain.length;\n                        databytes = 16 + 16 * chainlen + 24;\n                        try {\n                            for (keychain_1 = __values(keychain), keychain_1_1 = keychain_1.next(); !keychain_1_1.done; keychain_1_1 = keychain_1.next()) {\n                                key = keychain_1_1.value;\n                                if (key.length !== 16) {\n                                    throw new Error(\"Each key in the chain needs to have 16 bytes; this one has \" + key.length);\n                                }\n                            }\n                        }\n                        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                        finally {\n                            try {\n                                if (keychain_1_1 && !keychain_1_1.done && (_a = keychain_1.return)) _a.call(keychain_1);\n                            }\n                            finally { if (e_2) throw e_2.error; }\n                        }\n                        if (depth < 1 || depth > 63) {\n                            throw new Error('Supplied depth is invalid');\n                        }\n                        if (ekbsignature.length !== 24) {\n                            throw new Error('Supplied EKB signature length wrong');\n                        }\n                        keychains = utils_1.concatUint8Arrays.apply(void 0, __spread(keychain));\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 12 ff %w %d %d %d %d 00000000 %* %*', databytes, databytes, chainlen, depth, ekbid, keychains, ekbsignature);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _b.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 12 01 %?%? %?%?%?%?')];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.sessionKeyExchange = function (hostnonce) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (hostnonce.length !== 8) {\n                            throw new Error('Supplied host nonce length wrong');\n                        }\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 20 ff 000000 %*', hostnonce);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 20 00 000000 %#')[0]];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.sessionKeyForget = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 21 ff 000000');\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 21 00 000000')];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.setupDownload = function (contentid, keyenckey, hexSessionKey) {\n        return __awaiter(this, void 0, void 0, function () {\n            var message, encryptedarg, query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (contentid.length !== 20) {\n                            throw new Error('Supplied Content ID length wrong');\n                        }\n                        if (keyenckey.length !== 8) {\n                            throw new Error('Supplied Key Encryption Key length wrong');\n                        }\n                        if (hexSessionKey.length !== 16) {\n                            throw new Error('Supplied Session Key length wrong');\n                        }\n                        message = utils_1.concatUint8Arrays(new Uint8Array([1, 1, 1, 1]), contentid, keyenckey);\n                        encryptedarg = crypto_js_1.default.DES.encrypt(crypto_js_1.default.lib.WordArray.create(message), crypto_js_1.default.enc.Hex.parse(hexSessionKey), {\n                            mode: crypto_js_1.default.mode.CBC,\n                            iv: crypto_js_1.default.enc.Hex.parse('0000000000000000'),\n                        });\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 22 ff 0000 %*', utils_1.wordArrayToByteArray(encryptedarg.ciphertext));\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 22 00 0000')];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.commitTrack = function (tracknum, hexSessionKey) {\n        return __awaiter(this, void 0, void 0, function () {\n            var authentication, query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (hexSessionKey.length !== 16) {\n                            throw new Error('Supplied Session Key length wrong');\n                        }\n                        authentication = crypto_js_1.default.DES.encrypt(crypto_js_1.default.enc.Hex.parse('0000000000000000'), crypto_js_1.default.enc.Hex.parse(hexSessionKey), {\n                            mode: crypto_js_1.default.mode.ECB,\n                        });\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 48 ff 00 1001 %w %*', tracknum, utils_1.wordArrayToByteArray(authentication.ciphertext));\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 48 00 00 1001 %?%?')];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.sendTrack = function (wireformat, discformat, frames, pktSize, packets, hexSessionKey, progressCallback) {\n        var packets_1, packets_1_1;\n        var e_3, _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var totalBytes, query, reply, swapNeeded, packetCount, writtenBytes, _b, key, iv, data, binpack, packedLength, e_3_1, res, replydata;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (hexSessionKey.length !== 16) {\n                            throw new Error('Supplied Session Key length wrong');\n                        }\n                        totalBytes = pktSize + 24;\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 28 ff 000100 1001 ffff 00 %b %b %d %d', wireformat, discformat, frames, totalBytes);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _c.sent();\n                        query_utils_1.scanQuery(reply, '1800 080046 f0030103 28 00 000100 1001 %?%? 00 %*');\n                        swapNeeded = !utils_1.isBigEndian();\n                        packetCount = 0;\n                        writtenBytes = 0;\n                        _c.label = 2;\n                    case 2:\n                        _c.trys.push([2, 8, 9, 14]);\n                        packets_1 = __asyncValues(packets);\n                        _c.label = 3;\n                    case 3: return [4 /*yield*/, packets_1.next()];\n                    case 4:\n                        if (!(packets_1_1 = _c.sent(), !packets_1_1.done)) return [3 /*break*/, 7];\n                        _b = packets_1_1.value, key = _b.key, iv = _b.iv, data = _b.data;\n                        progressCallback && progressCallback({ totalBytes: totalBytes, writtenBytes: writtenBytes });\n                        binpack = void 0;\n                        if (packetCount === 0) {\n                            packedLength = new Uint8Array(new Uint32Array([pktSize]).buffer);\n                            if (swapNeeded) {\n                                packedLength.reverse();\n                            }\n                            binpack = utils_1.concatUint8Arrays(new Uint8Array([0, 0, 0, 0]), packedLength, key, iv, data);\n                        }\n                        else {\n                            binpack = data;\n                        }\n                        return [4 /*yield*/, this.netMd.writeBulk(binpack)];\n                    case 5:\n                        _c.sent();\n                        packetCount += 1;\n                        writtenBytes += data.length;\n                        _c.label = 6;\n                    case 6: return [3 /*break*/, 3];\n                    case 7: return [3 /*break*/, 14];\n                    case 8:\n                        e_3_1 = _c.sent();\n                        e_3 = { error: e_3_1 };\n                        return [3 /*break*/, 14];\n                    case 9:\n                        _c.trys.push([9, , 12, 13]);\n                        if (!(packets_1_1 && !packets_1_1.done && (_a = packets_1.return))) return [3 /*break*/, 11];\n                        return [4 /*yield*/, _a.call(packets_1)];\n                    case 10:\n                        _c.sent();\n                        _c.label = 11;\n                    case 11: return [3 /*break*/, 13];\n                    case 12:\n                        if (e_3) throw e_3.error;\n                        return [7 /*endfinally*/];\n                    case 13: return [7 /*endfinally*/];\n                    case 14:\n                        progressCallback && progressCallback({ totalBytes: totalBytes, writtenBytes: writtenBytes });\n                        return [4 /*yield*/, this.readReply()];\n                    case 15:\n                        reply = _c.sent();\n                        return [4 /*yield*/, this.netMd.getReplyLength()];\n                    case 16:\n                        _c.sent();\n                        res = query_utils_1.scanQuery(reply, '1800 080046 f0030103 28 00 000100 1001 %w 00 %?%? %?%?%?%? %?%?%?%? %*');\n                        replydata = crypto_js_1.default.DES.decrypt(crypto_js_1.default.enc.Hex.parse(utils_1.hexEncode(res[1])), crypto_js_1.default.enc.Hex.parse(hexSessionKey), {\n                            mode: crypto_js_1.default.mode.CBC,\n                            iv: crypto_js_1.default.enc.Hex.parse('0000000000000000'),\n                        }).toString(crypto_js_1.default.enc.Utf8);\n                        return [2 /*return*/, [jsbi_1.default.toNumber(res[0]), replydata.substring(0, 8), replydata.substring(12, 32)]];\n                }\n            });\n        });\n    };\n    NetMDInterface.prototype.getTrackUUID = function (track) {\n        return __awaiter(this, void 0, void 0, function () {\n            var query, reply;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        query = query_utils_1.formatQuery('1800 080046 f0030103 23 ff 1001 %w', track);\n                        return [4 /*yield*/, this.sendQuery(query)];\n                    case 1:\n                        reply = _a.sent();\n                        return [2 /*return*/, query_utils_1.scanQuery(reply, '1800 080046 f0030103 23 00 1001 %?%? %*')[0]];\n                }\n            });\n        });\n    };\n    return NetMDInterface;\n}());\nexports.NetMDInterface = NetMDInterface;\nfunction retailmac(key, value, iv) {\n    if (iv === void 0) { iv = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]); }\n    var subkeyA = key.subarray(0, 8);\n    var beginning = value.subarray(0, value.length - 8);\n    var end = value.subarray(value.length - 8, value.length);\n    var step1 = crypto_js_1.default.DES.encrypt(crypto_js_1.default.lib.WordArray.create(beginning), crypto_js_1.default.lib.WordArray.create(subkeyA), {\n        mode: crypto_js_1.default.mode.CBC,\n        iv: crypto_js_1.default.lib.WordArray.create(iv),\n    });\n    var iv2 = crypto_js_1.default.enc.Hex.stringify(step1.ciphertext);\n    iv2 = iv2.substring(0, iv2.length - 16); // last 8 byte\n    var step2 = crypto_js_1.default.TripleDES.encrypt(crypto_js_1.default.lib.WordArray.create(end), crypto_js_1.default.lib.WordArray.create(key), {\n        mode: crypto_js_1.default.mode.CBC,\n        iv: crypto_js_1.default.enc.Hex.parse(iv2),\n    });\n    return crypto_js_1.default.enc.Hex.stringify(step2.ciphertext).substring(0, 16);\n}\nexports.retailmac = retailmac;\nvar discforwire = (_b = {},\n    _b[Wireformat.pcm] = DiscFormat.spStereo,\n    _b[Wireformat.lp2] = DiscFormat.lp2,\n    _b[Wireformat.l105kbps] = DiscFormat.lp2,\n    _b[Wireformat.lp4] = DiscFormat.lp4,\n    _b);\nvar EKBOpenSource = /** @class */ (function () {\n    function EKBOpenSource() {\n    }\n    EKBOpenSource.prototype.getRootKey = function () {\n        // prettier-ignore\n        return new Uint8Array([\n            0x12, 0x34, 0x56, 0x78, 0x9a, 0xbc, 0xde, 0xf0,\n            0x0f, 0xed, 0xcb, 0xa9, 0x87, 0x65, 0x43, 0x21\n        ]);\n    };\n    EKBOpenSource.prototype.getEKBID = function () {\n        return 0x26422642;\n    };\n    EKBOpenSource.prototype.getEKBDataForLeafId = function () {\n        // prettier-ignore\n        return [\n            [\n                new Uint8Array([0x25, 0x45, 0x06, 0x4d, 0xea, 0xca, 0x14, 0xf9, 0x96, 0xbd, 0xc8, 0xa4, 0x06, 0xc2, 0x2b, 0x81]),\n                new Uint8Array([0xfb, 0x60, 0xbd, 0xdd, 0x0d, 0xbc, 0xab, 0x84, 0x8a, 0x00, 0x5e, 0x03, 0x19, 0x4d, 0x3e, 0xda]),\n            ],\n            9,\n            new Uint8Array([\n                0x8f, 0x2b, 0xc3, 0x52, 0xe8, 0x6c, 0x5e, 0xd3, 0x06, 0xdc, 0xae, 0x18,\n                0xd2, 0xf3, 0x8c, 0x7f, 0x89, 0xb5, 0xe1, 0x85, 0x55, 0xa1, 0x05, 0xea\n            ])\n        ];\n    };\n    return EKBOpenSource;\n}());\nexports.EKBOpenSource = EKBOpenSource;\nvar MDTrack = /** @class */ (function () {\n    function MDTrack(title, format, data, chunkSize, encryptPacketsIterator) {\n        this.title = title;\n        this.format = format;\n        this.data = data;\n        this.chunkSize = chunkSize;\n        this.encryptPacketsIterator = encryptPacketsIterator;\n    }\n    MDTrack.prototype.getTitle = function () {\n        return this.title;\n    };\n    MDTrack.prototype.getDataFormat = function () {\n        return this.format;\n    };\n    MDTrack.prototype.getFrameCount = function () {\n        return this.getTotalSize() / this.getFrameSize();\n    };\n    MDTrack.prototype.getFrameSize = function () {\n        return exports.FrameSize[this.format];\n    };\n    MDTrack.prototype.getChunkSize = function () {\n        return this.chunkSize;\n    };\n    MDTrack.prototype.getTotalSize = function () {\n        var frameSize = this.getFrameSize();\n        var len = this.data.byteLength;\n        if (len % frameSize !== 0) {\n            len = len + (frameSize - (len % frameSize));\n        }\n        return len;\n    };\n    MDTrack.prototype.getContentID = function () {\n        // prettier-ignore\n        return new Uint8Array([\n            0x01, 0x0f, 0x50, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x48,\n            0xa2, 0x8d, 0x3e, 0x1a, 0x3b, 0x0c, 0x44, 0xaf, 0x2f, 0xa0,\n        ]);\n    };\n    MDTrack.prototype.getKEK = function () {\n        return new Uint8Array([0x14, 0xe3, 0x83, 0x4e, 0xe2, 0xd3, 0xcc, 0xa5]);\n    };\n    MDTrack.prototype.getPackets = function () {\n        // Deprecated. Use getPacketIterator\n        var datakey = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);\n        var firstiv = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);\n        var datakeyWA = crypto_js_1.default.lib.WordArray.create(datakey);\n        var kekWA = crypto_js_1.default.lib.WordArray.create(this.getKEK());\n        var key = crypto_js_1.default.DES.encrypt(datakeyWA, kekWA, { mode: crypto_js_1.default.mode.ECB });\n        var firstivWA = crypto_js_1.default.lib.WordArray.create(firstiv);\n        var dataWA = crypto_js_1.default.lib.WordArray.create(this.data);\n        var encrypted = crypto_js_1.default.DES.encrypt(dataWA, key.ciphertext, {\n            mode: crypto_js_1.default.mode.CBC,\n            iv: firstivWA,\n        });\n        var encryptedData = utils_1.wordArrayToByteArray(encrypted.ciphertext);\n        encryptedData = encryptedData.subarray(0, this.data.byteLength); // CAVEAT: don't know why, but python Crypto returns 8 bytes less that js Crypto\n        return [[datakey, firstiv, encryptedData]];\n    };\n    MDTrack.prototype.getPacketWorkerIterator = function () {\n        return this.encryptPacketsIterator({\n            kek: this.getKEK(),\n            data: this.data,\n            frameSize: this.getFrameSize(),\n            chunkSize: this.chunkSize,\n        });\n    };\n    MDTrack.prototype.getPacketIterator = function () {\n        return __asyncGenerator(this, arguments, function getPacketIterator_1() {\n            var iv, ivWA, kekWA, rawKeyWA, keyDec, key, defaultChunkSize, packetCount, chunkSize, uint8DataArray, frameSize, padding, offset, dataChunk, dataChunkWA, encryptedChunk, encryptedDataChunk;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        iv = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);\n                        ivWA = crypto_js_1.default.lib.WordArray.create(iv);\n                        kekWA = crypto_js_1.default.lib.WordArray.create(this.getKEK());\n                        rawKeyWA = crypto_js_1.default.lib.WordArray.random(8);\n                        keyDec = crypto_js_1.default.DES.decrypt({\n                            ciphertext: rawKeyWA,\n                        }, kekWA, { mode: crypto_js_1.default.mode.ECB, padding: crypto_js_1.default.pad.Pkcs7 });\n                        keyDec.sigBytes = 8;\n                        key = utils_1.wordArrayToByteArray(keyDec);\n                        defaultChunkSize = 0x00100000;\n                        packetCount = 0;\n                        chunkSize = 0;\n                        uint8DataArray = new Uint8Array(this.data);\n                        frameSize = this.getFrameSize();\n                        if (uint8DataArray.length % frameSize !== 0) {\n                            padding = frameSize - (uint8DataArray.length % frameSize);\n                            uint8DataArray = utils_1.concatUint8Arrays(uint8DataArray, new Uint8Array(Array(padding).fill(0)));\n                        }\n                        offset = 0;\n                        _a.label = 1;\n                    case 1:\n                        if (!(offset < uint8DataArray.length)) return [3 /*break*/, 4];\n                        if (packetCount > 0) {\n                            chunkSize = defaultChunkSize;\n                        }\n                        else {\n                            chunkSize = defaultChunkSize - 24;\n                        }\n                        chunkSize = Math.min(chunkSize, uint8DataArray.length - offset);\n                        dataChunk = uint8DataArray.subarray(offset, offset + chunkSize);\n                        dataChunkWA = crypto_js_1.default.lib.WordArray.create(dataChunk);\n                        encryptedChunk = crypto_js_1.default.DES.encrypt(dataChunkWA, rawKeyWA, {\n                            mode: crypto_js_1.default.mode.CBC,\n                            iv: ivWA,\n                        });\n                        encryptedDataChunk = utils_1.wordArrayToByteArray(encryptedChunk.ciphertext);\n                        encryptedDataChunk = encryptedDataChunk.subarray(0, chunkSize); //encryptedDataChunk.length - 8\n                        return [4 /*yield*/, __await([key, iv, encryptedDataChunk])];\n                    case 2: //encryptedDataChunk.length - 8\n                    return [4 /*yield*/, _a.sent()];\n                    case 3:\n                        _a.sent();\n                        // Next iv\n                        ivWA = crypto_js_1.default.lib.WordArray.create(encryptedDataChunk.subarray(encryptedDataChunk.length - 8, encryptedDataChunk.length));\n                        iv = utils_1.wordArrayToByteArray(ivWA);\n                        offset = offset + chunkSize;\n                        packetCount += 1;\n                        return [3 /*break*/, 1];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return MDTrack;\n}());\nexports.MDTrack = MDTrack;\nvar MDSession = /** @class */ (function () {\n    function MDSession(md, ekbobject, hexSessionKey) {\n        this.md = md;\n        this.ekbobject = ekbobject;\n        this.hexSessionKey = hexSessionKey;\n    }\n    MDSession.prototype.init = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, chain, depth, sig, hostnonce, devnonce, nonce;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.md.enterSecureSession()];\n                    case 1:\n                        _b.sent();\n                        _a = __read(this.ekbobject.getEKBDataForLeafId(), 3), chain = _a[0], depth = _a[1], sig = _a[2];\n                        return [4 /*yield*/, this.md.sendKeyData(jsbi_1.default.BigInt(this.ekbobject.getEKBID()), chain, depth, sig)];\n                    case 2:\n                        _b.sent();\n                        hostnonce = new Uint8Array(Array(8)\n                            .fill(0)\n                            .map(function (_) { return Math.round(Math.random() * 255); }));\n                        return [4 /*yield*/, this.md.sessionKeyExchange(hostnonce)];\n                    case 3:\n                        devnonce = _b.sent();\n                        nonce = utils_1.concatUint8Arrays(hostnonce, devnonce);\n                        this.hexSessionKey = retailmac(this.ekbobject.getRootKey(), nonce);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MDSession.prototype.downloadTrack = function (trk, progressCallback) {\n        return __awaiter(this, void 0, void 0, function () {\n            var dataFormat, _a, track, uuid, ccid;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!this.hexSessionKey) {\n                            throw new Error(\"Call init first!\");\n                        }\n                        return [4 /*yield*/, this.md.setupDownload(trk.getContentID(), trk.getKEK(), this.hexSessionKey)];\n                    case 1:\n                        _b.sent();\n                        dataFormat = trk.getDataFormat();\n                        return [4 /*yield*/, this.md.sendTrack(dataFormat, discforwire[dataFormat], trk.getFrameCount(), trk.getTotalSize(), trk.getPacketWorkerIterator(), this.hexSessionKey, progressCallback)];\n                    case 2:\n                        _a = __read.apply(void 0, [_b.sent(), 3]), track = _a[0], uuid = _a[1], ccid = _a[2];\n                        return [4 /*yield*/, this.md.cacheTOC()];\n                    case 3:\n                        _b.sent();\n                        return [4 /*yield*/, this.md.setTrackTitle(track, trk.title)];\n                    case 4:\n                        _b.sent();\n                        return [4 /*yield*/, this.md.syncTOC()];\n                    case 5:\n                        _b.sent();\n                        return [4 /*yield*/, this.md.commitTrack(track, this.hexSessionKey)];\n                    case 6:\n                        _b.sent();\n                        return [2 /*return*/, [track, uuid, ccid]];\n                }\n            });\n        });\n    };\n    MDSession.prototype.close = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var err_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(this.hexSessionKey !== undefined)) return [3 /*break*/, 5];\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.md.sessionKeyForget()];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        err_3 = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 4:\n                        this.hexSessionKey = undefined;\n                        _a.label = 5;\n                    case 5: return [4 /*yield*/, this.md.leaveSecureSession()];\n                    case 6:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return MDSession;\n}());\nexports.MDSession = MDSession;\n//# sourceMappingURL=netmd-interface.js.map","\"use strict\";\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __await = (this && this.__await) || function (v) { return this instanceof __await ? (this.v = v, this) : new __await(v); }\nvar __asyncGenerator = (this && this.__asyncGenerator) || function (thisArg, _arguments, generator) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n    function fulfill(value) { resume(\"next\", value); }\n    function reject(value) { resume(\"throw\", value); }\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar crypto_js_1 = __importDefault(require(\"crypto-js\"));\nvar utils_1 = require(\"./utils\");\nfunction getAsyncPacketIterator(_a) {\n    var data = _a.data, frameSize = _a.frameSize, kek = _a.kek, chunkSize = _a.chunkSize;\n    return __asyncGenerator(this, arguments, function getAsyncPacketIterator_1() {\n        var iv, ivWA, kekWA, rawKeyWA, keyDec, key, defaultChunkSize, packetCount, currentChunkSize, uint8DataArray, padding, offset, dataChunk, dataChunkWA, encryptedChunk, encryptedDataChunk, nextIvWA, nextiv;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    iv = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);\n                    ivWA = crypto_js_1.default.lib.WordArray.create(iv);\n                    kekWA = crypto_js_1.default.lib.WordArray.create(kek);\n                    rawKeyWA = crypto_js_1.default.lib.WordArray.random(8);\n                    keyDec = crypto_js_1.default.DES.decrypt({\n                        ciphertext: rawKeyWA,\n                    }, kekWA, { mode: crypto_js_1.default.mode.ECB, padding: crypto_js_1.default.pad.Pkcs7 });\n                    keyDec.sigBytes = 8;\n                    key = utils_1.wordArrayToByteArray(keyDec);\n                    defaultChunkSize = chunkSize ? chunkSize : 0x00100000;\n                    packetCount = 0;\n                    currentChunkSize = 0;\n                    uint8DataArray = new Uint8Array(data);\n                    if (uint8DataArray.length % frameSize !== 0) {\n                        padding = frameSize - (uint8DataArray.length % frameSize);\n                        uint8DataArray = utils_1.concatUint8Arrays(uint8DataArray, new Uint8Array(Array(padding).fill(0)));\n                    }\n                    offset = 0;\n                    _a.label = 1;\n                case 1:\n                    if (!(offset < uint8DataArray.length)) return [3 /*break*/, 4];\n                    if (packetCount > 0) {\n                        currentChunkSize = defaultChunkSize;\n                    }\n                    else {\n                        currentChunkSize = defaultChunkSize - 24;\n                    }\n                    currentChunkSize = Math.min(currentChunkSize, uint8DataArray.length - offset);\n                    dataChunk = uint8DataArray.subarray(offset, offset + currentChunkSize);\n                    dataChunkWA = crypto_js_1.default.lib.WordArray.create(dataChunk);\n                    encryptedChunk = crypto_js_1.default.DES.encrypt(dataChunkWA, rawKeyWA, {\n                        mode: crypto_js_1.default.mode.CBC,\n                        iv: ivWA,\n                    });\n                    encryptedDataChunk = utils_1.wordArrayToByteArray(encryptedChunk.ciphertext);\n                    encryptedDataChunk = encryptedDataChunk.subarray(0, currentChunkSize); //encryptedDataChunk.length - 8\n                    nextIvWA = crypto_js_1.default.lib.WordArray.create(encryptedDataChunk.subarray(encryptedDataChunk.length - 8, encryptedDataChunk.length));\n                    nextiv = utils_1.wordArrayToByteArray(ivWA);\n                    return [4 /*yield*/, __await({ key: key, iv: iv, data: encryptedDataChunk })];\n                case 2: return [4 /*yield*/, _a.sent()];\n                case 3:\n                    _a.sent();\n                    ivWA = nextIvWA;\n                    iv = nextiv;\n                    offset = offset + currentChunkSize;\n                    packetCount += 1;\n                    return [3 /*break*/, 1];\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.getAsyncPacketIterator = getAsyncPacketIterator;\n//# sourceMappingURL=encrypt-generator.js.map","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./netmd\"));\n__export(require(\"./netmd-interface\"));\n__export(require(\"./netmd-commands\"));\n__export(require(\"./encrypt-generator\"));\nvar utils_1 = require(\"./utils\");\nexports.formatTimeFromFrames = utils_1.formatTimeFromFrames;\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __await = (this && this.__await) || function (v) { return this instanceof __await ? (this.v = v, this) : new __await(v); }\nvar __asyncGenerator = (this && this.__asyncGenerator) || function (thisArg, _arguments, generator) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n    function fulfill(value) { resume(\"next\", value); }\n    function reject(value) { resume(\"throw\", value); }\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar encrypt_generator_1 = require(\"./encrypt-generator\");\n// This generator uses a worker thread to encrypt the nextChunk\n// while yielding the current one.\nfunction makeGetAsyncPacketIteratorOnWorkerThread(worker, progressCallback) {\n    return function getAsyncPacketIteratorOnWorkerThread(_a) {\n        var data = _a.data, frameSize = _a.frameSize, kek = _a.kek, chunkSize = _a.chunkSize;\n        return __asyncGenerator(this, arguments, function getAsyncPacketIteratorOnWorkerThread_1() {\n            var w, initWorker, askNextChunk, resolver, encryptedBytes, totalBytes, chunks, queueNextChunk, i, r;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        w = worker;\n                        initWorker = function () {\n                            w.postMessage({\n                                action: 'init',\n                                data: data,\n                                frameSize: frameSize,\n                                kek: kek,\n                                chunkSize: chunkSize,\n                            }, [data]);\n                        };\n                        askNextChunk = function () {\n                            w.postMessage({ action: 'getChunk' });\n                        };\n                        w.onmessage = function (ev) {\n                            resolver(ev.data);\n                        };\n                        encryptedBytes = 0;\n                        totalBytes = data.byteLength;\n                        chunks = [];\n                        queueNextChunk = function () {\n                            var chunkPromise = new Promise(function (resolve) {\n                                resolver = function (data) {\n                                    if (data !== null) {\n                                        encryptedBytes += data.data.byteLength;\n                                        progressCallback && progressCallback({ totalBytes: totalBytes, encryptedBytes: encryptedBytes });\n                                        queueNextChunk();\n                                    }\n                                    resolve(data);\n                                };\n                            });\n                            chunks.push(chunkPromise);\n                            askNextChunk();\n                        };\n                        initWorker();\n                        queueNextChunk();\n                        i = 0;\n                        _a.label = 1;\n                    case 1:\n                        if (!1) return [3 /*break*/, 5];\n                        return [4 /*yield*/, __await(chunks[i])];\n                    case 2:\n                        r = _a.sent();\n                        if (r === null) {\n                            return [3 /*break*/, 5];\n                        }\n                        return [4 /*yield*/, __await(r)];\n                    case 3: return [4 /*yield*/, _a.sent()];\n                    case 4:\n                        _a.sent();\n                        delete chunks[i];\n                        i++;\n                        return [3 /*break*/, 1];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n}\nexports.makeGetAsyncPacketIteratorOnWorkerThread = makeGetAsyncPacketIteratorOnWorkerThread;\nif (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope) {\n    // Worker\n    var iterator_1;\n    onmessage = function (ev) { return __awaiter(void 0, void 0, void 0, function () {\n        var _a, action, others, data, frameSize, kek, chunkSize, _b, value, done, key, iv, data;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    _a = ev.data, action = _a.action, others = __rest(_a, [\"action\"]);\n                    if (!(action === 'init')) return [3 /*break*/, 1];\n                    data = others.data, frameSize = others.frameSize, kek = others.kek, chunkSize = others.chunkSize;\n                    iterator_1 = encrypt_generator_1.getAsyncPacketIterator({ data: data, frameSize: frameSize, kek: kek, chunkSize: chunkSize });\n                    return [3 /*break*/, 3];\n                case 1:\n                    if (!(action === 'getChunk')) return [3 /*break*/, 3];\n                    return [4 /*yield*/, iterator_1.next()];\n                case 2:\n                    _b = _c.sent(), value = _b.value, done = _b.done;\n                    if (done) {\n                        postMessage(null);\n                        self.close();\n                    }\n                    else {\n                        key = value.key, iv = value.iv, data = value.data;\n                        postMessage({ key: key, iv: iv, data: data }, [data.buffer]);\n                    }\n                    _c.label = 3;\n                case 3: return [2 /*return*/];\n            }\n        });\n    }); };\n}\nelse {\n    // Main\n}\n//# sourceMappingURL=web-encrypt-worker.js.map","module.exports = __webpack_public_path__ + \"static/media/chrome-icon.f3b6c54c.svg\";","\"use strict\";\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nvar jsbi_1 = __importDefault(require(\"jsbi\"));\n// prettier-ignore\nvar FORMAT_TYPE_LEN_DICT = {\n    'b': 1,\n    'w': 2,\n    'd': 4,\n    'q': 8,\n};\nfunction formatQuery(format) {\n    var e_1, _a;\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    var result = [];\n    var half = null;\n    var argStack = Array.from(args);\n    var escaped = false;\n    try {\n        for (var format_1 = __values(format), format_1_1 = format_1.next(); !format_1_1.done; format_1_1 = format_1.next()) {\n            var char = format_1_1.value;\n            if (escaped) {\n                escaped = false;\n                var value = argStack.shift();\n                if (char in FORMAT_TYPE_LEN_DICT) {\n                    var numberValue = jsbi_1.default.BigInt(value);\n                    for (var byte = FORMAT_TYPE_LEN_DICT[char] - 1; byte >= 0; byte--) {\n                        var v = jsbi_1.default.signedRightShift(numberValue, jsbi_1.default.BigInt(byte * 8));\n                        v = jsbi_1.default.bitwiseAnd(v, jsbi_1.default.BigInt(0xff));\n                        result.push(jsbi_1.default.toNumber(v));\n                    }\n                }\n                else if (char === 'x' || char === 's') {\n                    var stringValue = utils_1.assertString(value);\n                    var stringLength = stringValue.length;\n                    if (char === 's') {\n                        stringLength += 1;\n                    }\n                    result.push((stringLength >> 8) & 0xff);\n                    result.push(stringLength & 0xff);\n                    result.push.apply(result, __spread(utils_1.stringToCharCodeArray(stringValue)));\n                    if (char === 's') {\n                        result.push(0);\n                    }\n                }\n                else if (char === '*') {\n                    if (typeof value === 'string') {\n                        result.push.apply(result, __spread(utils_1.stringToCharCodeArray(value)));\n                    }\n                    else if (value instanceof Uint8Array) {\n                        result.push.apply(result, __spread(value));\n                    }\n                    else {\n                        utils_1.assert(false, \"Unexpected type for value\");\n                    }\n                }\n                else {\n                    utils_1.assert(false, \"Unrecognized format char \" + char);\n                }\n                continue;\n            }\n            if (char === '%') {\n                utils_1.assert(half === null, \"Expected \\\"half\\\" to be null\");\n                escaped = true;\n                continue;\n            }\n            if (char === ' ') {\n                continue;\n            }\n            if (half === null) {\n                half = char;\n            }\n            else {\n                result.push(Number.parseInt(half + char, 16));\n                half = null;\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (format_1_1 && !format_1_1.done && (_a = format_1.return)) _a.call(format_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return new Uint8Array(result).buffer;\n}\nexports.formatQuery = formatQuery;\nfunction scanQuery(query, format) {\n    var e_2, _a;\n    var result = [];\n    var inputStack;\n    if (query instanceof ArrayBuffer) {\n        inputStack = Array.from(new Uint8Array(query));\n    }\n    else {\n        inputStack = query;\n    }\n    var initialLength = inputStack.length;\n    var half = null;\n    var escaped = false;\n    try {\n        for (var format_2 = __values(format), format_2_1 = format_2.next(); !format_2_1.done; format_2_1 = format_2.next()) {\n            var char = format_2_1.value;\n            if (escaped) {\n                escaped = false;\n                if (char === '?') {\n                    inputStack.shift();\n                    continue;\n                }\n                if (char in FORMAT_TYPE_LEN_DICT) {\n                    var value = jsbi_1.default.BigInt(0);\n                    for (var byte = FORMAT_TYPE_LEN_DICT[char] - 1; byte >= 0; byte--) {\n                        var v = jsbi_1.default.BigInt(inputStack.shift());\n                        v = jsbi_1.default.leftShift(v, jsbi_1.default.BigInt(byte * 8));\n                        value = jsbi_1.default.bitwiseOr(value, v);\n                    }\n                    result.push(value);\n                }\n                else if (char === 's' || char === 'x') {\n                    var length = (inputStack.shift() << 8) | inputStack.shift();\n                    var newInputStack = inputStack.splice(length);\n                    var value = String.fromCharCode.apply(String, __spread(inputStack));\n                    inputStack = newInputStack;\n                    if (char === 's') {\n                        result.push(value.substring(0, value.length - 1));\n                    }\n                    else {\n                        result.push(value);\n                    }\n                }\n                else if (char === '*') {\n                    var value = String.fromCharCode.apply(String, __spread(inputStack.splice(0)));\n                    result.push(value);\n                }\n                else if (char === '#') {\n                    var value = new Uint8Array(inputStack.splice(0));\n                    result.push(value);\n                }\n                else {\n                    throw new Error(\"Unrecognized format char \" + char);\n                }\n                continue;\n            }\n            if (char === '%') {\n                utils_1.assert(half === null);\n                escaped = true;\n                continue;\n            }\n            if (char === ' ') {\n                continue;\n            }\n            if (half === null) {\n                half = char;\n            }\n            else {\n                var inputValue = inputStack.shift();\n                var formatValue = Number.parseInt(half + char, 16);\n                if (formatValue != inputValue) {\n                    var i = initialLength - inputStack.length - 1;\n                    throw new Error(\"Format and input mismatch at \" + i + \": expected \" + formatValue + \", got \" + inputValue);\n                }\n                half = null;\n            }\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (format_2_1 && !format_2_1.done && (_a = format_2.return)) _a.call(format_2);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    utils_1.assert(inputStack.length === 0, inputStack.length + \" Bytes remaining to parse\");\n    return result;\n}\nexports.scanQuery = scanQuery;\nfunction BCD2int(bcd /* max 32 bits */) {\n    var value = 0;\n    var nibble = 0;\n    while (bcd !== 0) {\n        var nibbleValue = bcd & 0xf;\n        bcd = bcd >>> 4;\n        value += nibbleValue * Math.pow(10, nibble);\n        nibble += 1;\n    }\n    return value;\n}\nexports.BCD2int = BCD2int;\nfunction int2BCD(value, length) {\n    var _a;\n    if (length === void 0) { length = 1; }\n    if (length > 4) {\n        throw new Error(\"Unsupported length. Max allowed is 4\");\n    }\n    if (value > Math.pow(10, length * 2) - 1) {\n        throw new Error(\"Value \" + value + \" cannot fit in \" + length + \" bytes in BCD\");\n    }\n    var bcd = 0;\n    var nibble = 0;\n    var nibbleValue;\n    while (value) {\n        _a = __read([Math.floor(value / 10), value % 10], 2), value = _a[0], nibbleValue = _a[1];\n        bcd |= nibbleValue << (4 * nibble);\n        nibble += 1;\n    }\n    return bcd;\n}\nexports.int2BCD = int2BCD;\n//# sourceMappingURL=query-utils.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar _a, _b, _c;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar netmd_1 = require(\"./netmd\");\nvar netmd_interface_1 = require(\"./netmd-interface\");\nvar utils_1 = require(\"./utils\");\nvar EncodingName = (_a = {},\n    _a[netmd_interface_1.Encoding.sp] = 'sp',\n    _a[netmd_interface_1.Encoding.lp2] = 'lp2',\n    _a[netmd_interface_1.Encoding.lp4] = 'lp4',\n    _a);\nvar ChannelCount = (_b = {},\n    _b[netmd_interface_1.Channels.mono] = 'mono',\n    _b[netmd_interface_1.Channels.stereo] = 'stereo',\n    _b);\nvar Flag = (_c = {},\n    _c[netmd_interface_1.TrackFlag.protected] = 'protected',\n    _c[netmd_interface_1.TrackFlag.unprotected] = 'unprotected',\n    _c);\nfunction openPairedDevice(usb, logger) {\n    return __awaiter(this, void 0, void 0, function () {\n        var devices, netmd;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, usb.getDevices()];\n                case 1:\n                    devices = _a.sent();\n                    if (devices.length === 0) {\n                        return [2 /*return*/, null]; // No device found\n                    }\n                    netmd = new netmd_1.NetMD(devices[0], 0, logger);\n                    return [4 /*yield*/, netmd.init()];\n                case 2:\n                    _a.sent();\n                    return [2 /*return*/, new netmd_interface_1.NetMDInterface(netmd)];\n            }\n        });\n    });\n}\nexports.openPairedDevice = openPairedDevice;\nfunction openNewDevice(usb, logger) {\n    return __awaiter(this, void 0, void 0, function () {\n        var filters, device, err_1, netmd;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    filters = netmd_1.DevicesIds.map(function (_a) {\n                        var vendorId = _a.vendorId, deviceId = _a.deviceId;\n                        return ({ vendorId: vendorId, deviceId: deviceId });\n                    });\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, usb.requestDevice({ filters: filters })];\n                case 2:\n                    device = _a.sent();\n                    return [3 /*break*/, 4];\n                case 3:\n                    err_1 = _a.sent();\n                    return [2 /*return*/, null]; // No device found or not allowed by the user\n                case 4:\n                    netmd = new netmd_1.NetMD(device, 0, logger);\n                    return [4 /*yield*/, netmd.init()];\n                case 5:\n                    _a.sent();\n                    return [2 /*return*/, new netmd_interface_1.NetMDInterface(netmd)];\n            }\n        });\n    });\n}\nexports.openNewDevice = openNewDevice;\nfunction listDevice(usb) {\n    var _a, _b, _c, _d;\n    return __awaiter(this, void 0, void 0, function () {\n        var filters, device, id, d;\n        return __generator(this, function (_e) {\n            switch (_e.label) {\n                case 0:\n                    filters = netmd_1.DevicesIds.map(function (_a) {\n                        var vendorId = _a.vendorId, deviceId = _a.deviceId;\n                        return ({ vendorId: vendorId, deviceId: deviceId });\n                    });\n                    return [4 /*yield*/, usb.requestDevice({ filters: filters })];\n                case 1:\n                    device = _e.sent();\n                    id = netmd_1.DevicesIds.find(function (did) {\n                        return did.deviceId == device.productId && did.vendorId === device.vendorId;\n                    });\n                    d = {\n                        manufacturerName: (_a = device.manufacturerName, (_a !== null && _a !== void 0 ? _a : 'unknown')),\n                        productName: (_b = device.productName, (_b !== null && _b !== void 0 ? _b : 'unknown')),\n                        vendorId: device.vendorId,\n                        productId: device.productId,\n                        name: (_d = (_c = id) === null || _c === void 0 ? void 0 : _c.name, (_d !== null && _d !== void 0 ? _d : 'unknown')),\n                    };\n                    return [2 /*return*/, d];\n            }\n        });\n    });\n}\nexports.listDevice = listDevice;\nfunction countTracksInDisc(disc) {\n    return disc.groups.reduce(function (acc, g, _) {\n        return acc + g.tracks.length;\n    }, 0);\n}\nexports.countTracksInDisc = countTracksInDisc;\nfunction getTracks(disc) {\n    var e_1, _a, e_2, _b;\n    var tracks = [];\n    try {\n        for (var _c = __values(disc.groups), _d = _c.next(); !_d.done; _d = _c.next()) {\n            var group = _d.value;\n            try {\n                for (var _e = (e_2 = void 0, __values(group.tracks)), _f = _e.next(); !_f.done; _f = _e.next()) {\n                    var track = _f.value;\n                    tracks.push(track);\n                }\n            }\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\n            finally {\n                try {\n                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                }\n                finally { if (e_2) throw e_2.error; }\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return tracks;\n}\nexports.getTracks = getTracks;\nfunction listContent(mdIface) {\n    return __awaiter(this, void 0, void 0, function () {\n        var flags, title, _a, discUsed, discTotal, discLeft, trackCount, disc, trackGroupList, _b, _c, _d, groupIndex, _e, groupName, trackLists, g, tracks, _f, _g, _h, trackIndex, track, title_1, _j, codec, channelCount, duration, _k, flags_1, t, e_3_1, e_4_1;\n        var e_4, _l, e_3, _m;\n        return __generator(this, function (_o) {\n            switch (_o.label) {\n                case 0: return [4 /*yield*/, mdIface.getDiscFlags()];\n                case 1:\n                    flags = _o.sent();\n                    return [4 /*yield*/, mdIface.getDiscTitle()];\n                case 2:\n                    title = _o.sent();\n                    return [4 /*yield*/, mdIface.getDiscCapacity()];\n                case 3:\n                    _a = __read.apply(void 0, [_o.sent(), 3]), discUsed = _a[0], discTotal = _a[1], discLeft = _a[2];\n                    return [4 /*yield*/, mdIface.getTrackCount()];\n                case 4:\n                    trackCount = _o.sent();\n                    disc = {\n                        title: title,\n                        writable: !!(flags & netmd_interface_1.DiscFlag.writable),\n                        writeProtected: !!(flags & netmd_interface_1.DiscFlag.writeProtected),\n                        used: utils_1.timeToFrames(discUsed),\n                        left: utils_1.timeToFrames(discLeft),\n                        total: utils_1.timeToFrames(discTotal),\n                        trackCount: trackCount,\n                        groups: [],\n                    };\n                    return [4 /*yield*/, mdIface.getTrackGroupList()];\n                case 5:\n                    trackGroupList = _o.sent();\n                    _o.label = 6;\n                case 6:\n                    _o.trys.push([6, 21, 22, 23]);\n                    _b = __values(trackGroupList.entries()), _c = _b.next();\n                    _o.label = 7;\n                case 7:\n                    if (!!_c.done) return [3 /*break*/, 20];\n                    _d = __read(_c.value, 2), groupIndex = _d[0], _e = __read(_d[1], 2), groupName = _e[0], trackLists = _e[1];\n                    g = {\n                        index: groupIndex,\n                        title: groupName,\n                        tracks: [],\n                    };\n                    disc.groups.push(g);\n                    tracks = [];\n                    _o.label = 8;\n                case 8:\n                    _o.trys.push([8, 16, 17, 18]);\n                    _f = (e_3 = void 0, __values(trackLists.entries())), _g = _f.next();\n                    _o.label = 9;\n                case 9:\n                    if (!!_g.done) return [3 /*break*/, 15];\n                    _h = __read(_g.value, 2), trackIndex = _h[0], track = _h[1];\n                    return [4 /*yield*/, mdIface.getTrackTitle(track)];\n                case 10:\n                    title_1 = _o.sent();\n                    return [4 /*yield*/, mdIface.getTrackEncoding(track)];\n                case 11:\n                    _j = __read.apply(void 0, [_o.sent(), 2]), codec = _j[0], channelCount = _j[1];\n                    _k = utils_1.timeToFrames;\n                    return [4 /*yield*/, mdIface.getTrackLength(track)];\n                case 12:\n                    duration = _k.apply(void 0, [_o.sent()]);\n                    return [4 /*yield*/, mdIface.getTrackFlags(track)];\n                case 13:\n                    flags_1 = _o.sent();\n                    t = {\n                        index: trackIndex,\n                        title: title_1,\n                        duration: duration,\n                        encoding: codec,\n                        protected: flags_1,\n                    };\n                    tracks.push(t);\n                    _o.label = 14;\n                case 14:\n                    _g = _f.next();\n                    return [3 /*break*/, 9];\n                case 15: return [3 /*break*/, 18];\n                case 16:\n                    e_3_1 = _o.sent();\n                    e_3 = { error: e_3_1 };\n                    return [3 /*break*/, 18];\n                case 17:\n                    try {\n                        if (_g && !_g.done && (_m = _f.return)) _m.call(_f);\n                    }\n                    finally { if (e_3) throw e_3.error; }\n                    return [7 /*endfinally*/];\n                case 18:\n                    g.tracks = g.tracks.concat(tracks);\n                    _o.label = 19;\n                case 19:\n                    _c = _b.next();\n                    return [3 /*break*/, 7];\n                case 20: return [3 /*break*/, 23];\n                case 21:\n                    e_4_1 = _o.sent();\n                    e_4 = { error: e_4_1 };\n                    return [3 /*break*/, 23];\n                case 22:\n                    try {\n                        if (_c && !_c.done && (_l = _b.return)) _l.call(_b);\n                    }\n                    finally { if (e_4) throw e_4.error; }\n                    return [7 /*endfinally*/];\n                case 23: return [2 /*return*/, disc];\n            }\n        });\n    });\n}\nexports.listContent = listContent;\nfunction download(mdIface, track, progressCallback) {\n    return __awaiter(this, void 0, void 0, function () {\n        var err_2, session, _a, trk, uuid, ccid;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 3, , 4]);\n                    return [4 /*yield*/, mdIface.sessionKeyForget()];\n                case 1:\n                    _b.sent();\n                    return [4 /*yield*/, mdIface.leaveSecureSession()];\n                case 2:\n                    _b.sent();\n                    return [3 /*break*/, 4];\n                case 3:\n                    err_2 = _b.sent();\n                    return [3 /*break*/, 4];\n                case 4: return [4 /*yield*/, mdIface.disableNewTrackProtection(1)];\n                case 5:\n                    _b.sent();\n                    session = new netmd_interface_1.MDSession(mdIface, new netmd_interface_1.EKBOpenSource());\n                    return [4 /*yield*/, session.init()];\n                case 6:\n                    _b.sent();\n                    return [4 /*yield*/, session.downloadTrack(track, progressCallback)];\n                case 7:\n                    _a = __read.apply(void 0, [_b.sent(), 3]), trk = _a[0], uuid = _a[1], ccid = _a[2];\n                    return [4 /*yield*/, session.close()];\n                case 8:\n                    _b.sent();\n                    return [2 /*return*/, [trk, uuid, ccid]];\n            }\n        });\n    });\n}\nexports.download = download;\n//# sourceMappingURL=netmd-commands.js.map","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"5530d0d82e3e17dcc5cb.worker.js\");\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"bf6bb478575a8c2fc6dc.worker.js\");\n};","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n        // [::1] is the IPv6 localhost address.\n        window.location.hostname === '[::1]' ||\n        // 127.0.0.0/8 are considered localhost for IPv4.\n        window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n    onSuccess?: (registration: ServiceWorkerRegistration) => void;\n    onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n    if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n        // The URL constructor is available in all browsers that support SW.\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n        if (publicUrl.origin !== window.location.origin) {\n            // Our service worker won't work if PUBLIC_URL is on a different origin\n            // from what our page is served on. This might happen if a CDN is used to\n            // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n            return;\n        }\n\n        window.addEventListener('load', () => {\n            const swUrl = `${process.env.PUBLIC_URL}/final-service-worker.js`;\n\n            if (isLocalhost) {\n                // This is running on localhost. Let's check if a service worker still exists or not.\n                checkValidServiceWorker(swUrl, config);\n\n                // Add some additional logging to localhost, pointing developers to the\n                // service worker/PWA documentation.\n                navigator.serviceWorker.ready.then(() => {\n                    console.log(\n                        'This web app is being served cache-first by a service ' + 'worker. To learn more, visit https://bit.ly/CRA-PWA'\n                    );\n                });\n            } else {\n                // Is not localhost. Just register service worker\n                registerValidSW(swUrl, config);\n            }\n        });\n    }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n    navigator.serviceWorker\n        .register(swUrl)\n        .then(registration => {\n            registration.onupdatefound = () => {\n                const installingWorker = registration.installing;\n                if (installingWorker == null) {\n                    return;\n                }\n                installingWorker.onstatechange = () => {\n                    console.log('state change', installingWorker.state);\n                    if (installingWorker.state === 'installed') {\n                        if (navigator.serviceWorker.controller) {\n                            // At this point, the updated precached content has been fetched,\n                            // but the previous service worker will still serve the older\n                            // content until all client tabs are closed.\n                            console.log(\n                                'New content is available and will be used when all ' +\n                                    'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n                            );\n\n                            // Execute callback\n                            if (config && config.onUpdate) {\n                                config.onUpdate(registration);\n                            }\n                        } else {\n                            // At this point, everything has been precached.\n                            // It's the perfect time to display a\n                            // \"Content is cached for offline use.\" message.\n                            console.log('Content is cached for offline use.');\n\n                            // Execute callback\n                            if (config && config.onSuccess) {\n                                config.onSuccess(registration);\n                            }\n                        }\n                    }\n                };\n            };\n            registration.update(); // Check for new version everytime we load the page\n        })\n        .catch(error => {\n            console.error('Error during service worker registration:', error);\n        });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n    // Check if the service worker can be found. If it can't reload the page.\n    fetch(swUrl, {\n        headers: { 'Service-Worker': 'script' },\n    })\n        .then(response => {\n            // Ensure service worker exists, and that we really are getting a JS file.\n            const contentType = response.headers.get('content-type');\n            if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n                // No service worker found. Probably a different app. Reload the page.\n                navigator.serviceWorker.ready.then(registration => {\n                    registration.unregister().then(() => {\n                        window.location.reload();\n                    });\n                });\n            } else {\n                // Service worker found. Proceed as normal.\n                registerValidSW(swUrl, config);\n            }\n        })\n        .catch(() => {\n            console.log('No internet connection found. App is running in offline mode.');\n        });\n}\n\nexport function unregister() {\n    if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.ready.then(registration => {\n            registration.unregister();\n        });\n    }\n}\n","import { openNewDevice, NetMDInterface, Disc, listContent, openPairedDevice, Wireformat, MDTrack, download } from 'netmd-js';\nimport { makeGetAsyncPacketIteratorOnWorkerThread } from 'netmd-js/dist/web-encrypt-worker';\n\nconst Worker = require('worker-loader!netmd-js/dist/web-encrypt-worker.js'); // eslint-disable-line import/no-webpack-loader-syntax\n\nexport interface NetMDService {\n    pair(): Promise<boolean>;\n    connect(): Promise<boolean>;\n    listContent(): Promise<Disc>;\n    getDeviceName(): Promise<string>;\n    finalize(): Promise<void>;\n    renameTrack(index: number, newTitle: string): Promise<void>;\n    renameDisc(newName: string): Promise<void>;\n    deleteTrack(index: number): Promise<void>;\n    moveTrack(src: number, dst: number): Promise<void>;\n    wipeDisc(): Promise<void>;\n    upload(\n        title: string,\n        data: ArrayBuffer,\n        format: Wireformat,\n        progressCallback: (progress: { written: number; encrypted: number; total: number }) => void\n    ): Promise<void>;\n\n    play(): Promise<void>;\n    stop(): Promise<void>;\n    next(): Promise<void>;\n    prev(): Promise<void>;\n}\n\nexport class NetMDUSBService implements NetMDService {\n    private netmdInterface?: NetMDInterface;\n\n    async pair() {\n        let iface = await openNewDevice(navigator.usb);\n        if (iface === null) {\n            return false;\n        }\n        this.netmdInterface = iface;\n        return true;\n    }\n\n    async connect() {\n        let iface = await openPairedDevice(navigator.usb);\n        if (iface === null) {\n            return false;\n        }\n        this.netmdInterface = iface;\n        return true;\n    }\n\n    async listContent() {\n        return await listContent(this.netmdInterface!);\n    }\n\n    async getDeviceName() {\n        return await this.netmdInterface!.netMd.getDeviceName();\n    }\n\n    async finalize() {\n        await this.netmdInterface!.netMd.finalize();\n    }\n\n    async renameTrack(index: number, newTitle: string) {\n        await this.netmdInterface!.setTrackTitle(index, newTitle);\n    }\n\n    async renameDisc(newName: string) {\n        const oldName = await this.netmdInterface!.getDiscTitle();\n        let newNameWithGroups = await this.netmdInterface!._getDiscTitle();\n        newNameWithGroups = newNameWithGroups.replace(oldName, newName);\n        await this.netmdInterface!.cacheTOC();\n        await this.netmdInterface!.setDiscTitle(newNameWithGroups);\n        await this.netmdInterface!.syncTOC();\n    }\n\n    async deleteTrack(index: number) {\n        await this.netmdInterface!.eraseTrack(index);\n    }\n\n    async wipeDisc() {\n        await this.netmdInterface!.eraseDisc();\n    }\n\n    async moveTrack(src: number, dst: number) {\n        await this.netmdInterface!.moveTrack(src, dst);\n    }\n\n    async upload(\n        title: string,\n        data: ArrayBuffer,\n        format: Wireformat,\n        progressCallback: (progress: { written: number; encrypted: number; total: number }) => void\n    ) {\n        let total = data.byteLength;\n        let written = 0;\n        let encrypted = 0;\n        function updateProgress() {\n            progressCallback({ written, encrypted, total });\n        }\n\n        let w = new Worker();\n\n        let webWorkerAsyncPacketIterator = makeGetAsyncPacketIteratorOnWorkerThread(w, ({ encryptedBytes }) => {\n            encrypted = encryptedBytes;\n            updateProgress();\n        });\n\n        let mdTrack = new MDTrack(title, format, data, 0x80000, webWorkerAsyncPacketIterator);\n\n        await download(this.netmdInterface!, mdTrack, ({ writtenBytes }) => {\n            written = writtenBytes;\n            updateProgress();\n        });\n\n        w.terminate();\n    }\n\n    async play() {\n        await this.netmdInterface!.play();\n    }\n    async stop() {\n        await this.netmdInterface!.stop();\n    }\n    async next() {\n        await this.netmdInterface!.nextTrack();\n    }\n    async prev() {\n        await this.netmdInterface!.previousTrack();\n    }\n}\n","import { NetMDService } from './netmd';\nimport { AudioExportService } from './audio-export';\n\ninterface ServiceRegistry {\n    netmdService?: NetMDService;\n    audioExportService?: AudioExportService;\n}\n\nconst ServiceRegistry: ServiceRegistry = {};\n\nexport default ServiceRegistry;\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { enableBatching } from 'redux-batched-actions';\n\nexport interface LoadingDialogState {\n    visible: boolean;\n    writtenProgress: number;\n    encryptedProgress: number;\n    totalProgress: number;\n\n    trackTotal: number;\n    trackConverting: number;\n    trackCurrent: number;\n\n    titleCurrent: string;\n    titleConverting: string;\n}\n\nconst initialState: LoadingDialogState = {\n    visible: false,\n    // Current Track Upload\n    writtenProgress: 0,\n    encryptedProgress: 0,\n    totalProgress: 1,\n\n    // Tracks done\n    trackTotal: 1,\n    trackConverting: 0,\n    trackCurrent: 0,\n    titleCurrent: '',\n    titleConverting: '',\n};\n\nexport const slice = createSlice({\n    name: 'uploadDialog',\n    initialState,\n    reducers: {\n        setVisible: (state, action: PayloadAction<boolean>) => {\n            state.visible = action.payload;\n        },\n        setWriteProgress: (state, action: PayloadAction<{ written: number; encrypted: number; total: number }>) => {\n            state.encryptedProgress = action.payload.encrypted;\n            state.writtenProgress = action.payload.written;\n            state.totalProgress = action.payload.total;\n        },\n        setTrackProgress: (\n            state,\n            action: PayloadAction<{ total: number; current: number; converting: number; titleCurrent: string; titleConverting: string }>\n        ) => {\n            state.trackTotal = action.payload.total;\n            state.trackCurrent = action.payload.current;\n            state.trackConverting = action.payload.converting;\n            state.titleCurrent = action.payload.titleCurrent;\n            state.titleConverting = action.payload.titleConverting;\n        },\n    },\n});\n\nexport const { reducer, actions } = slice;\nexport default enableBatching(reducer);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { enableBatching } from 'redux-batched-actions';\n\nexport interface RenameDialogState {\n    visible: boolean;\n    title: string;\n    index: number;\n}\n\nconst initialState: RenameDialogState = {\n    visible: false,\n    title: '',\n    index: -1,\n};\n\nexport const slice = createSlice({\n    name: 'renameDialog',\n    initialState,\n    reducers: {\n        setVisible: (state: RenameDialogState, action: PayloadAction<boolean>) => {\n            state.visible = action.payload;\n        },\n        setCurrentName: (state: RenameDialogState, action: PayloadAction<string>) => {\n            state.title = action.payload;\n        },\n        setIndex: (state: RenameDialogState, action: PayloadAction<number>) => {\n            state.index = action.payload;\n        },\n    },\n});\n\nexport const { reducer, actions } = slice;\nexport default enableBatching(reducer);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { enableBatching } from 'redux-batched-actions';\n\nexport interface ErrorDialogState {\n    visible: boolean;\n    error: string;\n}\n\nconst initialState: ErrorDialogState = {\n    visible: false,\n    error: ``,\n};\n\nconst slice = createSlice({\n    name: 'errorDialog',\n    initialState,\n    reducers: {\n        setVisible: (state, action: PayloadAction<boolean>) => {\n            state.visible = action.payload;\n        },\n        setErrorMessage: (state, action: PayloadAction<string>) => {\n            state.error = `${action.payload}`;\n        },\n    },\n});\n\nexport const { actions, reducer } = slice;\nexport default enableBatching(reducer);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { enableBatching } from 'redux-batched-actions';\n\nexport interface ConvertDialogFeature {\n    visible: boolean;\n    format: string;\n}\n\nconst initialState: ConvertDialogFeature = {\n    visible: false,\n    format: `LP2`,\n};\n\nconst slice = createSlice({\n    name: 'convertDialog',\n    initialState,\n    reducers: {\n        setVisible: (state, action: PayloadAction<boolean>) => {\n            state.visible = action.payload;\n        },\n        setFormat: (state, action: PayloadAction<string>) => {\n            state.format = action.payload;\n        },\n    },\n});\n\nexport const { actions, reducer } = slice;\nexport default enableBatching(reducer);\n","import { useSelector, shallowEqual } from 'react-redux';\nimport { RootState } from './redux/store';\n\nexport function sleep(ms: number) {\n    return new Promise(resolve => {\n        setTimeout(resolve, ms);\n    });\n}\n\nexport function useShallowEqualSelector<TState = RootState, TSelected = unknown>(selector: (state: TState) => TSelected): TSelected {\n    return useSelector(selector, shallowEqual);\n}\n\nexport function hasWebUSB(): boolean {\n    return !!navigator.usb;\n}\n\nexport function getWebUSB(): USB {\n    return navigator.usb;\n}\n\nexport function debugEnabled() {\n    return process.env.NODE_ENV === 'development';\n}\n\nexport function getPublicPathFor(script: string) {\n    return `${process.env.PUBLIC_URL}/${script}`;\n}\n\nexport function savePreference(key: string, value: unknown) {\n    localStorage.setItem(key, JSON.stringify(value));\n}\n\nexport function loadPreference<T>(key: string, defaultValue: T): T {\n    let res = localStorage.getItem(key);\n    if (res === null) {\n        return defaultValue;\n    } else {\n        try {\n            return JSON.parse(res) as T;\n        } catch (e) {\n            return defaultValue;\n        }\n    }\n}\n\ndeclare let process: any;\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { enableBatching } from 'redux-batched-actions';\nimport { savePreference, loadPreference } from '../utils';\n\ntype Views = 'WELCOME' | 'MAIN';\n\nexport interface AppState {\n    mainView: Views;\n    loading: boolean;\n    pairingFailed: boolean;\n    pairingMessage: string;\n    browserSupported: boolean;\n    darkMode: boolean;\n    aboutDialogVisible: boolean;\n}\n\nconst initialState: AppState = {\n    mainView: 'WELCOME',\n    loading: false,\n    pairingFailed: false,\n    pairingMessage: ``,\n    browserSupported: true,\n    darkMode: loadPreference('darkMode', false),\n    aboutDialogVisible: false,\n};\n\nexport const slice = createSlice({\n    name: 'app',\n    initialState,\n    reducers: {\n        setState: (state, action: PayloadAction<Views>) => {\n            state.mainView = action.payload;\n        },\n        setLoading: (state, action: PayloadAction<boolean>) => {\n            state.loading = action.payload;\n        },\n        setPairingFailed: (state, action: PayloadAction<boolean>) => {\n            state.pairingFailed = action.payload;\n        },\n        setPairingMessage: (state, action: PayloadAction<string>) => {\n            state.pairingMessage = action.payload;\n        },\n        setBrowserSupported: (state, action: PayloadAction<boolean>) => {\n            state.browserSupported = action.payload;\n        },\n        setDarkMode: (state, action: PayloadAction<boolean>) => {\n            state.darkMode = action.payload;\n            savePreference('darkMode', state.darkMode);\n        },\n        showAboutDialog: (state, action: PayloadAction<boolean>) => {\n            state.aboutDialogVisible = action.payload;\n        },\n    },\n});\n\nexport const { reducer, actions } = slice;\nexport default enableBatching(reducer);\n","import { Disc } from 'netmd-js';\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { enableBatching } from 'redux-batched-actions';\n\nexport interface MainState {\n    disc: Disc | null;\n    deviceName: string;\n}\n\nconst initialState: MainState = {\n    disc: null,\n    deviceName: '',\n};\n\nexport const slice = createSlice({\n    name: 'main',\n    initialState,\n    reducers: {\n        setDisc: (state, action: PayloadAction<Disc>) => {\n            state.disc = action.payload;\n        },\n        setDeviceName: (state, action: PayloadAction<string>) => {\n            state.deviceName = action.payload;\n        },\n    },\n});\n\nexport const { reducer, actions } = slice;\nexport default enableBatching(reducer);\n","import { configureStore, getDefaultMiddleware } from '@reduxjs/toolkit';\nimport uploadDialog from './upload-dialog-feature';\nimport renameDialog from './rename-dialog-feature';\nimport errorDialog from './error-dialog-feature';\nimport convertDialog from './convert-dialog-feature';\nimport appState from './app-feature';\nimport main from './main-feature';\n\nexport const store = configureStore({\n    reducer: {\n        renameDialog,\n        uploadDialog,\n        errorDialog,\n        convertDialog,\n        appState,\n        main,\n    },\n    middleware: [...getDefaultMiddleware()],\n});\n\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppDispatch = typeof store.dispatch;\n","import { batchActions } from 'redux-batched-actions';\nimport { AppDispatch, RootState } from './store';\nimport { actions as uploadDialogActions } from './upload-dialog-feature';\nimport { actions as renameDialogActions } from './rename-dialog-feature';\nimport { actions as errorDialogAction } from './error-dialog-feature';\nimport { actions as appStateActions } from './app-feature';\nimport { actions as mainActions } from './main-feature';\nimport serviceRegistry from '../services/registry';\nimport { Wireformat } from 'netmd-js';\nimport { AnyAction } from '@reduxjs/toolkit';\n\nexport function pair() {\n    return async function(dispatch: AppDispatch, getState: () => RootState) {\n        dispatch(appStateActions.setPairingFailed(false));\n\n        await serviceRegistry.audioExportService!.init();\n\n        try {\n            let connected = await serviceRegistry.netmdService!.connect();\n            if (connected) {\n                dispatch(appStateActions.setState('MAIN'));\n                return;\n            }\n        } catch (err) {\n            console.error(err);\n            // In case of error, just log and try to pair\n        }\n\n        try {\n            let paired = await serviceRegistry.netmdService!.pair();\n            if (paired) {\n                dispatch(appStateActions.setState('MAIN'));\n                return;\n            }\n            dispatch(batchActions([appStateActions.setPairingMessage(`Connection Failed`), appStateActions.setPairingFailed(true)]));\n        } catch (err) {\n            console.error(err);\n            let message = (err as Error).message;\n            dispatch(batchActions([appStateActions.setPairingMessage(message), appStateActions.setPairingFailed(true)]));\n        }\n    };\n}\n\nexport function listContent() {\n    return async function(dispatch: AppDispatch) {\n        // Issue loading\n        dispatch(appStateActions.setLoading(true));\n        let disc = await serviceRegistry.netmdService!.listContent();\n        let deviceName = await serviceRegistry.netmdService!.getDeviceName();\n        dispatch(batchActions([mainActions.setDisc(disc), mainActions.setDeviceName(deviceName), appStateActions.setLoading(false)]));\n    };\n}\n\nexport function renameTrack({ index, newName }: { index: number; newName: string }) {\n    return async function(dispatch: AppDispatch) {\n        const { netmdService } = serviceRegistry;\n        await netmdService!.renameTrack(index, newName);\n        dispatch(renameDialogActions.setVisible(false));\n        listContent()(dispatch);\n    };\n}\n\nexport function renameDisc({ newName }: { newName: string }) {\n    return async function(dispatch: AppDispatch) {\n        const { netmdService } = serviceRegistry;\n        await netmdService!.renameDisc(newName);\n        dispatch(renameDialogActions.setVisible(false));\n        listContent()(dispatch);\n    };\n}\n\nexport function deleteTracks(indexes: number[]) {\n    return async function(dispatch: AppDispatch) {\n        const { netmdService } = serviceRegistry;\n        dispatch(appStateActions.setLoading(true));\n        indexes = indexes.sort();\n        indexes.reverse();\n        for (let index of indexes) {\n            await netmdService!.deleteTrack(index);\n        }\n        listContent()(dispatch);\n    };\n}\n\nexport function wipeDisc() {\n    return async function(dispatch: AppDispatch) {\n        const { netmdService } = serviceRegistry;\n        dispatch(appStateActions.setLoading(true));\n        await netmdService!.wipeDisc();\n        listContent()(dispatch);\n    };\n}\n\nexport function moveTrack(srcIndex: number, destIndex: number) {\n    return async function(dispatch: AppDispatch) {\n        const { netmdService } = serviceRegistry;\n        await netmdService!.moveTrack(srcIndex, destIndex);\n        listContent()(dispatch);\n    };\n}\n\nexport const WireformatDict: { [k: string]: Wireformat } = {\n    SP: Wireformat.pcm,\n    LP2: Wireformat.lp2,\n    LP105: Wireformat.l105kbps,\n    LP4: Wireformat.lp4,\n};\n\nexport function convertAndUpload(files: File[], format: string) {\n    return async function(dispatch: AppDispatch, getState: (state: RootState) => void) {\n        const { audioExportService, netmdService } = serviceRegistry;\n        const wireformat = WireformatDict[format];\n\n        dispatch(uploadDialogActions.setVisible(true));\n\n        const updateProgressCallback = ({ written, encrypted, total }: { written: number; encrypted: number; total: number }) => {\n            dispatch(uploadDialogActions.setWriteProgress({ written, encrypted, total }));\n        };\n\n        let trackUpdate: {\n            current: number;\n            converting: number;\n            total: number;\n            titleCurrent: string;\n            titleConverting: string;\n        } = {\n            current: 0,\n            converting: 0,\n            total: files.length,\n            titleCurrent: '',\n            titleConverting: '',\n        };\n        const updateTrack = () => {\n            dispatch(uploadDialogActions.setTrackProgress(trackUpdate));\n        };\n\n        let conversionIterator = async function*(files: File[]) {\n            let converted: Promise<{ file: File; data: ArrayBuffer }>[] = [];\n\n            let i = 0;\n            function convertNext() {\n                if (i === files.length) {\n                    trackUpdate.converting = i;\n                    trackUpdate.titleConverting = ``;\n                    updateTrack();\n                    return;\n                }\n\n                let f = files[i];\n                trackUpdate.converting = i;\n                trackUpdate.titleConverting = f.name;\n                updateTrack();\n                i++;\n\n                converted.push(\n                    new Promise(async (resolve, reject) => {\n                        let data: ArrayBuffer;\n                        try {\n                            await audioExportService!.prepare(f);\n                            data = await audioExportService!.export({ format });\n                            convertNext();\n                            resolve({ file: f, data: data });\n                        } catch (err) {\n                            error = err;\n                            errorMessage = `${f.name}: Unsupported or unrecognized format`;\n                            reject(err);\n                        }\n                    })\n                );\n            }\n            convertNext();\n\n            let j = 0;\n            while (j < converted.length) {\n                yield await converted[j];\n                delete converted[j];\n                j++;\n            }\n        };\n\n        let error: any;\n        let errorMessage = ``;\n        let i = 1;\n        for await (let item of conversionIterator(files)) {\n            const { file, data } = item;\n\n            let title = file.name;\n            const extStartIndex = title.lastIndexOf('.');\n            if (extStartIndex > 0) {\n                title = title.substring(0, extStartIndex);\n            }\n\n            trackUpdate.current = i++;\n            trackUpdate.titleCurrent = title;\n            updateTrack();\n            updateProgressCallback({ written: 0, encrypted: 0, total: 100 });\n            try {\n                await netmdService?.upload(title, data, wireformat, updateProgressCallback);\n            } catch (err) {\n                error = err;\n                errorMessage = `${file.name}: Error uploading to device`;\n                break;\n            }\n        }\n\n        let actionToDispatch: AnyAction[] = [uploadDialogActions.setVisible(false)];\n\n        if (error) {\n            console.error(error);\n            actionToDispatch = actionToDispatch.concat([\n                errorDialogAction.setVisible(true),\n                errorDialogAction.setErrorMessage(errorMessage),\n            ]);\n        }\n\n        dispatch(batchActions(actionToDispatch));\n        listContent()(dispatch);\n    };\n}\n","/* eslint no-restricted-globals: 0 */\nimport { getPublicPathFor } from '../utils';\nexport class AtracdencProcess {\n    private messageCallback?: (ev: MessageEvent) => void;\n\n    constructor(public worker: Worker) {\n        worker.onmessage = this.handleMessage.bind(this);\n    }\n\n    async init() {\n        await new Promise<MessageEvent>(resolve => {\n            this.messageCallback = resolve;\n            this.worker.postMessage({ action: 'init' });\n        });\n    }\n\n    async encode(data: ArrayBuffer, bitrate: string) {\n        let eventData = await new Promise<MessageEvent>(resolve => {\n            this.messageCallback = resolve;\n            this.worker.postMessage({ action: 'encode', bitrate, data }, [data]);\n        });\n        return eventData.data.result as Uint8Array;\n    }\n\n    terminate() {\n        this.worker.terminate();\n    }\n\n    handleMessage(ev: MessageEvent) {\n        this.messageCallback!(ev);\n        this.messageCallback = undefined;\n    }\n}\n\nif (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope) {\n    // Worker\n    let Module: any;\n    onmessage = async (ev: MessageEvent) => {\n        const { action, ...others } = ev.data;\n        if (action === 'init') {\n            self.importScripts(getPublicPathFor(`atracdenc.js`));\n            (self as any).Module().then((m: any) => {\n                Module = m;\n                self.postMessage({ action: 'init' });\n                Module.setLogger && Module.setLogger((msg: string, stream: string) => console.log(`${stream}: ${msg}`));\n            });\n        } else if (action === 'encode') {\n            const { bitrate, data } = others;\n            const inWavFile = `inWavFile.wav`;\n            const outAt3File = `outAt3File.aea`;\n            const dataArray = new Uint8Array(data);\n            Module.FS.writeFile(`${inWavFile}`, dataArray);\n            Module.callMain([`-e`, `atrac3`, `-i`, inWavFile, `-o`, outAt3File, `--bitrate`, bitrate]);\n\n            // Read file and trim header (96 bytes)\n            let fileStat = Module.FS.stat(outAt3File);\n            let size = fileStat.size;\n            let tmp = new Uint8Array(size - 96);\n            let outAt3FileStream = Module.FS.open(outAt3File, 'r');\n            Module.FS.read(outAt3FileStream, tmp, 0, tmp.length, 96);\n            Module.FS.close(outAt3FileStream);\n\n            let result = tmp.buffer;\n\n            self.postMessage(\n                {\n                    action: 'encode',\n                    result,\n                },\n                [result]\n            );\n        }\n    };\n} else {\n    // Main\n}\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useShallowEqualSelector } from '../utils';\n\nimport { actions as appActions } from '../redux/app-feature';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport Button from '@material-ui/core/Button';\nimport Link from '@material-ui/core/Link';\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n    return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nexport const AboutDialog = (props: {}) => {\n    const dispatch = useDispatch();\n\n    let visible = useShallowEqualSelector(state => state.appState.aboutDialogVisible);\n\n    const handleClose = () => {\n        dispatch(appActions.showAboutDialog(false));\n    };\n\n    return (\n        <Dialog\n            open={visible}\n            maxWidth={'sm'}\n            fullWidth={true}\n            TransitionComponent={Transition as any}\n            aria-labelledby=\"about-dialog-slide-title\"\n        >\n            <DialogTitle id=\"about-dialog-slide-title\">About Web MiniDisc</DialogTitle>\n            <DialogContent>\n                <DialogContentText>Web MiniDisc has been made possible by</DialogContentText>\n                <ul>\n                    <li>\n                        <Link rel=\"noopener noreferrer\" href=\"https://www.ffmpeg.org/\" target=\"_blank\">\n                            FFmpeg\n                        </Link>{' '}\n                        and{' '}\n                        <Link rel=\"noopener noreferrer\" href=\"https://github.com/ffmpegjs/FFmpeg\" target=\"_blank\">\n                            ffmpegjs\n                        </Link>\n                        , to read your audio files (wav, mp3, ogg, mp4, etc...).\n                    </li>\n                    <li>\n                        <Link rel=\"noopener noreferrer\" href=\"https://github.com/dcherednik/atracdenc/\" target=\"_blank\">\n                            Atracdenc\n                        </Link>\n                        , to support atrac3 encoding (lp2, lp4 audio formats).\n                    </li>\n                    <li>\n                        <Link rel=\"noopener noreferrer\" href=\"https://emscripten.org/\" target=\"_blank\">\n                            Emscripten\n                        </Link>\n                        , to run both FFmpeg and Atracdenc in the browser.\n                    </li>\n                    <li>\n                        <Link rel=\"noopener noreferrer\" href=\"https://github.com/cybercase/netmd-js\" target=\"_blank\">\n                            netmd-js\n                        </Link>\n                        , to send commands to NetMD devices using Javascript.\n                    </li>\n                    <li>\n                        <Link rel=\"noopener noreferrer\" href=\"https://github.com/glaubitz/linux-minidisc\" target=\"_blank\">\n                            linux-minidisc\n                        </Link>\n                        , to make the netmd-js project possible.\n                    </li>\n                    <li>\n                        <Link rel=\"noopener noreferrer\" href=\"https://material-ui.com/\" target=\"_blank\">\n                            material-ui\n                        </Link>\n                        , to build the user interface.\n                    </li>\n                </ul>\n                <DialogContentText>Attribution</DialogContentText>\n                <ul>\n                    <li>\n                        MiniDisc logo from{' '}\n                        <Link rel=\"noopener noreferrer\" href=\"https://en.wikipedia.org/wiki/MiniDisc\" target=\"_blank\">\n                            https://en.wikipedia.org/wiki/MiniDisc\n                        </Link>\n                    </li>\n                    <li>\n                        MiniDisc icon from{' '}\n                        <Link\n                            rel=\"noopener noreferrer\"\n                            href=\"https://www.deviantart.com/blinkybill/art/Sony-MiniDisc-Plastic-Icon-473812540\"\n                            target=\"_blank\"\n                        >\n                            http://fav.me/d7u3g3g\n                        </Link>\n                    </li>\n                </ul>\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={handleClose}>Close</Button>\n            </DialogActions>\n        </Dialog>\n    );\n};\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { batchActions } from 'redux-batched-actions';\n\nimport IconButton from '@material-ui/core/IconButton';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\n\nimport { wipeDisc, listContent } from '../redux/actions';\nimport { actions as appActions } from '../redux/app-feature';\nimport { actions as renameDialogActions } from '../redux/rename-dialog-feature';\nimport { useShallowEqualSelector } from '../utils';\nimport Link from '@material-ui/core/Link';\n\nexport const TopMenu = function() {\n    const dispatch = useDispatch();\n\n    let { mainView } = useShallowEqualSelector(state => state.appState);\n    let disc = useShallowEqualSelector(state => state.main.disc);\n\n    const [menuAnchorEl, setMenuAnchorEl] = React.useState<null | HTMLElement>(null);\n    const menuOpen = Boolean(menuAnchorEl);\n    const handleMenuClick = (event: React.MouseEvent<HTMLElement>) => {\n        setMenuAnchorEl(event.currentTarget);\n    };\n\n    const handleMenuClose = () => {\n        setMenuAnchorEl(null);\n    };\n\n    const handleWipeDisc = () => {\n        dispatch(wipeDisc());\n        handleMenuClose();\n    };\n\n    const handleRefresh = () => {\n        dispatch(listContent());\n        handleMenuClose();\n    };\n\n    const handleRenameDisc = () => {\n        dispatch(\n            batchActions([\n                renameDialogActions.setVisible(true),\n                renameDialogActions.setCurrentName(disc?.title ?? ``),\n                renameDialogActions.setIndex(-1),\n            ])\n        );\n        handleMenuClose();\n    };\n\n    const handleExit = () => {\n        dispatch(appActions.setState('WELCOME'));\n        handleMenuClose();\n    };\n    const handleShowAbout = () => {\n        dispatch(appActions.showAboutDialog(true));\n        handleMenuClose();\n    };\n\n    const menuItems = [];\n    if (mainView === 'MAIN') {\n        menuItems.push(\n            <MenuItem key=\"update\" onClick={handleRefresh}>\n                Refresh\n            </MenuItem>\n        );\n        menuItems.push(\n            <MenuItem key=\"title\" onClick={handleRenameDisc}>\n                Rename Disc\n            </MenuItem>\n        );\n        menuItems.push(\n            <MenuItem key=\"wipe\" onClick={handleWipeDisc}>\n                Wipe Disc\n            </MenuItem>\n        );\n        menuItems.push(\n            <MenuItem key=\"exit\" onClick={handleExit}>\n                Exit\n            </MenuItem>\n        );\n    }\n    menuItems.push(\n        <MenuItem key=\"about\" onClick={handleShowAbout}>\n            About\n        </MenuItem>\n    );\n    menuItems.push(\n        <MenuItem key=\"github\" onClick={handleMenuClose}>\n            <Link rel=\"noopener noreferrer\" href=\"https://github.com/cybercase/webminidisc\" target=\"_blank\">\n                Fork me on GitHub\n            </Link>\n        </MenuItem>\n    );\n\n    return (\n        <React.Fragment>\n            <IconButton aria-label=\"actions\" aria-controls=\"actions-menu\" aria-haspopup=\"true\" onClick={handleMenuClick}>\n                <MoreVertIcon />\n            </IconButton>\n            <Menu id=\"actions-menu\" anchorEl={menuAnchorEl} keepMounted open={menuOpen} onClose={handleMenuClose}>\n                {menuItems}\n            </Menu>\n        </React.Fragment>\n    );\n};\n","import React, { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { pair } from '../redux/actions';\n\nimport { useShallowEqualSelector } from '../utils';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport Box from '@material-ui/core/Box';\nimport Link from '@material-ui/core/Link';\n\nimport { AboutDialog } from './about-dialog';\nimport { TopMenu } from './topmenu';\nimport ChromeIconPath from '../images/chrome-icon.svg';\n\nconst useStyles = makeStyles(theme => ({\n    main: {\n        position: 'relative',\n        flex: '1 1 auto',\n        display: 'flex',\n        justifyContent: 'center',\n        flexDirection: 'column',\n        alignItems: 'center',\n    },\n    button: {\n        marginTop: theme.spacing(3),\n        minWidth: 150,\n    },\n    spacing: {\n        marginTop: theme.spacing(1),\n    },\n    chromeLogo: {\n        marginTop: theme.spacing(1),\n        width: 96,\n        height: 96,\n    },\n    why: {\n        alignSelf: 'flex-start',\n        marginTop: theme.spacing(3),\n    },\n    headBox: {\n        display: 'flex',\n        justifyContent: 'space-between',\n    },\n}));\n\nexport const Welcome = (props: {}) => {\n    const classes = useStyles();\n\n    const dispatch = useDispatch();\n    const { browserSupported, pairingFailed, pairingMessage } = useShallowEqualSelector(state => state.appState);\n    if (pairingMessage.toLowerCase().match(/denied/)) {\n        // show linux instructions\n    }\n    // Access denied.\n\n    const [showWhyUnsupported, setWhyUnsupported] = useState(false);\n    const handleLearnWhy = (event: React.SyntheticEvent) => {\n        event.preventDefault();\n        setWhyUnsupported(true);\n    };\n\n    return (\n        <React.Fragment>\n            <Box className={classes.headBox}>\n                <Typography component=\"h1\" variant=\"h4\">\n                    Web MiniDisc\n                </Typography>\n                <TopMenu />\n            </Box>\n            <Typography component=\"h2\" variant=\"body2\">\n                Brings NetMD Devices to the Web\n            </Typography>\n            <Box className={classes.main}>\n                {browserSupported ? (\n                    <React.Fragment>\n                        <Typography component=\"h2\" variant=\"subtitle1\" align=\"center\" className={classes.spacing}>\n                            Press the button to connect to a NetMD device\n                        </Typography>\n\n                        <Button variant=\"contained\" color=\"primary\" onClick={() => dispatch(pair())} className={classes.button}>\n                            Connect\n                        </Button>\n\n                        <FormControl error={true} className={classes.spacing} style={{ visibility: pairingFailed ? 'visible' : 'hidden' }}>\n                            <FormHelperText>{pairingMessage}</FormHelperText>\n                        </FormControl>\n                    </React.Fragment>\n                ) : (\n                    <React.Fragment>\n                        <Typography component=\"h2\" variant=\"subtitle1\" align=\"center\" className={classes.spacing}>\n                            This Web browser is not supported.&nbsp;\n                            <Link rel=\"noopener noreferrer\" href=\"#\" onClick={handleLearnWhy}>\n                                Learn Why\n                            </Link>\n                        </Typography>\n\n                        <Link rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://www.google.com/chrome/\">\n                            <img alt=\"Chrome Logo\" src={ChromeIconPath} className={classes.chromeLogo} />\n                        </Link>\n\n                        <Typography component=\"h2\" variant=\"subtitle1\" align=\"center\" className={classes.spacing}>\n                            Try using{' '}\n                            <Link rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://www.google.com/chrome/\">\n                                Chrome\n                            </Link>{' '}\n                            instead\n                        </Typography>\n\n                        {showWhyUnsupported ? (\n                            <>\n                                <Typography component=\"p\" variant=\"body2\" className={classes.why}>\n                                    Web MiniDisc requires a browser that supports both{' '}\n                                    <Link rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://wicg.github.io/webusb/\">\n                                        WebUSB\n                                    </Link>{' '}\n                                    and{' '}\n                                    <Link rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://webassembly.org/\">\n                                        WebAssembly\n                                    </Link>\n                                    .\n                                </Typography>\n                                <ul>\n                                    <li>WebUSB is needed to control the NetMD device via the USB connection to your computer.</li>\n                                    <li>WebAssembly is used to convert the music to a MiniDisc compatible format</li>\n                                </ul>\n                            </>\n                        ) : null}\n                    </React.Fragment>\n                )}\n            </Box>\n            <AboutDialog />\n        </React.Fragment>\n    );\n};\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useShallowEqualSelector } from '../utils';\nimport { actions as renameDialogActions } from '../redux/rename-dialog-feature';\nimport { renameTrack, renameDisc } from '../redux/actions';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport TextField from '@material-ui/core/TextField';\nimport Slide from '@material-ui/core/Slide';\nimport Button from '@material-ui/core/Button';\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n    return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nexport const RenameDialog = (props: {}) => {\n    let dispatch = useDispatch();\n\n    let renameDialogVisible = useShallowEqualSelector(state => state.renameDialog.visible);\n    let renameDialogTitle = useShallowEqualSelector(state => state.renameDialog.title);\n    let renameDialogIndex = useShallowEqualSelector(state => state.renameDialog.index);\n\n    const what = renameDialogIndex < 0 ? `Disc` : `Track`;\n\n    const handleCancelRename = () => {\n        dispatch(renameDialogActions.setVisible(false));\n    };\n\n    const handleDoRename = () => {\n        if (renameDialogIndex < 0) {\n            dispatch(renameDisc({ newName: renameDialogTitle }));\n        } else {\n            dispatch(renameTrack({ index: renameDialogIndex, newName: renameDialogTitle }));\n        }\n    };\n\n    return (\n        <Dialog\n            open={renameDialogVisible}\n            onClose={handleCancelRename}\n            maxWidth={'sm'}\n            fullWidth={true}\n            TransitionComponent={Transition as any}\n            aria-labelledby=\"rename-dialog-title\"\n        >\n            <DialogTitle id=\"rename-dialog-title\">Rename {what}</DialogTitle>\n            <DialogContent>\n                <TextField\n                    autoFocus\n                    id=\"name\"\n                    label={`${what} Name`}\n                    type=\"text\"\n                    fullWidth\n                    value={renameDialogTitle}\n                    onKeyDown={event => {\n                        event.key === `Enter` && handleDoRename();\n                    }}\n                    onChange={event => {\n                        dispatch(renameDialogActions.setCurrentName(event.target.value));\n                    }}\n                />\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={handleCancelRename}>Cancel</Button>\n                <Button color={'primary'} onClick={handleDoRename}>\n                    Rename\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n};\n","import React from 'react';\nimport { useShallowEqualSelector } from '../utils';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport Box from '@material-ui/core/Box';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(theme => ({\n    progressPerc: {\n        marginTop: theme.spacing(1),\n    },\n    progressBar: {\n        marginTop: theme.spacing(3),\n    },\n    uploadLabel: {\n        marginTop: theme.spacing(3),\n    },\n}));\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n    return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nexport const UploadDialog = (props: {}) => {\n    const classes = useStyles();\n\n    let {\n        visible,\n        writtenProgress,\n        encryptedProgress,\n        totalProgress,\n\n        trackTotal,\n        trackCurrent,\n        trackConverting,\n        titleCurrent,\n        titleConverting,\n    } = useShallowEqualSelector(state => state.uploadDialog);\n\n    let progressValue = Math.floor((writtenProgress / totalProgress) * 100);\n    let bufferValue = Math.floor((encryptedProgress / totalProgress) * 100);\n    let convertedValue = Math.floor((trackConverting / trackTotal) * 100);\n    return (\n        <Dialog\n            open={visible}\n            maxWidth={'sm'}\n            fullWidth={true}\n            TransitionComponent={Transition as any}\n            aria-labelledby=\"alert-dialog-slide-title\"\n            aria-describedby=\"alert-dialog-slide-description\"\n        >\n            <DialogTitle id=\"alert-dialog-slide-title\">Recording...</DialogTitle>\n            <DialogContent>\n                <DialogContentText id=\"alert-dialog-slide-description\">\n                    {convertedValue === 100 && trackConverting === trackTotal\n                        ? `Conversion completed`\n                        : `Converting ${trackConverting + 1} of ${trackTotal}: ${titleConverting}`}\n                </DialogContentText>\n                <LinearProgress\n                    className={classes.progressBar}\n                    variant={convertedValue === 0 ? 'indeterminate' : 'determinate'}\n                    color=\"primary\"\n                    value={convertedValue}\n                />\n                <Box className={classes.progressPerc}>{convertedValue}%</Box>\n\n                <DialogContentText id=\"alert-dialog-slide-description\" className={classes.uploadLabel}>\n                    Uploading {trackCurrent} of {trackTotal}: {titleCurrent}\n                </DialogContentText>\n                <LinearProgress\n                    className={classes.progressBar}\n                    variant=\"buffer\"\n                    color=\"secondary\"\n                    value={progressValue}\n                    valueBuffer={bufferValue}\n                />\n                <Box className={classes.progressPerc}>{progressValue}%</Box>\n            </DialogContent>\n            <DialogActions></DialogActions>\n        </Dialog>\n    );\n};\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useShallowEqualSelector } from '../utils';\n\nimport { actions as errorDialogActions } from '../redux/error-dialog-feature';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport Button from '@material-ui/core/Button';\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n    return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nexport const ErrorDialog = (props: {}) => {\n    const dispatch = useDispatch();\n\n    let { visible, error } = useShallowEqualSelector(state => state.errorDialog);\n\n    const handleClose = () => {\n        dispatch(errorDialogActions.setVisible(false));\n    };\n\n    return (\n        <Dialog\n            open={visible}\n            maxWidth={'sm'}\n            fullWidth={true}\n            TransitionComponent={Transition as any}\n            aria-labelledby=\"error-dialog-slide-title\"\n            aria-describedby=\"error-dialog-slide-description\"\n        >\n            <DialogTitle id=\"alert-dialog-slide-title\">Error</DialogTitle>\n            <DialogContent>\n                <DialogContentText id=\"alert-dialog-slide-description\">{error}</DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={handleClose}>Close</Button>\n            </DialogActions>\n        </Dialog>\n    );\n};\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useShallowEqualSelector } from '../utils';\n\nimport { actions as convertDialogActions } from '../redux/convert-dialog-feature';\nimport { convertAndUpload } from '../redux/actions';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport Button from '@material-ui/core/Button';\nimport { makeStyles } from '@material-ui/core/styles';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport Input from '@material-ui/core/Input';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n    return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nconst useStyles = makeStyles(theme => ({\n    container: {\n        display: 'flex',\n        flexDirection: 'row',\n    },\n    formControl: {\n        minWidth: 120,\n    },\n}));\n\nexport const ConvertDialog = (props: { files: File[] }) => {\n    const dispatch = useDispatch();\n    const classes = useStyles();\n\n    let { visible, format } = useShallowEqualSelector(state => state.convertDialog);\n\n    const handleClose = () => {\n        dispatch(convertDialogActions.setVisible(false));\n    };\n\n    const handleChange = (ev: React.ChangeEvent<{ value: unknown }>) => {\n        dispatch(convertDialogActions.setFormat(ev.target.value as string));\n    };\n\n    const handleConvert = () => {\n        handleClose();\n        dispatch(convertAndUpload(props.files, format));\n    };\n\n    return (\n        <Dialog\n            open={visible}\n            maxWidth={'xs'}\n            fullWidth={true}\n            TransitionComponent={Transition as any}\n            aria-labelledby=\"convert-dialog-slide-title\"\n            aria-describedby=\"convert-dialog-slide-description\"\n        >\n            <DialogTitle id=\"convert-dialog-slide-title\">Upload Settings</DialogTitle>\n            <DialogContent>\n                <FormControl className={classes.formControl}>\n                    <InputLabel color=\"secondary\" id=\"convert-dialog-format\">\n                        Format\n                    </InputLabel>\n                    <Select\n                        labelId=\"convert-dialog-format-label\"\n                        id=\"convert-dialog-format\"\n                        value={format}\n                        color=\"secondary\"\n                        onChange={handleChange}\n                        input={<Input />}\n                    >\n                        <MenuItem value={`SP`}>SP</MenuItem>\n                        <MenuItem value={`LP2`}>LP2</MenuItem>\n                        <MenuItem value={`LP4`}>LP4</MenuItem>\n                    </Select>\n                </FormControl>\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={handleClose}>Cancel</Button>\n                <Button onClick={handleConvert}>Ok</Button>\n            </DialogActions>\n        </Dialog>\n    );\n};\n","import React, { useEffect, useCallback } from 'react';\nimport { useDispatch } from 'react-redux';\nimport clsx from 'clsx';\nimport { useDropzone } from 'react-dropzone';\nimport { listContent, deleteTracks, moveTrack } from '../redux/actions';\nimport { actions as renameDialogActions } from '../redux/rename-dialog-feature';\nimport { actions as convertDialogActions } from '../redux/convert-dialog-feature';\n\nimport { formatTimeFromFrames, getTracks, Encoding } from 'netmd-js';\n\nimport { useShallowEqualSelector } from '../utils';\n\nimport { lighten, makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Box from '@material-ui/core/Box';\nimport Fab from '@material-ui/core/Fab';\nimport AddIcon from '@material-ui/icons/Add';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport EditIcon from '@material-ui/icons/Edit';\nimport Backdrop from '@material-ui/core/Backdrop';\n\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\n\nimport IconButton from '@material-ui/core/IconButton';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { batchActions } from 'redux-batched-actions';\n\nimport { RenameDialog } from './rename-dialog';\nimport { UploadDialog } from './upload-dialog';\nimport { ErrorDialog } from './error-dialog';\nimport { ConvertDialog } from './convert-dialog';\nimport { AboutDialog } from './about-dialog';\nimport { TopMenu } from './topmenu';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport * as BadgeImpl from '@material-ui/core/Badge/Badge';\nimport Button from '@material-ui/core/Button';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nconst useStyles = makeStyles(theme => ({\n    add: {\n        position: 'absolute',\n        bottom: theme.spacing(3),\n        right: theme.spacing(3),\n    },\n    main: {\n        overflowY: 'auto',\n        flex: '1 1 auto',\n        marginBottom: theme.spacing(3),\n        marginLeft: theme.spacing(-2),\n        marginRight: theme.spacing(-2),\n        outline: 'none',\n    },\n    toolbar: {\n        marginTop: theme.spacing(3),\n        marginLeft: theme.spacing(-2),\n        marginRight: theme.spacing(-2),\n        [theme.breakpoints.up(600 + theme.spacing(2) * 2)]: {\n            marginLeft: theme.spacing(-3),\n            marginRight: theme.spacing(-3),\n        },\n    },\n    toolbarLabel: {\n        flex: '1 1 100%',\n    },\n    toolbarHighlight:\n        theme.palette.type === 'light'\n            ? {\n                  color: theme.palette.secondary.main,\n                  backgroundColor: lighten(theme.palette.secondary.light, 0.85),\n              }\n            : {\n                  color: theme.palette.text.primary,\n                  backgroundColor: theme.palette.secondary.dark,\n              },\n    headBox: {\n        display: 'flex',\n        justifyContent: 'space-between',\n    },\n    spacing: {\n        marginTop: theme.spacing(1),\n    },\n    formatBadge: {\n        ...(BadgeImpl as any).styles(theme).badge,\n        ...(BadgeImpl as any).styles(theme).colorPrimary,\n        position: 'static',\n        display: 'inline-flex',\n        border: `2px solid ${theme.palette.background.paper}`,\n        padding: '0 4px',\n    },\n    titleCell: {\n        overflow: 'hidden',\n        maxWidth: '40ch',\n        textOverflow: 'ellipsis',\n        // whiteSpace: 'nowrap',\n    },\n    indexCell: {\n        whiteSpace: 'nowrap',\n        paddingRight: 0,\n        width: `2ch`,\n    },\n    backdrop: {\n        zIndex: theme.zIndex.drawer + 1,\n        color: '#fff',\n    },\n}));\n\nconst EncodingName: { [k: number]: string } = {\n    [Encoding.sp]: 'SP',\n    [Encoding.lp2]: 'LP2',\n    [Encoding.lp4]: 'LP4',\n};\n\nexport const Main = (props: {}) => {\n    let dispatch = useDispatch();\n    let disc = useShallowEqualSelector(state => state.main.disc);\n    let deviceName = useShallowEqualSelector(state => state.main.deviceName);\n\n    const [selected, setSelected] = React.useState<number[]>([]);\n    const selectedCount = selected.length;\n\n    const [moveMenuAnchorEl, setMoveMenuAnchorEl] = React.useState<null | HTMLElement>(null);\n    const handleShowMoveMenu = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {\n        setMoveMenuAnchorEl(event.currentTarget);\n    }, []);\n    const handleCloseMoveMenu = useCallback(() => {\n        setMoveMenuAnchorEl(null);\n    }, []);\n    const handleMoveSelectedTrack = useCallback(\n        (destIndex: number) => {\n            dispatch(moveTrack(selected[0], destIndex));\n            handleCloseMoveMenu();\n        },\n        [dispatch, selected]\n    );\n\n    useEffect(() => {\n        dispatch(listContent());\n    }, [dispatch]);\n\n    useEffect(() => {\n        setSelected([]); // Reset selection if disc changes\n    }, [disc]);\n\n    let [uploadedFiles, setUploadedFiles] = React.useState<File[]>([]);\n    const onDrop = useCallback(\n        (acceptedFiles: File[], rejectedFiles: File[]) => {\n            setUploadedFiles(acceptedFiles);\n            dispatch(convertDialogActions.setVisible(true));\n        },\n        [dispatch]\n    );\n    const { getRootProps, getInputProps, isDragActive, open } = useDropzone({ onDrop, accept: `audio/*`, noClick: true });\n\n    const classes = useStyles();\n\n    let tracks: { index: number; title: string; group: string; duration: string; encoding: string }[] = [];\n    if (disc !== null) {\n        for (let group of disc.groups) {\n            for (let track of group.tracks) {\n                tracks.push({\n                    index: track.index,\n                    title: track.title ?? `Unknown Title`,\n                    group: group.title ?? ``,\n                    encoding: EncodingName[track.encoding],\n                    duration: formatTimeFromFrames(track.duration, false),\n                });\n            }\n        }\n    }\n\n    // Action Handlers\n    const handleSelectClick = (event: React.MouseEvent, item: number) => {\n        if (selected.includes(item)) {\n            setSelected(selected.filter(i => i !== item));\n        } else {\n            setSelected([...selected, item]);\n        }\n    };\n\n    const handleSelectAllClick = (event: React.ChangeEvent<HTMLInputElement>) => {\n        if (selected.length < tracks.length) {\n            setSelected(tracks.map(t => t.index));\n        } else {\n            setSelected([]);\n        }\n    };\n\n    const handleRenameDoubleClick = (event: React.MouseEvent, item: number) => {\n        let selectedIndex = item;\n        let currentName = getTracks(disc!).find(track => track.index === selectedIndex)?.title ?? '';\n\n        dispatch(\n            batchActions([\n                renameDialogActions.setVisible(true),\n                renameDialogActions.setCurrentName(currentName),\n                renameDialogActions.setIndex(selectedIndex),\n            ])\n        );\n    };\n\n    const handleRenameActionClick = (event: React.MouseEvent) => {\n        handleRenameDoubleClick(event, selected[0]);\n    };\n\n    const handleDeleteSelected = (event: React.MouseEvent) => {\n        dispatch(deleteTracks(selected));\n    };\n\n    return (\n        <React.Fragment>\n            <Box className={classes.headBox}>\n                <Typography component=\"h1\" variant=\"h4\">\n                    {deviceName || `Loading...`}\n                </Typography>\n                <TopMenu />\n            </Box>\n            <Typography component=\"h2\" variant=\"body2\">\n                {disc !== null\n                    ? `${formatTimeFromFrames(disc.left, false)} left of ${formatTimeFromFrames(disc.total, false)}`\n                    : `Loading...`}\n            </Typography>\n            <Toolbar\n                className={clsx(classes.toolbar, {\n                    [classes.toolbarHighlight]: selectedCount > 0,\n                })}\n            >\n                {selectedCount > 0 ? (\n                    <Checkbox\n                        indeterminate={selectedCount > 0 && selectedCount < tracks.length}\n                        checked={selectedCount > 0}\n                        onChange={handleSelectAllClick}\n                        inputProps={{ 'aria-label': 'select all tracks' }}\n                    />\n                ) : null}\n                {selectedCount > 0 ? (\n                    <Typography className={classes.toolbarLabel} color=\"inherit\" variant=\"subtitle1\">\n                        {selectedCount} selected\n                    </Typography>\n                ) : (\n                    <Typography component=\"h3\" variant=\"h6\" className={classes.toolbarLabel}>\n                        {disc?.title || `Untitled Disc`}\n                    </Typography>\n                )}\n\n                {selectedCount === 1 ? (\n                    <React.Fragment>\n                        <Tooltip title=\"Move to Position\">\n                            <Button aria-controls=\"move-menu\" aria-label=\"Move\" onClick={handleShowMoveMenu}>\n                                Move\n                            </Button>\n                        </Tooltip>\n                        <Menu\n                            id=\"move-menu\"\n                            anchorEl={moveMenuAnchorEl}\n                            open={!!moveMenuAnchorEl}\n                            onClose={handleCloseMoveMenu}\n                            PaperProps={{\n                                style: {\n                                    maxHeight: 300,\n                                },\n                            }}\n                        >\n                            {Array(tracks.length)\n                                .fill(null)\n                                .map((_, i) => {\n                                    return (\n                                        <MenuItem key={`pos-${i}`} onClick={() => handleMoveSelectedTrack(i)}>\n                                            {i + 1}\n                                        </MenuItem>\n                                    );\n                                })}\n                        </Menu>\n                    </React.Fragment>\n                ) : null}\n\n                {selectedCount > 0 ? (\n                    <Tooltip title=\"Delete\">\n                        <IconButton aria-label=\"delete\" onClick={handleDeleteSelected}>\n                            <DeleteIcon />\n                        </IconButton>\n                    </Tooltip>\n                ) : null}\n\n                {selectedCount > 0 ? (\n                    <Tooltip title=\"Rename\">\n                        <IconButton aria-label=\"rename\" disabled={selectedCount !== 1} onClick={handleRenameActionClick}>\n                            <EditIcon />\n                        </IconButton>\n                    </Tooltip>\n                ) : null}\n            </Toolbar>\n            <Box className={classes.main} {...getRootProps()}>\n                <input {...getInputProps()} />\n                <Table size=\"small\">\n                    <TableHead>\n                        <TableRow>\n                            <TableCell className={classes.indexCell}>#</TableCell>\n                            <TableCell>Title</TableCell>\n                            <TableCell>Format</TableCell>\n                            <TableCell align=\"right\">Duration</TableCell>\n                        </TableRow>\n                    </TableHead>\n                    <TableBody>\n                        {tracks.map(track => (\n                            <TableRow\n                                hover\n                                selected={selected.includes(track.index)}\n                                key={track.index}\n                                onDoubleClick={event => handleRenameDoubleClick(event, track.index)}\n                                onClick={event => handleSelectClick(event, track.index)}\n                            >\n                                <TableCell className={classes.indexCell}>{track.index + 1}</TableCell>\n                                <TableCell className={classes.titleCell} title={track.title}>\n                                    {track.title || `No Title`}\n                                </TableCell>\n                                <TableCell>\n                                    <span className={classes.formatBadge}>{track.encoding}</span>\n                                </TableCell>\n                                <TableCell align=\"right\">{track.duration}</TableCell>\n                            </TableRow>\n                        ))}\n                    </TableBody>\n                </Table>\n                <Backdrop className={classes.backdrop} open={isDragActive}>\n                    Drop your Music to Upload\n                </Backdrop>\n            </Box>\n            <Fab color=\"primary\" aria-label=\"add\" className={classes.add} onClick={open}>\n                <AddIcon />\n            </Fab>\n\n            <UploadDialog />\n            <RenameDialog />\n            <ErrorDialog />\n            <ConvertDialog files={uploadedFiles} />\n            <AboutDialog />\n        </React.Fragment>\n    );\n};\n","import React, { useCallback } from 'react';\n\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport StopIcon from '@material-ui/icons/Stop';\nimport SkipNextIcon from '@material-ui/icons/SkipNext';\nimport SkipPreviousIcon from '@material-ui/icons/SkipPrevious';\n\nimport IconButton from '@material-ui/core/IconButton';\nimport Box from '@material-ui/core/Box';\n\nimport serviceRegistry from '../services/registry';\n\nexport const Controls = () => {\n    const handlePrev = useCallback(() => {\n        serviceRegistry.netmdService?.prev();\n    }, []);\n    const handlePlay = useCallback(() => {\n        serviceRegistry.netmdService?.play();\n    }, []);\n    const handleStop = useCallback(() => {\n        serviceRegistry.netmdService?.stop();\n    }, []);\n    const handleNext = useCallback(() => {\n        serviceRegistry.netmdService?.next();\n    }, []);\n    return (\n        <Box>\n            <IconButton aria-label=\"prev\" onClick={handlePrev}>\n                <SkipPreviousIcon />\n            </IconButton>\n            <IconButton aria-label=\"play\" onClick={handlePlay}>\n                <PlayArrowIcon />\n            </IconButton>\n            <IconButton aria-label=\"stop\" onClick={handleStop}>\n                <StopIcon />\n            </IconButton>\n            <IconButton aria-label=\"next\" onClick={handleNext}>\n                <SkipNextIcon />\n            </IconButton>\n        </Box>\n    );\n};\n","import React from 'react';\nimport { useShallowEqualSelector } from '../utils';\nimport { actions as appActions } from '../redux/app-feature';\n\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles, createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\n\nimport { Welcome } from './welcome';\nimport { Main } from './main';\nimport { Controls } from './controls';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\nimport Link from '@material-ui/core/Link';\nimport Box from '@material-ui/core/Box';\nimport Brightness2Icon from '@material-ui/icons/Brightness2';\nimport IconButton from '@material-ui/core/IconButton';\nimport { useDispatch } from 'react-redux';\n\nconst useStyles = makeStyles(theme => ({\n    layout: {\n        width: 'auto',\n        height: '100%',\n        [theme.breakpoints.up(600 + theme.spacing(2) * 2)]: {\n            width: 600,\n            marginLeft: 'auto',\n            marginRight: 'auto',\n        },\n    },\n\n    paper: {\n        position: 'relative',\n        display: 'flex',\n        flexDirection: 'column',\n        padding: theme.spacing(2),\n        height: '100%',\n        [theme.breakpoints.up(600 + theme.spacing(2) * 2)]: {\n            marginTop: theme.spacing(6),\n            marginBottom: theme.spacing(6),\n            padding: theme.spacing(3),\n            height: 600,\n        },\n    },\n    copyright: {\n        display: 'flex',\n        alignItems: 'center',\n        [theme.breakpoints.down(600 + theme.spacing(2) * 2)]: {\n            flexWrap: 'wrap',\n        },\n    },\n    backdrop: {\n        zIndex: theme.zIndex.drawer + 1,\n        color: '#fff',\n    },\n    minidiscLogo: {\n        width: 48,\n    },\n    controlsContainer: {\n        flex: '1 1 auto',\n        paddingLeft: theme.spacing(3),\n        paddingRight: theme.spacing(8),\n        [theme.breakpoints.down(600 + theme.spacing(2) * 2)]: {\n            order: -1,\n            width: '100%',\n            paddingLeft: 0,\n        },\n    },\n}));\n\nconst darkTheme = createMuiTheme({\n    palette: {\n        type: 'dark',\n        primary: {\n            light: '#6ec6ff',\n            main: '#2196f3',\n            dark: '#0069c0',\n            contrastText: '#fff',\n        },\n    },\n});\n\nconst lightTheme = createMuiTheme({\n    palette: {\n        type: 'light',\n    },\n});\n\nconst App = () => {\n    const classes = useStyles();\n\n    const dispatch = useDispatch();\n    let { mainView, loading, darkMode } = useShallowEqualSelector(state => state.appState);\n\n    return (\n        <React.Fragment>\n            <ThemeProvider theme={darkMode ? darkTheme : lightTheme}>\n                <CssBaseline />\n\n                <main className={classes.layout}>\n                    <Paper className={classes.paper}>\n                        {mainView === 'WELCOME' ? <Welcome /> : null}\n                        {mainView === 'MAIN' ? <Main /> : null}\n\n                        <Box className={classes.copyright}>\n                            <IconButton onClick={() => dispatch(appActions.setDarkMode(!darkMode))}>\n                                <Brightness2Icon color={darkMode ? 'secondary' : undefined} />\n                            </IconButton>\n                            <Typography variant=\"body2\" color=\"textSecondary\" style={{ marginRight: `8px` }}>\n                                {' '}\n                                <Link rel=\"noopener noreferrer\" color=\"inherit\" target=\"_blank\" href=\"https://stefano.brilli.me/\">\n                                    Stefano Brilli\n                                </Link>{' '}\n                                {new Date().getFullYear()}\n                                {'.'}\n                            </Typography>\n                            <Link\n                                rel=\"noopener noreferrer\"\n                                href=\"https://twitter.com/share?ref_src=twsrc%5Etfw\"\n                                className=\"twitter-share-button\"\n                                data-via=\"thecybercase\"\n                                data-hashtags=\"MiniDisc\"\n                                data-dnt=\"true\"\n                                data-show-count=\"false\"\n                            >\n                                Tweet\n                            </Link>\n                            <Box className={classes.controlsContainer}>{mainView === 'MAIN' ? <Controls /> : null}</Box>\n                        </Box>\n                    </Paper>\n                </main>\n\n                <Backdrop className={classes.backdrop} open={loading}>\n                    <CircularProgress color=\"inherit\" />\n                </Backdrop>\n            </ThemeProvider>\n        </React.Fragment>\n    );\n};\n\nexport default App;\n","import { createWorker, setLogging } from '@ffmpeg/ffmpeg';\nimport { AtracdencProcess } from './atracdenc-worker';\nimport { getPublicPathFor } from '../utils';\nconst AtracdencWorker = require('worker-loader!./atracdenc-worker'); // eslint-disable-line import/no-webpack-loader-syntax\n\ninterface LogPayload {\n    message: string;\n    action: string;\n}\n\nexport interface AudioExportService {\n    init(): Promise<void>;\n    export(params: { format: string }): Promise<ArrayBuffer>;\n    info(): Promise<{ format: string | null; input: string | null }>;\n    prepare(file: File): Promise<void>;\n}\n\nexport class FFMpegAudioExportService implements AudioExportService {\n    public ffmpegProcess: any;\n    public atracdencProcess?: AtracdencProcess;\n    public loglines: { action: string; message: string }[] = [];\n    public inFileName: string = ``;\n    public outFileNameNoExt: string = ``;\n\n    async init() {\n        setLogging(true);\n    }\n\n    async prepare(file: File) {\n        this.loglines = [];\n        this.ffmpegProcess = createWorker({\n            logger: (payload: LogPayload) => {\n                this.loglines.push(payload);\n                console.log(payload.action, payload.message);\n            },\n            corePath: getPublicPathFor('ffmpeg-core.js'),\n            workerPath: getPublicPathFor('worker.min.js'),\n        });\n        await this.ffmpegProcess.load();\n\n        this.atracdencProcess = new AtracdencProcess(new AtracdencWorker());\n        await this.atracdencProcess.init();\n\n        let ext = file.name.split('.').slice(-1);\n        if (ext.length === 0) {\n            throw new Error(`Unrecognized file format: ${file.name}`);\n        }\n\n        this.inFileName = `inAudioFile.${ext[0]}`;\n        this.outFileNameNoExt = `outAudioFile`;\n\n        await this.ffmpegProcess.write(this.inFileName, file);\n    }\n\n    async info() {\n        await this.ffmpegProcess.transcode(this.inFileName, `${this.outFileNameNoExt}.metadata`, `-f ffmetadata`);\n\n        let audioFormatRegex = /Audio:\\s(.*?),/; // Actual content\n        let inputFormatRegex = /Input #0,\\s(.*?),/; // Container\n        let format: string | null = null;\n        let input: string | null = null;\n\n        for (let line of this.loglines) {\n            let match = line.message.match(audioFormatRegex);\n            if (match !== null) {\n                format = match[1];\n                continue;\n            }\n            match = line.message.match(inputFormatRegex);\n            if (match !== null) {\n                input = match[1];\n                continue;\n            }\n            if (format !== null && input !== null) {\n                break;\n            }\n        }\n\n        return { format, input };\n    }\n\n    async export({ format }: { format: string }) {\n        let result: ArrayBuffer;\n        if (format === `SP`) {\n            const outFileName = `${this.outFileNameNoExt}.raw`;\n            await this.ffmpegProcess.transcode(this.inFileName, outFileName, '-f s16be -ar 44100');\n            let { data } = await this.ffmpegProcess.read(outFileName);\n            result = data.buffer;\n        } else {\n            const outFileName = `${this.outFileNameNoExt}.wav`;\n            await this.ffmpegProcess.transcode(this.inFileName, outFileName, '-f wav -ar 44100');\n            let { data } = await this.ffmpegProcess.read(outFileName);\n            let bitrate: string = `0`;\n            switch (format) {\n                case `LP2`:\n                    bitrate = `128`;\n                    break;\n                case `LP105`:\n                    bitrate = `102`;\n                    break;\n                case `LP4`:\n                    bitrate = `64`;\n                    break;\n            }\n            result = await this.atracdencProcess!.encode(data.buffer, bitrate);\n        }\n        this.ffmpegProcess.worker.terminate();\n        this.atracdencProcess!.terminate();\n        return result;\n    }\n}\n","/* eslint no-restricted-globals: 0 */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport * as serviceWorker from './serviceWorker';\nimport { NetMDUSBService } from './services/netmd';\nimport { NetMDMockService } from './services/netmd-mock';\nimport serviceRegistry from './services/registry';\n\nimport { store } from './redux/store';\nimport { actions as appActions } from './redux/app-feature';\n\nimport App from './components/app';\n\nimport './index.css';\nimport { FFMpegAudioExportService } from './services/audio-export';\n\nserviceRegistry.netmdService = new NetMDUSBService();\n// serviceRegistry.netmdService = new NetMDMockService(); // Uncomment to work without a device attached\nserviceRegistry.audioExportService = new FFMpegAudioExportService();\n\n(function setupEventHandlers() {\n    window.addEventListener('beforeunload', ev => {\n        let isUploading = store.getState().uploadDialog.visible;\n        if (!isUploading) {\n            return;\n        }\n        ev.preventDefault();\n        ev.returnValue = `Warning! Recording will be interrupted`;\n    });\n\n    if (navigator && navigator.usb) {\n        navigator.usb.ondisconnect = function() {\n            store.dispatch(appActions.setState('WELCOME'));\n        };\n    } else {\n        store.dispatch(appActions.setBrowserSupported(false));\n    }\n\n    // eslint-disable-next-line\n    let deferredPrompt: any;\n    window.addEventListener('beforeinstallprompt', (e: any) => {\n        e.preventDefault();\n        deferredPrompt = e;\n    });\n})();\n\nReactDOM.render(\n    <Provider store={store}>\n        <App />\n    </Provider>,\n    document.getElementById('root')\n);\n\n// serviceWorker.unregister();\nserviceWorker.register();\n","\"use strict\";\n/* A bunch of utils. Some might be unused */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction sleep(msec) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, new Promise(function (resolve) { return setTimeout(resolve, msec); })];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.sleep = sleep;\nfunction withTimeout(timeoutInMs, cb) {\n    var _this = this;\n    return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\n        var timer, result;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    timer = setTimeout(function () {\n                        reject(new Error(\"Operation timed out\"));\n                    }, timeoutInMs);\n                    return [4 /*yield*/, cb()];\n                case 1:\n                    result = _a.sent();\n                    clearTimeout(timer);\n                    resolve(result);\n                    return [2 /*return*/];\n            }\n        });\n    }); });\n}\nexports.withTimeout = withTimeout;\nfunction assert(condition, message) {\n    if (condition) {\n        return;\n    }\n    message = message || 'no message provided';\n    throw new Error(\"Assertion failed: \" + message);\n}\nexports.assert = assert;\nfunction assertBigInt(value, message) {\n    if (typeof value === 'bigint') {\n        return value;\n    }\n    throw assert(false, \"Expected BigInt type - \" + message);\n}\nexports.assertBigInt = assertBigInt;\nfunction assertNumber(value, message) {\n    if (typeof value === 'number') {\n        return value;\n    }\n    throw assert(false, \"Expected number type - \" + message);\n}\nexports.assertNumber = assertNumber;\nfunction assertString(value, message) {\n    if (typeof value === 'string') {\n        return value;\n    }\n    throw assert(false, \"Expected string type - \" + message);\n}\nexports.assertString = assertString;\nfunction stringToCharCodeArray(str) {\n    var result = new Array(str.length);\n    for (var i = 0; i < str.length; i++) {\n        result[i] = str.charCodeAt(i);\n    }\n    return result;\n}\nexports.stringToCharCodeArray = stringToCharCodeArray;\n// compare ArrayBuffers\nfunction arrayBuffersAreEqual(a, b) {\n    return dataViewsAreEqual(new DataView(a), new DataView(b));\n}\nexports.arrayBuffersAreEqual = arrayBuffersAreEqual;\n// compare DataViews\nfunction dataViewsAreEqual(a, b) {\n    if (a.byteLength !== b.byteLength)\n        return false;\n    for (var i = 0; i < a.byteLength; i++) {\n        if (a.getUint8(i) !== b.getUint8(i))\n            return false;\n    }\n    return true;\n}\nexports.dataViewsAreEqual = dataViewsAreEqual;\n// Thanks to https://gist.github.com/TooTallNate/4750953\nfunction isBigEndian() {\n    return new Uint8Array(new Uint32Array([0x12345678]).buffer)[0] === 0x12;\n}\nexports.isBigEndian = isBigEndian;\nfunction hexEncode(str) {\n    var hex;\n    var result = '';\n    for (var i = 0; i < str.length; i++) {\n        hex = str.charCodeAt(i).toString(16);\n        result += ('0' + hex).slice(-2);\n    }\n    return result;\n}\nexports.hexEncode = hexEncode;\nfunction arrayBufferToBinaryString(ab) {\n    var src = new Uint8Array(ab);\n    return uint8arrayToBinaryString(src);\n}\nexports.arrayBufferToBinaryString = arrayBufferToBinaryString;\nfunction uint8arrayToBinaryString(u8a) {\n    var dst = Array(u8a.length);\n    u8a.forEach(function (c, i) { return (dst[i] = String.fromCharCode(c)); });\n    return dst.join('');\n}\nexports.uint8arrayToBinaryString = uint8arrayToBinaryString;\nfunction concatUint8Arrays() {\n    var e_1, _a, e_2, _b;\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var totalLength = 0;\n    try {\n        for (var args_1 = __values(args), args_1_1 = args_1.next(); !args_1_1.done; args_1_1 = args_1.next()) {\n            var a = args_1_1.value;\n            totalLength += a.length;\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (args_1_1 && !args_1_1.done && (_a = args_1.return)) _a.call(args_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    var res = new Uint8Array(totalLength);\n    var offset = 0;\n    try {\n        for (var args_2 = __values(args), args_2_1 = args_2.next(); !args_2_1.done; args_2_1 = args_2.next()) {\n            var a = args_2_1.value;\n            res.set(a, offset);\n            offset += a.length;\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (args_2_1 && !args_2_1.done && (_b = args_2.return)) _b.call(args_2);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return res;\n}\nexports.concatUint8Arrays = concatUint8Arrays;\nfunction concatArrayBuffers(buffer1, buffer2) {\n    var tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);\n    tmp.set(new Uint8Array(buffer1), 0);\n    tmp.set(new Uint8Array(buffer2), buffer1.byteLength);\n    return tmp.buffer;\n}\nexports.concatArrayBuffers = concatArrayBuffers;\n// Thanks to: https://gist.github.com/artjomb/7ef1ee574a411ba0dd1933c1ef4690d1\nfunction wordToByteArray(word, length) {\n    var ba = [], xFF = 0xff;\n    if (length > 0)\n        ba.push(word >>> 24);\n    if (length > 1)\n        ba.push((word >>> 16) & xFF);\n    if (length > 2)\n        ba.push((word >>> 8) & xFF);\n    if (length > 3)\n        ba.push(word & xFF);\n    return ba;\n}\nfunction wordArrayToByteArray(wordArray, length) {\n    if (length === void 0) { length = wordArray.sigBytes; }\n    var res = new Uint8Array(length);\n    var bytes;\n    var i = 0;\n    var offset = 0;\n    while (length > 0) {\n        bytes = wordToByteArray(wordArray.words[i], Math.min(4, length));\n        res.set(bytes, offset);\n        length -= bytes.length;\n        offset += bytes.length;\n        i++;\n    }\n    return res;\n}\nexports.wordArrayToByteArray = wordArrayToByteArray;\nfunction timeToFrames(time) {\n    assert(time.length === 4);\n    return ((time[0] * 60 + time[1]) * 60 + time[2]) * 512 + time[3];\n}\nexports.timeToFrames = timeToFrames;\nfunction pad(str, pad) {\n    return (pad + str).slice(-pad.length);\n}\nexports.pad = pad;\nfunction formatTimeFromFrames(value, frames) {\n    if (frames === void 0) { frames = true; }\n    var f = value % 512;\n    value = (value - f) / 512; // sec\n    var s = value % 60;\n    value = (value - s) / 60; // min\n    var m = value % 60;\n    value = (value - m) / 60; // hour\n    var h = value;\n    return pad(h, '00') + \":\" + pad(m, '00') + \":\" + pad(s, '00') + (frames ? \"+\" + pad(f, '000') : \"\");\n}\nexports.formatTimeFromFrames = formatTimeFromFrames;\nfunction sanitizeTrackTitle(title) {\n    return encodeURIComponent(title);\n}\nexports.sanitizeTrackTitle = sanitizeTrackTitle;\n//# sourceMappingURL=utils.js.map"],"sourceRoot":""}