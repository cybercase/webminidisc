(this.webpackJsonpwebmd=this.webpackJsonpwebmd||[]).push([[0],{226:function(e,t,a){e.exports=a.p+"static/media/chrome-icon.f3b6c54c.svg"},254:function(e,t,a){e.exports=a(421)},277:function(e,t){},279:function(e,t){},312:function(e,t){},313:function(e,t){},405:function(e,t,a){},420:function(e,t,a){e.exports=function(){return new Worker(a.p+"ba79c8f0cad9f62107a2.worker.js")}},421:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(14),l=a.n(i),o=a(17);const c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function s(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{console.log("state change",a.state),"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})},e.update()}).catch(e=>{console.error("Error during service worker registration:",e)})}var d=a(18),m=a(224);function u(e){return new Promise(t=>{setTimeout(t,e)})}async function p(e,t){let a=1,n=setInterval(()=>{a++,t(Math.min(100,1e3*a/e*100))},1e3);await u(e),window.clearInterval(n)}function g(e){return Object(o.d)(e,o.b)}function b(e){return`/webminidisc/${e}`}function h(e){return e.normalize("NFD").replace(/[^\x00-\x7F]/g,"")}const f=a(379);var v={},E=a(22),w=a(15);const y=Object(E.b)({name:"uploadDialog",initialState:{visible:!1,writtenProgress:0,encryptedProgress:0,totalProgress:1,trackTotal:1,trackConverting:0,trackCurrent:0,titleCurrent:"",titleConverting:""},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setWriteProgress:(e,t)=>{e.encryptedProgress=t.payload.encrypted,e.writtenProgress=t.payload.written,e.totalProgress=t.payload.total},setTrackProgress:(e,t)=>{e.trackTotal=t.payload.total,e.trackCurrent=t.payload.current,e.trackConverting=t.payload.converting,e.titleCurrent=t.payload.titleCurrent,e.titleConverting=t.payload.titleConverting}}}),{reducer:k,actions:C}=y;var x=Object(w.enableBatching)(k);const j=Object(E.b)({name:"renameDialog",initialState:{visible:!1,title:"",index:-1},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setCurrentName:(e,t)=>{e.title=t.payload},setIndex:(e,t)=>{e.index=t.payload}}}),{reducer:O,actions:S}=j;var D=Object(w.enableBatching)(O);const N={visible:!1,error:""},P=Object(E.b)({name:"errorDialog",initialState:N,reducers:{setVisible:(e,t)=>{e.visible=t.payload},setErrorMessage:(e,t)=>{e.error=`${t.payload}`}}}),{actions:T,reducer:M}=P;var I=Object(w.enableBatching)(M);const F={visible:!1,format:"LP2"},W=Object(E.b)({name:"convertDialog",initialState:F,reducers:{setVisible:(e,t)=>{e.visible=t.payload},setFormat:(e,t)=>{e.format=t.payload}}}),{actions:L,reducer:R}=W;var A=Object(w.enableBatching)(R);const B=Object(E.b)({name:"dumpDialog",initialState:{visible:!1,inputDeviceId:""},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setInputDeviceId:(e,t)=>{e.inputDeviceId=t.payload}}}),{reducer:$,actions:V}=B;var U=Object(w.enableBatching)($);const _=Object(E.b)({name:"recordDialog",initialState:{visible:!1,trackTotal:1,trackDone:0,trackCurrent:0,titleCurrent:""},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setProgress:(e,t)=>{e.trackTotal=t.payload.trackTotal,e.trackDone=t.payload.trackDone,e.trackCurrent=t.payload.trackCurrent,e.titleCurrent=t.payload.titleCurrent}}}),{reducer:z,actions:G}=_;var J=Object(w.enableBatching)(z);const H={mainView:"WELCOME",loading:!1,pairingFailed:!1,pairingMessage:"",browserSupported:!0,darkMode:function(e,t){let a=localStorage.getItem(e);if(null===a)return t;try{return JSON.parse(a)}catch(n){return t}}("darkMode",!1),aboutDialogVisible:!1},Y=Object(E.b)({name:"app",initialState:H,reducers:{setState:(e,t)=>{e.mainView=t.payload},setLoading:(e,t)=>{e.loading=t.payload},setPairingFailed:(e,t)=>{e.pairingFailed=t.payload},setPairingMessage:(e,t)=>{e.pairingMessage=t.payload},setBrowserSupported:(e,t)=>{e.browserSupported=t.payload},setDarkMode:(e,t)=>{var a,n;e.darkMode=t.payload,a="darkMode",n=e.darkMode,localStorage.setItem(a,JSON.stringify(n))},showAboutDialog:(e,t)=>{e.aboutDialogVisible=t.payload}}}),{reducer:q,actions:K}=Y;var Q=Object(w.enableBatching)(q);const X=Object(E.b)({name:"main",initialState:{disc:null,deviceName:""},reducers:{setDisc:(e,t)=>{e.disc=t.payload},setDeviceName:(e,t)=>{e.deviceName=t.payload}}}),{reducer:Z,actions:ee}=X;var te=Object(w.enableBatching)(Z);const ae=Object(E.a)({reducer:{renameDialog:D,uploadDialog:x,errorDialog:I,convertDialog:A,dumpDialog:U,recordDialog:J,appState:Q,main:te},middleware:[...Object(E.c)()]});var ne=a(481),re=a(426),ie=a(482),le=a(469),oe=a(238),ce=a(473);function se(){return async function(e){e(K.setLoading(!0));let t=await v.netmdService.listContent(),a=await v.netmdService.getDeviceName();e(Object(w.batchActions)([ee.setDisc(t),ee.setDeviceName(a),K.setLoading(!1)]))}}const de={SP:d.Wireformat.pcm,LP2:d.Wireformat.lp2,LP105:d.Wireformat.l105kbps,LP4:d.Wireformat.lp4};function me(e,t){return async function(a,n){const{audioExportService:r,netmdService:i}=v,l=de[t];a(C.setVisible(!0));const o=({written:e,encrypted:t,total:n})=>{a(C.setWriteProgress({written:e,encrypted:t,total:n}))};let c={current:0,converting:0,total:e.length,titleCurrent:"",titleConverting:""};const s=()=>{a(C.setTrackProgress(c))};let m=n().main.disc,u=m?1700-Object(d.getTracks)(m).map(e=>e.title||"").reduce((e,t)=>e+t.length,0):-1;let p;u=Math.floor(u/e.length);let g="",b=1;for await(let d of async function*(e){let a=[],n=0;!function i(){if(n===e.length)return c.converting=n,c.titleConverting="",void s();let l=e[n];c.converting=n,c.titleConverting=l.name,s(),n++,a.push(new Promise(async(e,a)=>{let n;try{await r.prepare(l),n=await r.export({format:t}),i(),e({file:l,data:n})}catch(o){p=o,g=`${l.name}: Unsupported or unrecognized format`,a(o)}}))}();let i=0;for(;i<a.length;)yield await a[i],delete a[i],i++}(e)){const{file:e,data:t}=d;let a=e.name;const n=a.lastIndexOf(".");n>0&&(a=a.substring(0,n)),u>-1&&(a=a.substring(0,u)),c.current=b++,c.titleCurrent=a,s(),o({written:0,encrypted:0,total:100});try{await(null===i||void 0===i?void 0:i.upload(a,t,l,o))}catch(f){p=f,g=`${e.name}: Error uploading to device`;break}}let h=[C.setVisible(!1)];p&&(console.error(p),h=h.concat([T.setVisible(!0),T.setErrorMessage(g)])),a(Object(w.batchActions)(h)),se()(a)}}var ue=a(466),pe=a(157),ge=a(427),be=a(428),he=a(485),fe=a(464),ve=a(458),Ee=a(465),we=a(462),ye=a(463),ke=a(461),Ce=a(457);const xe=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),je=e=>{const t=Object(o.c)();let a=g(e=>e.appState.aboutDialogVisible);return r.a.createElement(ve.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:xe,"aria-labelledby":"about-dialog-slide-title"},r.a.createElement(ke.a,{id:"about-dialog-slide-title"},"About Web MiniDisc"),r.a.createElement(we.a,null,r.a.createElement(ye.a,null,"Web MiniDisc has been made possible by"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://www.ffmpeg.org/",target:"_blank"},"FFmpeg")," ","and"," ",r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://github.com/ffmpegjs/FFmpeg",target:"_blank"},"ffmpegjs"),", to read your audio files (wav, mp3, ogg, mp4, etc...)."),r.a.createElement("li",null,r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://github.com/dcherednik/atracdenc/",target:"_blank"},"Atracdenc"),", to support atrac3 encoding (lp2, lp4 audio formats)."),r.a.createElement("li",null,r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://emscripten.org/",target:"_blank"},"Emscripten"),", to run both FFmpeg and Atracdenc in the browser."),r.a.createElement("li",null,r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/netmd-js",target:"_blank"},"netmd-js"),", to send commands to NetMD devices using Javascript."),r.a.createElement("li",null,r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://github.com/glaubitz/linux-minidisc",target:"_blank"},"linux-minidisc"),", to make the netmd-js project possible."),r.a.createElement("li",null,r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://material-ui.com/",target:"_blank"},"material-ui"),", to build the user interface.")),r.a.createElement(ye.a,null,"Attribution"),r.a.createElement("ul",null,r.a.createElement("li",null,"MiniDisc logo from"," ",r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://en.wikipedia.org/wiki/MiniDisc",target:"_blank"},"https://en.wikipedia.org/wiki/MiniDisc")),r.a.createElement("li",null,"MiniDisc icon from"," ",r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://www.deviantart.com/blinkybill/art/Sony-MiniDisc-Plastic-Icon-473812540",target:"_blank"},"http://fav.me/d7u3g3g")))),r.a.createElement(Ee.a,null,r.a.createElement(ue.a,{onClick:()=>{t(K.showAboutDialog(!1))}},"Close")))};var Oe=a(467),Se=a(240),De=a(486),Ne=a(225),Pe=a.n(Ne);const Te=function(){const e=Object(o.c)();let{mainView:t}=g(e=>e.appState),a=g(e=>e.main.disc);const[n,i]=r.a.useState(null),l=Boolean(n),c=()=>{i(null)},s=()=>{e((async function(e){if(!window.confirm("Proceed with Wipe Disc? This operation cannot be undone."))return;const{netmdService:t}=v;e(K.setLoading(!0)),await t.wipeDisc(),se()(e)})),c()},d=()=>{e(se()),c()},m=()=>{var t;e(Object(w.batchActions)([S.setVisible(!0),S.setCurrentName(null!==(t=null===a||void 0===a?void 0:a.title)&&void 0!==t?t:""),S.setIndex(-1)])),c()},u=()=>{e(K.setState("WELCOME")),c()},p=[];return"MAIN"===t&&(p.push(r.a.createElement(De.a,{key:"update",onClick:d},"Refresh")),p.push(r.a.createElement(De.a,{key:"title",onClick:m},"Rename Disc")),p.push(r.a.createElement(De.a,{key:"wipe",onClick:s},"Wipe Disc")),p.push(r.a.createElement(De.a,{key:"exit",onClick:u},"Exit"))),p.push(r.a.createElement(De.a,{key:"about",onClick:()=>{e(K.showAboutDialog(!0)),c()}},"About")),p.push(r.a.createElement(De.a,{key:"github",onClick:c},r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/webminidisc",target:"_blank"},"Fork me on GitHub"))),r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe.a,{"aria-label":"actions","aria-controls":"actions-menu","aria-haspopup":"true",onClick:e=>{i(e.currentTarget)}},r.a.createElement(Pe.a,null)),r.a.createElement(Se.a,{id:"actions-menu",anchorEl:n,keepMounted:!0,open:l,onClose:c},p))};var Me=a(226),Ie=a.n(Me);const Fe=Object(le.a)(e=>({main:{position:"relative",flex:"1 1 auto",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},button:{marginTop:e.spacing(3),minWidth:150},spacing:{marginTop:e.spacing(1)},chromeLogo:{marginTop:e.spacing(1),width:96,height:96},why:{alignSelf:"flex-start",marginTop:e.spacing(3)},headBox:{display:"flex",justifyContent:"space-between"}})),We=e=>{const t=Fe(),a=Object(o.c)(),{browserSupported:i,pairingFailed:l,pairingMessage:c}=g(e=>e.appState);c.toLowerCase().match(/denied/);const[s,d]=Object(n.useState)(!1);return r.a.createElement(r.a.Fragment,null,r.a.createElement(he.a,{className:t.headBox},r.a.createElement(pe.a,{component:"h1",variant:"h4"},"Web MiniDisc"),r.a.createElement(Te,null)),r.a.createElement(pe.a,{component:"h2",variant:"body2"},"Brings NetMD Devices to the Web"),r.a.createElement(he.a,{className:t.main},i?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Press the button to connect to a NetMD device"),r.a.createElement(ue.a,{variant:"contained",color:"primary",onClick:()=>a((async function(e,t){e(K.setPairingFailed(!1)),await v.audioExportService.init();try{if(await v.netmdService.connect())return void e(K.setState("MAIN"))}catch(a){console.error(a)}try{if(await v.netmdService.pair())return void e(K.setState("MAIN"));e(Object(w.batchActions)([K.setPairingMessage("Connection Failed"),K.setPairingFailed(!0)]))}catch(a){console.error(a);let t=a.message;e(Object(w.batchActions)([K.setPairingMessage(t),K.setPairingFailed(!0)]))}})),className:t.button},"Connect"),r.a.createElement(ge.a,{error:!0,className:t.spacing,style:{visibility:l?"visible":"hidden"}},r.a.createElement(be.a,null,c))):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"This Web browser is not supported.\xa0",r.a.createElement(fe.a,{rel:"noopener noreferrer",href:"#",onClick:e=>{e.preventDefault(),d(!0)}},"Learn Why")),r.a.createElement(fe.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},r.a.createElement("img",{alt:"Chrome Logo",src:Ie.a,className:t.chromeLogo})),r.a.createElement(pe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Try using"," ",r.a.createElement(fe.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},"Chrome")," ","instead"),s?r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.a,{component:"p",variant:"body2",className:t.why},"Web MiniDisc requires a browser that supports both"," ",r.a.createElement(fe.a,{rel:"noopener noreferrer",target:"_blank",href:"https://wicg.github.io/webusb/"},"WebUSB")," ","and"," ",r.a.createElement(fe.a,{rel:"noopener noreferrer",target:"_blank",href:"https://webassembly.org/"},"WebAssembly"),"."),r.a.createElement("ul",null,r.a.createElement("li",null,"WebUSB is needed to control the NetMD device via the USB connection to your computer."),r.a.createElement("li",null,"WebAssembly is used to convert the music to a MiniDisc compatible format"))):null)),r.a.createElement(je,null))};var Le=a(3),Re=a(239),Ae=a(13),Be=a(480),$e=a(235),Ve=a.n($e),Ue=a(233),_e=a.n(Ue),ze=a(234),Ge=a.n(ze),Je=a(475),He=a(479),Ye=a(478),qe=a(476),Ke=a(477),Qe=a(474),Xe=a(484),Ze=a(471);const et=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),tt=e=>{let t=Object(o.c)(),a=g(e=>e.renameDialog.visible),n=g(e=>e.renameDialog.title),i=g(e=>e.renameDialog.index);const l=i<0?"Disc":"Track",c=()=>{t(S.setVisible(!1))},s=()=>{t(i<0?function({newName:e}){return async function(t){const{netmdService:a}=v;await a.renameDisc(e),t(S.setVisible(!1)),se()(t)}}({newName:n}):function({index:e,newName:t}){return async function(a){const{netmdService:n}=v;a(S.setVisible(!1));try{await n.renameTrack(e,t)}catch(r){console.error(r),a(Object(w.batchActions)([T.setVisible(!0),T.setErrorMessage("Rename failed.")]))}se()(a)}}({index:i,newName:n}))};return r.a.createElement(ve.a,{open:a,onClose:c,maxWidth:"sm",fullWidth:!0,TransitionComponent:et,"aria-labelledby":"rename-dialog-title"},r.a.createElement(ke.a,{id:"rename-dialog-title"},"Rename ",l),r.a.createElement(we.a,null,r.a.createElement(Ze.a,{autoFocus:!0,id:"name",label:`${l} Name`,type:"text",fullWidth:!0,value:n,onKeyDown:e=>{"Enter"===e.key&&s()},onChange:e=>{t(S.setCurrentName(e.target.value.substring(0,120)))}})),r.a.createElement(Ee.a,null,r.a.createElement(ue.a,{onClick:c},"Cancel"),r.a.createElement(ue.a,{color:"primary",onClick:s},"Rename")))};var at=a(472);const nt=Object(le.a)(e=>({progressPerc:{marginTop:e.spacing(1)},progressBar:{marginTop:e.spacing(3)},uploadLabel:{marginTop:e.spacing(3)}})),rt=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),it=e=>{const t=nt();let{visible:a,writtenProgress:n,encryptedProgress:i,totalProgress:l,trackTotal:o,trackCurrent:c,trackConverting:s,titleCurrent:d,titleConverting:m}=g(e=>e.uploadDialog),u=Math.floor(n/l*100),p=Math.floor(i/l*100),b=Math.floor(s/o*100);return r.a.createElement(ve.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:rt,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},r.a.createElement(ke.a,{id:"alert-dialog-slide-title"},"Recording..."),r.a.createElement(we.a,null,r.a.createElement(ye.a,{id:"alert-dialog-slide-description"},100===b&&s===o?"Conversion completed":`Converting ${s+1} of ${o}: ${m}`),r.a.createElement(at.a,{className:t.progressBar,variant:0===b?"indeterminate":"determinate",color:"primary",value:b}),r.a.createElement(he.a,{className:t.progressPerc},b,"%"),r.a.createElement(ye.a,{id:"alert-dialog-slide-description",className:t.uploadLabel},"Uploading ",c," of ",o,": ",d),r.a.createElement(at.a,{className:t.progressBar,variant:"buffer",color:"secondary",value:u,valueBuffer:p}),r.a.createElement(he.a,{className:t.progressPerc},u,"%")),r.a.createElement(Ee.a,null))},lt=Object(le.a)(e=>({progressPerc:{marginTop:e.spacing(1)},progressBar:{marginTop:e.spacing(3)}})),ot=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),ct=e=>{const t=lt();let{visible:a,trackTotal:n,trackDone:i,trackCurrent:l,titleCurrent:o}=g(e=>e.recordDialog),c=Math.round(l);return r.a.createElement(ve.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:ot,"aria-labelledby":"record-dialog-slide-title","aria-describedby":"record-dialog-slide-description"},r.a.createElement(ke.a,{id:"record-dialog-slide-title"},"Recording..."),r.a.createElement(we.a,null,r.a.createElement(ye.a,{id:"record-dialog-slide-description"},`Recording track ${i+1} of ${n}: ${o}`),r.a.createElement(at.a,{className:t.progressBar,variant:l>=0?"determinate":"indeterminate",color:"primary",value:c}),r.a.createElement(he.a,{className:t.progressPerc},c>=0?`${c}%`:"")),r.a.createElement(Ee.a,null))},st=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),dt=e=>{const t=Object(o.c)();let{visible:a,error:n}=g(e=>e.errorDialog);return r.a.createElement(ve.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:st,"aria-labelledby":"error-dialog-slide-title","aria-describedby":"error-dialog-slide-description"},r.a.createElement(ke.a,{id:"alert-dialog-slide-title"},"Error"),r.a.createElement(we.a,null,r.a.createElement(ye.a,{id:"alert-dialog-slide-description"},n)),r.a.createElement(Ee.a,null,r.a.createElement(ue.a,{onClick:()=>{t(T.setVisible(!1))}},"Close")))};var mt=a(433),ut=a(431),pt=a(429);const gt=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),bt=Object(le.a)(e=>({container:{display:"flex",flexDirection:"row"},formControl:{minWidth:120}})),ht=e=>{const t=Object(o.c)(),a=bt();let{visible:n,format:i}=g(e=>e.convertDialog);const l=()=>{t(L.setVisible(!1))};return r.a.createElement(ve.a,{open:n,maxWidth:"xs",fullWidth:!0,TransitionComponent:gt,"aria-labelledby":"convert-dialog-slide-title","aria-describedby":"convert-dialog-slide-description"},r.a.createElement(ke.a,{id:"convert-dialog-slide-title"},"Upload Settings"),r.a.createElement(we.a,null,r.a.createElement(ge.a,{className:a.formControl},r.a.createElement(mt.a,{color:"secondary",id:"convert-dialog-format"},"Format"),r.a.createElement(ut.a,{labelId:"convert-dialog-format-label",id:"convert-dialog-format",value:i,color:"secondary",onChange:e=>{t(L.setFormat(e.target.value))},input:r.a.createElement(pt.a,null)},r.a.createElement(De.a,{value:"SP"},"SP"),r.a.createElement(De.a,{value:"LP2"},"LP2"),r.a.createElement(De.a,{value:"LP4"},"LP4")))),r.a.createElement(Ee.a,null,r.a.createElement(ue.a,{onClick:l},"Cancel"),r.a.createElement(ue.a,{onClick:()=>{l(),t(me(e.files,i))}},"Ok")))};var ft=a(229),vt=a.n(ft),Et=a(230),wt=a.n(Et),yt=a(231),kt=a.n(yt),Ct=a(228),xt=a.n(Ct);const jt=()=>{const e=Object(n.useCallback)(()=>{var e;null===(e=v.netmdService)||void 0===e||e.prev()},[]),t=Object(n.useCallback)(()=>{var e;null===(e=v.netmdService)||void 0===e||e.play()},[]),a=Object(n.useCallback)(()=>{var e;null===(e=v.netmdService)||void 0===e||e.stop()},[]),i=Object(n.useCallback)(()=>{var e;null===(e=v.netmdService)||void 0===e||e.next()},[]);return r.a.createElement(he.a,null,r.a.createElement(Oe.a,{"aria-label":"prev",onClick:e},r.a.createElement(xt.a,null)),r.a.createElement(Oe.a,{"aria-label":"play",onClick:t},r.a.createElement(vt.a,null)),r.a.createElement(Oe.a,{"aria-label":"stop",onClick:a},r.a.createElement(wt.a,null)),r.a.createElement(Oe.a,{"aria-label":"next",onClick:i},r.a.createElement(kt.a,null)))},Ot=r.a.forwardRef((function(e,t){return r.a.createElement(Ce.a,Object.assign({direction:"up",ref:t},e))})),St=Object(le.a)(e=>({container:{display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",marginRight:-e.spacing(2)},formControl:{minWidth:120},selectEmpty:{marginTop:e.spacing(2)},head:{textShadow:"0px 0px 12px rgba(150, 150, 150, 1)",fontSize:e.typography.h2.fontSize,textAlign:"center",marginBottom:e.spacing(2)}})),Dt=({trackIndexes:e})=>{const t=Object(o.c)(),a=St(),[i,l]=Object(n.useState)([]),[c,s]=Object(n.useState)("");let{visible:m}=g(e=>e.dumpDialog);const b=Object(n.useCallback)(()=>{var e;s(""),null===(e=v.mediaRecorderService)||void 0===e||e.stopTestInput(),t(V.setVisible(!1))},[t]),h=Object(n.useCallback)(e=>{var t,a;const n=e.target.value;s(n),null===(t=v.mediaRecorderService)||void 0===t||t.stopTestInput(),null===(a=v.mediaRecorderService)||void 0===a||a.playTestInput(n)},[s]),f=Object(n.useCallback)(()=>{var a,n;t((a=e,n=c,async function(e,t){e(Object(w.batchActions)([G.setVisible(!0),G.setProgress({trackTotal:a.length,trackDone:0,trackCurrent:0,titleCurrent:""})]));let r=t().main.disc,i=Object(d.getTracks)(r).filter(e=>a.indexOf(e.index)>=0);const{netmdService:l,mediaRecorderService:o}=v;for(let[a,s]of i.entries()){var c;e(G.setProgress({trackTotal:i.length,trackDone:a,trackCurrent:-1,titleCurrent:null!==(c=s.title)&&void 0!==c?c:""})),await l.gotoTrack(s.index),await l.play(),console.log("Waiting for track to be ready to play");let t=await l.getPosition(),r=[s.index,0,0,1];for(;null===t||!r.every((e,a)=>r[a]===t[a]);)await u(250),t=await l.getPosition();await l.pause(),await(null===l||void 0===l?void 0:l.gotoTrack(s.index)),console.log("Track is ready to play"),await(null===o||void 0===o?void 0:o.initStream(n)),await(null===o||void 0===o?void 0:o.startRecording()),await l.play();let d=s.duration/512;await p(1e3*d,t=>{var n;e(G.setProgress({trackTotal:i.length,trackDone:a,trackCurrent:t,titleCurrent:null!==(n=s.title)&&void 0!==n?n:""}))}),await(null===o||void 0===o?void 0:o.stopRecording()),null===o||void 0===o||o.downloadRecorded(`${s.title}`),await(null===o||void 0===o?void 0:o.closeStream())}await l.stop(),e(G.setVisible(!1))})),b()},[e,c,t,b]);return Object(n.useEffect)(()=>{m&&async function(){await navigator.mediaDevices.getUserMedia({audio:!0});let e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind).map(e=>({deviceId:e.deviceId,label:e.label}));l(e)}()},[m,l]),r.a.createElement(ve.a,{open:m,maxWidth:"sm",fullWidth:!0,TransitionComponent:Ot,"aria-labelledby":"dump-dialog-slide-title","aria-describedby":"dump-dialog-slide-description"},r.a.createElement(ke.a,{id:"dump-dialog-slide-title"},"Record Selected Tracks"),r.a.createElement(we.a,null,r.a.createElement(pe.a,{component:"p",variant:"h2",className:a.head},"\ud83d\udcbb \u2b05 \ud83d\udcbd"),r.a.createElement(pe.a,{component:"p",variant:"body2"},"1. Connect your MD Player line-out to your PC audio line-in."),r.a.createElement(pe.a,{component:"p",variant:"body2"},"2. Use the controls at the bottom right to play some tracks."),r.a.createElement(pe.a,{component:"p",variant:"body2"},"3. Select the input source. You should hear the tracks playing on your PC."),r.a.createElement(pe.a,{component:"p",variant:"body2"},"4. Adjust the input gain and the line-out volume of your device."),r.a.createElement(he.a,{className:a.container},r.a.createElement(ge.a,{className:a.formControl},r.a.createElement(ut.a,{value:c,onChange:h,displayEmpty:!0,className:a.selectEmpty},r.a.createElement(De.a,{value:"",disabled:!0},"Input Source"),i.map(e=>r.a.createElement(De.a,{key:e.deviceId,value:e.deviceId},e.label))),r.a.createElement(be.a,null,"Input Source")),r.a.createElement(jt,null))),r.a.createElement(Ee.a,null,r.a.createElement(ue.a,{onClick:b},"Cancel"),r.a.createElement(ue.a,{onClick:f,disabled:""===c},"Start Record")))};var Nt=a(483),Pt=a(154);const Tt=Object(le.a)(e=>({add:{position:"absolute",bottom:e.spacing(3),right:e.spacing(3)},main:{overflowY:"auto",flex:"1 1 auto",marginBottom:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2),outline:"none"},toolbar:{marginTop:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2),[e.breakpoints.up(600+2*e.spacing(2))]:{marginLeft:e.spacing(-3),marginRight:e.spacing(-3)}},toolbarLabel:{flex:"1 1 100%"},toolbarHighlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Ae.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},headBox:{display:"flex",justifyContent:"space-between"},spacing:{marginTop:e.spacing(1)},formatBadge:{...Pt.styles(e).badge,...Pt.styles(e).colorPrimary,position:"static",display:"inline-flex",border:`2px solid ${e.palette.background.paper}`,padding:"0 4px"},titleCell:{overflow:"hidden",maxWidth:"40ch",textOverflow:"ellipsis"},indexCell:{whiteSpace:"nowrap",paddingRight:0,width:"2ch"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},remainingTimeTooltip:{textDecoration:"underline",textDecorationStyle:"dotted"}})),Mt={[d.Encoding.sp]:"SP",[d.Encoding.lp2]:"LP2",[d.Encoding.lp4]:"LP4"},It=e=>{let t=Object(o.c)(),a=g(e=>e.main.disc),i=g(e=>e.main.deviceName);const[l,c]=r.a.useState([]),s=l.length,[m,u]=r.a.useState(null),p=Object(n.useCallback)(e=>{u(e.currentTarget)},[]),b=Object(n.useCallback)(()=>{u(null)},[]),h=Object(n.useCallback)(e=>{t(function(e,t){return async function(a){const{netmdService:n}=v;await n.moveTrack(e,t),se()(a)}}(l[0],e)),b()},[t,l,b]),f=Object(n.useCallback)(()=>{t(V.setVisible(!0))},[t]);Object(n.useEffect)(()=>{t(se())},[t]),Object(n.useEffect)(()=>{c([])},[a]);let[E,y]=r.a.useState([]);const k=Object(n.useCallback)((e,a)=>{y(e),t(L.setVisible(!0))},[t]),{getRootProps:C,getInputProps:x,isDragActive:j,open:O}=Object(Re.a)({onDrop:k,accept:"audio/*",noClick:!0}),D=Tt();let N=[];if(null!==a)for(let n of a.groups)for(let e of n.tracks){var P,T;N.push({index:e.index,title:null!==(P=e.title)&&void 0!==P?P:"Unknown Title",group:null!==(T=n.title)&&void 0!==T?T:"",encoding:Mt[e.encoding],duration:Object(d.formatTimeFromFrames)(e.duration,!1)})}N.sort((e,t)=>e.index-t.index);const M=(e,n)=>{var r,i;let l=n,o=null!==(r=null===(i=Object(d.getTracks)(a).find(e=>e.index===l))||void 0===i?void 0:i.title)&&void 0!==r?r:"";t(Object(w.batchActions)([S.setVisible(!0),S.setCurrentName(o),S.setIndex(l)]))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(he.a,{className:D.headBox},r.a.createElement(pe.a,{component:"h1",variant:"h4"},i||"Loading..."),r.a.createElement(Te,null)),r.a.createElement(pe.a,{component:"h2",variant:"body2"},null!==a?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,`${Object(d.formatTimeFromFrames)(a.left,!1)} left of ${Object(d.formatTimeFromFrames)(a.total,!1)} `),r.a.createElement(Xe.a,{title:r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,`${Object(d.formatTimeFromFrames)(2*a.left,!1)} left in LP2 Mode`),r.a.createElement("br",null),r.a.createElement("span",null,`${Object(d.formatTimeFromFrames)(4*a.left,!1)} left in LP4 Mode`)),arrow:!0},r.a.createElement("span",{className:D.remainingTimeTooltip},"SP Mode"))):"Loading..."),r.a.createElement(Qe.a,{className:Object(Le.default)(D.toolbar,{[D.toolbarHighlight]:s>0})},s>0?r.a.createElement(Nt.a,{indeterminate:s>0&&s<N.length,checked:s>0,onChange:e=>{l.length<N.length?c(N.map(e=>e.index)):c([])},inputProps:{"aria-label":"select all tracks"}}):null,s>0?r.a.createElement(pe.a,{className:D.toolbarLabel,color:"inherit",variant:"subtitle1"},s," selected"):r.a.createElement(pe.a,{component:"h3",variant:"h6",className:D.toolbarLabel},(null===a||void 0===a?void 0:a.title)||"Untitled Disc"),1===s?r.a.createElement(r.a.Fragment,null,r.a.createElement(Xe.a,{title:"Move to Position"},r.a.createElement(ue.a,{"aria-controls":"move-menu","aria-label":"Move",onClick:p},"Move")),r.a.createElement(Se.a,{id:"move-menu",anchorEl:m,open:!!m,onClose:b,PaperProps:{style:{maxHeight:300}}},Array(N.length).fill(null).map((e,t)=>r.a.createElement(De.a,{key:`pos-${t}`,onClick:()=>h(t)},t+1)))):null,s>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(Xe.a,{title:"Record from MD"},r.a.createElement(ue.a,{"aria-label":"Record",onClick:f},"Record"))):null,s>0?r.a.createElement(Xe.a,{title:"Delete"},r.a.createElement(Oe.a,{"aria-label":"delete",onClick:e=>{var a;t((a=l,async function(e){if(!window.confirm(`Proceed with Delete Track${1!==a.length?"s":""}? This operation cannot be undone.`))return;const{netmdService:t}=v;e(K.setLoading(!0)),(a=a.sort()).reverse();for(let n of a)await t.deleteTrack(n);se()(e)}))}},r.a.createElement(_e.a,null))):null,s>0?r.a.createElement(Xe.a,{title:"Rename"},r.a.createElement(Oe.a,{"aria-label":"rename",disabled:1!==s,onClick:e=>{M(0,l[0])}},r.a.createElement(Ge.a,null))):null),r.a.createElement(he.a,Object.assign({className:D.main},C()),r.a.createElement("input",x()),r.a.createElement(Je.a,{size:"small"},r.a.createElement(qe.a,null,r.a.createElement(Ke.a,null,r.a.createElement(Ye.a,{className:D.indexCell},"#"),r.a.createElement(Ye.a,null,"Title"),r.a.createElement(Ye.a,null,"Format"),r.a.createElement(Ye.a,{align:"right"},"Duration"))),r.a.createElement(He.a,null,N.map(e=>r.a.createElement(Ke.a,{hover:!0,selected:l.includes(e.index),key:e.index,onDoubleClick:t=>M(0,e.index),onClick:t=>{return a=e.index,void(l.includes(a)?c(l.filter(e=>e!==a)):c([...l,a]));var a}},r.a.createElement(Ye.a,{className:D.indexCell},e.index+1),r.a.createElement(Ye.a,{className:D.titleCell,title:e.title},e.title||"No Title"),r.a.createElement(Ye.a,null,r.a.createElement("span",{className:D.formatBadge},e.encoding)),r.a.createElement(Ye.a,{align:"right"},e.duration))))),r.a.createElement(re.a,{className:D.backdrop,open:j},"Drop your Music to Upload")),r.a.createElement(Be.a,{color:"primary","aria-label":"add",className:D.add,onClick:O},r.a.createElement(Ve.a,null)),r.a.createElement(it,null),r.a.createElement(tt,null),r.a.createElement(dt,null),r.a.createElement(ht,{files:E}),r.a.createElement(ct,null),r.a.createElement(Dt,{trackIndexes:l}),r.a.createElement(je,null))};var Ft=a(422),Wt=a(236),Lt=a.n(Wt);const Rt=Object(le.a)(e=>({layout:{width:"auto",height:"100%",[e.breakpoints.up(600+2*e.spacing(2))]:{width:600,marginLeft:"auto",marginRight:"auto"},[e.breakpoints.up(700+2*e.spacing(2))+" and (min-height: 750px)"]:{width:700}},paper:{position:"relative",display:"flex",flexDirection:"column",padding:e.spacing(2),height:"100%",[e.breakpoints.up(600+2*e.spacing(2))]:{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3),height:600},[e.breakpoints.up(700+2*e.spacing(2))+" and (min-height: 750px)"]:{height:700}},copyright:{display:"flex",alignItems:"center",[e.breakpoints.down(600+2*e.spacing(2))]:{flexWrap:"wrap"}},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},minidiscLogo:{width:48},controlsContainer:{flex:"1 1 auto",paddingLeft:e.spacing(3),paddingRight:e.spacing(8),[e.breakpoints.down(600+2*e.spacing(2))]:{order:-1,width:"100%",paddingLeft:0}}})),At=Object(oe.a)({palette:{type:"dark",primary:{light:"#6ec6ff",main:"#2196f3",dark:"#0069c0",contrastText:"#fff"}}}),Bt=Object(oe.a)({palette:{type:"light"}});var $t=()=>{const e=Rt(),t=Object(o.c)();let{mainView:a,loading:n,darkMode:i}=g(e=>e.appState);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ce.a,{theme:i?At:Bt},r.a.createElement(ne.a,null),r.a.createElement("main",{className:e.layout},r.a.createElement(Ft.a,{className:e.paper},"WELCOME"===a?r.a.createElement(We,null):null,"MAIN"===a?r.a.createElement(It,null):null,r.a.createElement(he.a,{className:e.copyright},r.a.createElement(Oe.a,{onClick:()=>t(K.setDarkMode(!i))},r.a.createElement(Lt.a,{color:i?"secondary":void 0})),r.a.createElement(pe.a,{variant:"body2",color:"textSecondary",style:{marginRight:"8px"}},"\xa9 ",r.a.createElement(fe.a,{rel:"noopener noreferrer",color:"inherit",target:"_blank",href:"https://stefano.brilli.me/"},"Stefano Brilli")," ",(new Date).getFullYear(),"."),r.a.createElement(he.a,{className:e.controlsContainer},"MAIN"===a?r.a.createElement(jt,null):null)))),r.a.createElement(re.a,{className:e.backdrop,open:n},r.a.createElement(ie.a,{color:"inherit"}))))},Vt=(a(405),a(155));class Ut{constructor(e){this.worker=e,this.messageCallback=void 0,e.onmessage=this.handleMessage.bind(this)}async init(){await new Promise(e=>{this.messageCallback=e,this.worker.postMessage({action:"init"})})}async encode(e,t){return(await new Promise(a=>{this.messageCallback=a,this.worker.postMessage({action:"encode",bitrate:t,data:e},[e])})).data.result}terminate(){this.worker.terminate()}handleMessage(e){this.messageCallback(e),this.messageCallback=void 0}}if("undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){let e;onmessage=async t=>{const{action:a,...n}=t.data;if("init"===a)self.importScripts(b("atracdenc.js")),self.Module().then(t=>{e=t,self.postMessage({action:"init"}),e.setLogger&&e.setLogger((e,t)=>console.log(`${t}: ${e}`))});else if("encode"===a){const{bitrate:t,data:a}=n,r="inWavFile.wav",i="outAt3File.aea",l=new Uint8Array(a);e.FS.writeFile(`${r}`,l),e.callMain(["-e","atrac3","-i",r,"-o",i,"--bitrate",t]);let o=e.FS.stat(i).size,c=new Uint8Array(o-96),s=e.FS.open(i,"r");e.FS.read(s,c,0,c.length,96),e.FS.close(s);let d=c.buffer;self.postMessage({action:"encode",result:d},[d])}}}const _t=a(420);var zt=a(237),Gt=a.n(zt);v.netmdService=new class{constructor({debug:e=!1}){if(this.netmdInterface=void 0,this.logger=void 0,e){const e=(...e)=>{e&&e[0]&&e[0].method&&console.log(...e)};this.logger={debug:e,info:e,warn:e,error:e,child:()=>this.logger}}}async pair(){let e=await Object(d.openNewDevice)(navigator.usb,this.logger);return null!==e&&(this.netmdInterface=e,!0)}async connect(){let e=await Object(d.openPairedDevice)(navigator.usb,this.logger);return null!==e&&(this.netmdInterface=e,!0)}async listContent(){return await Object(d.listContent)(this.netmdInterface)}async getDeviceName(){return await this.netmdInterface.netMd.getDeviceName()}async finalize(){await this.netmdInterface.netMd.finalize()}async renameTrack(e,t){t=h(t),await this.netmdInterface.cacheTOC(),await this.netmdInterface.setTrackTitle(e,t),await this.netmdInterface.syncTOC()}async renameDisc(e){const t=await this.netmdInterface.getDiscTitle(),a=await this.netmdInterface._getDiscTitle(),n=a.indexOf("//")>=0,r=a.startsWith("0;");if(e===t)return;let i;i=n?r?a.replace(/^0;.*?\/\//,""!==e?`0;${e}//`:""):`0;${e}//${a}`:e,await this.netmdInterface.cacheTOC(),await this.netmdInterface.setDiscTitle(i),await this.netmdInterface.syncTOC()}async deleteTrack(e){await this.netmdInterface.eraseTrack(e),await u(100)}async wipeDisc(){await this.netmdInterface.eraseDisc()}async moveTrack(e,t){await this.netmdInterface.moveTrack(e,t)}async upload(e,t,a,n){let r=t.byteLength,i=0,l=0;function o(){n({written:i,encrypted:l,total:r})}let c=new f,s=Object(m.makeGetAsyncPacketIteratorOnWorkerThread)(c,({encryptedBytes:e})=>{l=e,o()});e=h(e);let u=new d.MDTrack(e,a,t,524288,s);await Object(d.download)(this.netmdInterface,u,({writtenBytes:e})=>{i=e,o()}),c.terminate()}async play(){await this.netmdInterface.play()}async pause(){await this.netmdInterface.pause()}async stop(){await this.netmdInterface.stop()}async next(){await this.netmdInterface.nextTrack()}async prev(){await this.netmdInterface.previousTrack()}async gotoTrack(e){await this.netmdInterface.gotoTrack(e)}async getPosition(){return await this.netmdInterface.getPosition()}}({debug:!0}),v.audioExportService=new class{constructor(){this.ffmpegProcess=void 0,this.atracdencProcess=void 0,this.loglines=[],this.inFileName="",this.outFileNameNoExt=""}async init(){Object(Vt.setLogging)(!0)}async prepare(e){this.loglines=[],this.ffmpegProcess=Object(Vt.createWorker)({logger:e=>{this.loglines.push(e),console.log(e.action,e.message)},corePath:b("ffmpeg-core.js"),workerPath:b("worker.min.js")}),await this.ffmpegProcess.load(),this.atracdencProcess=new Ut(new _t),await this.atracdencProcess.init();let t=e.name.split(".").slice(-1);if(0===t.length)throw new Error(`Unrecognized file format: ${e.name}`);this.inFileName=`inAudioFile.${t[0]}`,this.outFileNameNoExt="outAudioFile",await this.ffmpegProcess.write(this.inFileName,e)}async info(){await this.ffmpegProcess.transcode(this.inFileName,`${this.outFileNameNoExt}.metadata`,"-f ffmetadata");let e=/Audio:\s(.*?),/,t=/Input #0,\s(.*?),/,a=null,n=null;for(let r of this.loglines){let i=r.message.match(e);if(null===i)if(i=r.message.match(t),null===i){if(null!==a&&null!==n)break}else n=i[1];else a=i[1]}return{format:a,input:n}}async export({format:e}){let t;if("SP"===e){const e=`${this.outFileNameNoExt}.raw`;await this.ffmpegProcess.transcode(this.inFileName,e,"-f s16be -ar 44100");let{data:a}=await this.ffmpegProcess.read(e);t=a.buffer}else{const a=`${this.outFileNameNoExt}.wav`;await this.ffmpegProcess.transcode(this.inFileName,a,"-f wav -ar 44100");let{data:n}=await this.ffmpegProcess.read(a),r="0";switch(e){case"LP2":r="128";break;case"LP105":r="102";break;case"LP4":r="64"}t=await this.atracdencProcess.encode(n.buffer,r)}return this.ffmpegProcess.worker.terminate(),this.atracdencProcess.terminate(),t}},v.mediaRecorderService=new class{constructor(){this.recorder=void 0,this.stream=void 0,this.audioContext=void 0,this.analyserNode=void 0,this.gainNode=void 0}playTestInput(e){this.audioContext=new AudioContext,this.gainNode=this.audioContext.createGain(),this.analyserNode=this.audioContext.createAnalyser(),this.initStream(e).then(()=>{this.audioContext.createMediaStreamSource(this.stream).connect(this.gainNode),this.gainNode.connect(this.analyserNode),this.analyserNode.connect(this.audioContext.destination)})}stopTestInput(){var e;this.audioContext&&(null===(e=this.audioContext)||void 0===e||e.close(),delete this.audioContext,this.closeStream())}async initStream(e){const t={autoGainControl:!1,channelCount:2,deviceId:e,echoCancellation:!1,noiseSuppression:!1,sampleRate:44100,highpassFilter:!1};this.stream=await navigator.mediaDevices.getUserMedia({audio:t});const a=this.stream.getAudioTracks();a.length>0&&console.log("Record Setings:",a[0].getSettings())}async startRecording(){this.audioContext=new AudioContext;const e=this.audioContext.createMediaStreamSource(this.stream);this.recorder=new Gt.a(e,{workerPath:b("recorderWorker.js")}),this.recorder.record()}async stopRecording(){this.recorder.stop()}async closeStream(){var e;null===(e=this.stream)||void 0===e||e.getTracks().forEach(e=>e.stop())}downloadRecorded(e){this.recorder.exportWAV(t=>{let a=URL.createObjectURL(t),n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=a,n.download=`${h(e)}.wav`,n.click(),window.URL.revokeObjectURL(a),document.body.removeChild(n)})}},function(){let e;window.addEventListener("beforeunload",e=>{ae.getState().uploadDialog.visible&&(e.preventDefault(),e.returnValue="Warning! Recording will be interrupted")}),navigator&&navigator.usb?navigator.usb.ondisconnect=function(){ae.dispatch(K.setState("WELCOME"))}:ae.dispatch(K.setBrowserSupported(!1)),window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t})}(),l.a.render(r.a.createElement(o.a,{store:ae},r.a.createElement($t,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/webminidisc",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="/webminidisc/final-service-worker.js";c?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):s(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):s(t,e)})}}()}},[[254,1,2]]]);
//# sourceMappingURL=main.eb78c3fa.chunk.js.map